<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>osgEarth: SinglePassTerrainTechnique Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = 'open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = 'closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">osgEarth&#160;<span id="projectnumber">2.1.1</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pri-types">Private Types</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a>  </div>
  <div class="headertitle">
<h1>SinglePassTerrainTechnique Class Reference</h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="SinglePassTerrainTechnique" --><!-- doxytag: inherits="CustomTerrainTechnique" --><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png"/> Inheritance diagram for SinglePassTerrainTechnique:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classSinglePassTerrainTechnique__inherit__graph.png" border="0" usemap="#SinglePassTerrainTechnique_inherit__map" alt="Inheritance graph"/></div>
<map name="SinglePassTerrainTechnique_inherit__map" id="SinglePassTerrainTechnique_inherit__map">
<area shape="rect" id="node2" href="classCustomTerrainTechnique.html" title="CustomTerrainTechnique" alt="" coords="15,160,183,189"/><area shape="rect" id="node4" href="classTerrainTechnique.html" title="TerrainTechnique" alt="" coords="37,83,160,112"/><area shape="rect" id="node6" href="classosg_1_1Object.html" title="Object" alt="" coords="69,5,128,35"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png"/> Collaboration diagram for SinglePassTerrainTechnique:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classSinglePassTerrainTechnique__coll__graph.png" border="0" usemap="#SinglePassTerrainTechnique_coll__map" alt="Collaboration graph"/></div>
<map name="SinglePassTerrainTechnique_coll__map" id="SinglePassTerrainTechnique_coll__map">
<area shape="rect" id="node2" href="classCustomTerrainTechnique.html" title="CustomTerrainTechnique" alt="" coords="148,389,316,419"/><area shape="rect" id="node4" href="classTerrainTechnique.html" title="TerrainTechnique" alt="" coords="171,309,293,339"/><area shape="rect" id="node6" href="classosg_1_1Object.html" title="Object" alt="" coords="143,213,201,243"/><area shape="rect" id="node8" href="classTile.html" title="Tile" alt="" coords="225,213,268,243"/><area shape="rect" id="node10" href="classosgEarth_1_1TileKey.html" title="osgEarth::TileKey" alt="" coords="5,117,131,147"/><area shape="rect" id="node13" href="classosgEarth_1_1GeoExtent.html" title="osgEarth::GeoExtent" alt="" coords="436,5,580,35"/><area shape="rect" id="node16" href="classosgEarth_1_1Threading_1_1ReadWriteMutex.html" title="osgEarth::Threading::ReadWriteMutex" alt="" coords="232,117,477,147"/><area shape="rect" id="node18" href="classosgEarth_1_1Threading_1_1Event.html" title="osgEarth::Threading::Event" alt="" coords="224,5,405,35"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>

<p><a href="classSinglePassTerrainTechnique-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structSinglePassTerrainTechnique_1_1ImageLayerUpdate.html">ImageLayerUpdate</a></td></tr>
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#ae981c67d64ad09d65d81ebf81f3f8673">SinglePassTerrainTechnique</a> (<a class="el" href="classosgEarth_1_1TextureCompositor.html">TextureCompositor</a> *compositor=0L)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#ac6124dc70eae562dbcc85131e8f5d253">SinglePassTerrainTechnique</a> (const <a class="el" href="classSinglePassTerrainTechnique.html">SinglePassTerrainTechnique</a> &amp;, const osg::CopyOp &amp;copyop=osg::CopyOp::SHALLOW_COPY)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#a19b8a3e14dd898be941b082436ad30bf">META_Object</a> (osgEarth, <a class="el" href="classSinglePassTerrainTechnique.html">SinglePassTerrainTechnique</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#aad7ee72f83efd718654a798045f8a41c">init</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#a103e83251de3710de67e810952f24747">setParentTile</a> (<a class="el" href="classTile.html">Tile</a> *tile)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#a38db1d0b19580a4db1b8b29fa245702c">compile</a> (const <a class="el" href="structTileUpdate.html">TileUpdate</a> &amp;updateSpec, <a class="el" href="classosgEarth_1_1ProgressCallback.html">ProgressCallback</a> *progress)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#ab32efb9633174fc7d8f89a9521feb9cb">applyTileUpdates</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#ac7a0d617084eff87f0075e5e0547e2e7">traverse</a> (osg::NodeVisitor &amp;nv)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#ab01bff854cb10e8649f72fe6b77f011b">setVerticalScaleOverride</a> (float value)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#a4b1083c8b3090b78dc9198ce16710f5d">getVerticalScaleOverride</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#a3b5874efacff9ce3c09e55b0a7939e87">setOptimizeTriangleOrientation</a> (bool optimizeTriangleOrientation)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#a72fe68f4c968f91ac77e32051c296f0b">getOptimizeTriangleOrientation</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#a59f217ea27238586b91f6f3a3b414cdc">releaseGLObjects</a> (osg::State *=0) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">osg::StateSet *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#a4f815dffbcff201fdd1703ba7ee8e288">getActiveStateSet</a> () const </td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#a51849da28ac79c19e5f9820160daf5e0">calculateSampling</a> (unsigned int &amp;out_rows, unsigned int &amp;out_cols, double &amp;out_i, double &amp;out_j)</td></tr>
<tr><td colspan="2"><h2><a name="pri-types"></a>
Private Types</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef std::queue<br class="typebreak"/>
&lt; <a class="el" href="structSinglePassTerrainTechnique_1_1ImageLayerUpdate.html">ImageLayerUpdate</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#a21bd8ad402466a8078a45a5fe572cdb1">ImageLayerUpdates</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef std::map&lt; <a class="el" href="namespaceosgEarth.html#afc79b9a35ed940aaee797fde114b9801">UID</a>, int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#a4ca8ab62c29ab0d43d8cfe604c724282">LayerUIDtoIndexMap</a></td></tr>
<tr><td colspan="2"><h2><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#a6e3145a3d8708abb3c35727ed9b97563">~SinglePassTerrainTechnique</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">osg::Vec3d&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#a96f237077327155338085d0b825cfb95">computeCenterModel</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#aaf6c1a4c000dbcefc89a2c1b795dc26f">createGeoImage</a> (const <a class="el" href="classCustomColorLayer.html">CustomColorLayer</a> &amp;layer, <a class="el" href="classosgEarth_1_1GeoImage.html">GeoImage</a> &amp;image) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">osg::Geode *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#a46e28db8765c6497caa7d6d89e4acb64">createGeometry</a> (const <a class="el" href="classTileFrame.html">TileFrame</a> &amp;tilef)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">osg::StateSet *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#a0804134cb4f0834a42e6630329884b4e">createStateSet</a> (const <a class="el" href="classTileFrame.html">TileFrame</a> &amp;tilef)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#aaff3bb19a4bf4cfc19060c3c26053fb9">prepareImageLayerUpdate</a> (int layerIndex, const <a class="el" href="classTileFrame.html">TileFrame</a> &amp;tilef)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">osg::Geode *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#a569874547276caff6a69d142e7910538">getFrontGeode</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">osg::StateSet *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#aa775992f0528849e57df987f7ea2a99a">getParentStateSet</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#a231e9b18a46e861834e0016df0e6d647">getIndexOfColorLayerWithUID</a> (<a class="el" href="namespaceosgEarth.html#afc79b9a35ed940aaee797fde114b9801">UID</a> uid) const </td></tr>
<tr><td colspan="2"><h2><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#ad638242ef259e6af7c7fffc5dc7b0fb0">_debug</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">OpenThreads::Mutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#ad1bc9e9de18135eeeba07976e83ad857">_compileMutex</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">osg::ref_ptr<br class="typebreak"/>
&lt; osg::MatrixTransform &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#ab4f26ad5ef62bd9f8c1785c2edd7a4cc">_transform</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">osg::ref_ptr&lt; osg::Geode &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#a4d520a524293b3fa797e22f5de77813f">_backGeode</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">osg::ref_ptr&lt; osg::Uniform &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#ab50572dc24e8bd208905f08a682386dd">_imageLayerStampUniform</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">osg::Vec3d&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#a31e8cf34154ced3efa730fd531cf6e14">_centerModel</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#ab3ba452d350fb8303ae315ec2e17d34e">_verticalScaleOverride</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">osg::ref_ptr&lt; <a class="el" href="classosgEarth_1_1GeoLocator.html">GeoLocator</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#a91405d8a9044d1c224d46f4b6017dfad">_masterLocator</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#a5cd17d084ce423ce9092a48201bdffc4">_initCount</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#a4c9a8639abfe2435828ce9c53492ce32">_pendingFullUpdate</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#a8d28aa7d2f1729d355b76c480c337032">_pendingGeometryUpdate</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classSinglePassTerrainTechnique.html#a21bd8ad402466a8078a45a5fe572cdb1">ImageLayerUpdates</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#a440f50a57de0f1d872deb42ba35edc76">_pendingImageLayerUpdates</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classSinglePassTerrainTechnique.html#a4ca8ab62c29ab0d43d8cfe604c724282">LayerUIDtoIndexMap</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#adc4866954df72c2d5d0a6048f77e9687">_layerUIDtoIndexMap</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classosgEarth_1_1GeoExtent.html">GeoExtent</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#ac3cd7043773f87b27a031fdf30cd6ca6">_tileExtent</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classosgEarth_1_1TileKey.html">TileKey</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#a2a1afb3a9679e9c57102e343d9d23ec7">_tileKey</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#a78a25d3a07259ff92e9025eff8b8c027">_optimizeTriangleOrientation</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">osg::ref_ptr&lt; const <br class="typebreak"/>
<a class="el" href="classosgEarth_1_1TextureCompositor.html">TextureCompositor</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#ac52309b549b7b332c14e81241ce25e3a">_texCompositor</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#ab174678a8e8cdfe40e12b03b64812960">_frontGeodeInstalled</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">osg::observer_ptr&lt; <a class="el" href="classTile.html">Tile</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSinglePassTerrainTechnique.html#a2eebc195c0ab7234ffd6c06370b022a8">_parentTile</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>A terrain technique that uses a single texture unit by compositing image layer textures on the GPU.</p>
<p>This technique works by creating a single "mosaic" texture and copying each image layer's texture into that mosaic. It then creates a uniform array that conveys the relative offset and scale information of each sub-texture to a shader. The shader then composites the approprate mosaic texels on the GPU.</p>
<p>Limitations:</p>
<p>This technique is limited by the maximum texture size your GPU will support, since it creates a single mosaic texture. For example, if your GPU's max texture size is 2048, this technique can support 64 256-pixel layers. </p>

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_source.html#l00063">63</a> of file <a class="el" href="SinglePassTerrainTechnique_source.html">SinglePassTerrainTechnique</a>.</p>
</div><hr/><h2>Member Typedef Documentation</h2>
<a class="anchor" id="a21bd8ad402466a8078a45a5fe572cdb1"></a><!-- doxytag: member="SinglePassTerrainTechnique::ImageLayerUpdates" ref="a21bd8ad402466a8078a45a5fe572cdb1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::queue&lt;<a class="el" href="structSinglePassTerrainTechnique_1_1ImageLayerUpdate.html">ImageLayerUpdate</a>&gt; <a class="el" href="classSinglePassTerrainTechnique.html#a21bd8ad402466a8078a45a5fe572cdb1">SinglePassTerrainTechnique::ImageLayerUpdates</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_source.html#l00150">150</a> of file <a class="el" href="SinglePassTerrainTechnique_source.html">SinglePassTerrainTechnique</a>.</p>

</div>
</div>
<a class="anchor" id="a4ca8ab62c29ab0d43d8cfe604c724282"></a><!-- doxytag: member="SinglePassTerrainTechnique::LayerUIDtoIndexMap" ref="a4ca8ab62c29ab0d43d8cfe604c724282" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::map&lt; <a class="el" href="namespaceosgEarth.html#afc79b9a35ed940aaee797fde114b9801">UID</a>, int &gt; <a class="el" href="classSinglePassTerrainTechnique.html#a4ca8ab62c29ab0d43d8cfe604c724282">SinglePassTerrainTechnique::LayerUIDtoIndexMap</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_source.html#l00154">154</a> of file <a class="el" href="SinglePassTerrainTechnique_source.html">SinglePassTerrainTechnique</a>.</p>

</div>
</div>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ae981c67d64ad09d65d81ebf81f3f8673"></a><!-- doxytag: member="SinglePassTerrainTechnique::SinglePassTerrainTechnique" ref="ae981c67d64ad09d65d81ebf81f3f8673" args="(TextureCompositor *compositor=0L)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SinglePassTerrainTechnique::SinglePassTerrainTechnique </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classosgEarth_1_1TextureCompositor.html">TextureCompositor</a> *&#160;</td>
          <td class="paramname"><em>compositor</em> = <code>0L</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_8cpp_source.html#l00068">68</a> of file <a class="el" href="SinglePassTerrainTechnique_8cpp_source.html">SinglePassTerrainTechnique.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                                                                                      :
<a class="code" href="classCustomTerrainTechnique.html#aa1d7fffc6349308f8581240192b9c73b">CustomTerrainTechnique</a>(),
<a class="code" href="classSinglePassTerrainTechnique.html#ab3ba452d350fb8303ae315ec2e17d34e">_verticalScaleOverride</a>(1.0f),
<a class="code" href="classSinglePassTerrainTechnique.html#a5cd17d084ce423ce9092a48201bdffc4">_initCount</a>(0),
<a class="code" href="classSinglePassTerrainTechnique.html#a4c9a8639abfe2435828ce9c53492ce32">_pendingFullUpdate</a>( <span class="keyword">false</span> ),
<a class="code" href="classSinglePassTerrainTechnique.html#a8d28aa7d2f1729d355b76c480c337032">_pendingGeometryUpdate</a>(<span class="keyword">false</span>),
<a class="code" href="classSinglePassTerrainTechnique.html#a78a25d3a07259ff92e9025eff8b8c027">_optimizeTriangleOrientation</a>(<span class="keyword">true</span>),
<a class="code" href="classSinglePassTerrainTechnique.html#ac52309b549b7b332c14e81241ce25e3a">_texCompositor</a>( compositor ),
<a class="code" href="classSinglePassTerrainTechnique.html#ab174678a8e8cdfe40e12b03b64812960">_frontGeodeInstalled</a>( <span class="keyword">false</span> ),
<a class="code" href="classSinglePassTerrainTechnique.html#ad638242ef259e6af7c7fffc5dc7b0fb0">_debug</a>( <span class="keyword">false</span> )
{
    this-&gt;setThreadSafeRefUnref(<span class="keyword">true</span>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac6124dc70eae562dbcc85131e8f5d253"></a><!-- doxytag: member="SinglePassTerrainTechnique::SinglePassTerrainTechnique" ref="ac6124dc70eae562dbcc85131e8f5d253" args="(const SinglePassTerrainTechnique &amp;, const osg::CopyOp &amp;copyop=osg::CopyOp::SHALLOW_COPY)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SinglePassTerrainTechnique::SinglePassTerrainTechnique </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classSinglePassTerrainTechnique.html">SinglePassTerrainTechnique</a> &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const osg::CopyOp &amp;&#160;</td>
          <td class="paramname"><em>copyop</em> = <code>osg::CopyOp::SHALLOW_COPY</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_8cpp_source.html#l00082">82</a> of file <a class="el" href="SinglePassTerrainTechnique_8cpp_source.html">SinglePassTerrainTechnique.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                                                                                                                    :
<a class="code" href="classCustomTerrainTechnique.html#aa1d7fffc6349308f8581240192b9c73b">CustomTerrainTechnique</a>( rhs, copyop ),
<a class="code" href="classSinglePassTerrainTechnique.html#ab3ba452d350fb8303ae315ec2e17d34e">_verticalScaleOverride</a>( rhs.<a class="code" href="classSinglePassTerrainTechnique.html#ab3ba452d350fb8303ae315ec2e17d34e">_verticalScaleOverride</a> ),
<a class="code" href="classSinglePassTerrainTechnique.html#a5cd17d084ce423ce9092a48201bdffc4">_initCount</a>( 0 ),
<a class="code" href="classSinglePassTerrainTechnique.html#a4c9a8639abfe2435828ce9c53492ce32">_pendingFullUpdate</a>( <span class="keyword">false</span> ),
<a class="code" href="classSinglePassTerrainTechnique.html#a8d28aa7d2f1729d355b76c480c337032">_pendingGeometryUpdate</a>( <span class="keyword">false</span> ),
<a class="code" href="classSinglePassTerrainTechnique.html#a78a25d3a07259ff92e9025eff8b8c027">_optimizeTriangleOrientation</a>( rhs.<a class="code" href="classSinglePassTerrainTechnique.html#a78a25d3a07259ff92e9025eff8b8c027">_optimizeTriangleOrientation</a> ),
<a class="code" href="classSinglePassTerrainTechnique.html#ac52309b549b7b332c14e81241ce25e3a">_texCompositor</a>( rhs.<a class="code" href="classSinglePassTerrainTechnique.html#ac52309b549b7b332c14e81241ce25e3a">_texCompositor</a>.get() ),
<a class="code" href="classSinglePassTerrainTechnique.html#ab174678a8e8cdfe40e12b03b64812960">_frontGeodeInstalled</a>( rhs.<a class="code" href="classSinglePassTerrainTechnique.html#ab174678a8e8cdfe40e12b03b64812960">_frontGeodeInstalled</a> ),
<a class="code" href="classSinglePassTerrainTechnique.html#ad638242ef259e6af7c7fffc5dc7b0fb0">_debug</a>( rhs.<a class="code" href="classSinglePassTerrainTechnique.html#ad638242ef259e6af7c7fffc5dc7b0fb0">_debug</a> ),
<a class="code" href="classSinglePassTerrainTechnique.html#a2eebc195c0ab7234ffd6c06370b022a8">_parentTile</a>( rhs.<a class="code" href="classSinglePassTerrainTechnique.html#a2eebc195c0ab7234ffd6c06370b022a8">_parentTile</a> )
{
    <span class="comment">//NOP</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="a6e3145a3d8708abb3c35727ed9b97563"></a><!-- doxytag: member="SinglePassTerrainTechnique::~SinglePassTerrainTechnique" ref="a6e3145a3d8708abb3c35727ed9b97563" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SinglePassTerrainTechnique::~SinglePassTerrainTechnique </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [private, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_8cpp_source.html#l00097">97</a> of file <a class="el" href="SinglePassTerrainTechnique_8cpp_source.html">SinglePassTerrainTechnique.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">//nop</span>
}
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="ab32efb9633174fc7d8f89a9521feb9cb"></a><!-- doxytag: member="SinglePassTerrainTechnique::applyTileUpdates" ref="ab32efb9633174fc7d8f89a9521feb9cb" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool SinglePassTerrainTechnique::applyTileUpdates </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implements <a class="el" href="classCustomTerrainTechnique.html#a7d7b1a908eca66efdfb79e2e303f9059">CustomTerrainTechnique</a>.</p>

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_8cpp_source.html#l00253">253</a> of file <a class="el" href="SinglePassTerrainTechnique_8cpp_source.html">SinglePassTerrainTechnique.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordtype">bool</span> applied = <span class="keyword">false</span>;

    <span class="comment">// serialize access to the compilation mechanism.</span>
    OpenThreads::ScopedLock&lt;Mutex&gt; exclusiveLock( <a class="code" href="classSinglePassTerrainTechnique.html#ad1bc9e9de18135eeeba07976e83ad857">_compileMutex</a> );

    <span class="comment">// process a pending buffer swap:</span>
    <span class="keywordflow">if</span> ( <a class="code" href="classSinglePassTerrainTechnique.html#a4c9a8639abfe2435828ce9c53492ce32">_pendingFullUpdate</a> )
    {
        <span class="keywordflow">if</span> ( <a class="code" href="classSinglePassTerrainTechnique.html#a4d520a524293b3fa797e22f5de77813f">_backGeode</a>-&gt;getStateSet() == 0L )
            <a class="code" href="Notify.html#a13b79c6470fc74594070bd2098afc9de">OE_WARN</a> &lt;&lt; <a class="code" href="SinglePassTerrainTechnique_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;ILLEGAL: backGeode has no stateset&quot;</span> &lt;&lt; std::endl;

        <a class="code" href="classSinglePassTerrainTechnique.html#ab4f26ad5ef62bd9f8c1785c2edd7a4cc">_transform</a>-&gt;setChild( 0, <a class="code" href="classSinglePassTerrainTechnique.html#a4d520a524293b3fa797e22f5de77813f">_backGeode</a>.get() );
        <a class="code" href="classSinglePassTerrainTechnique.html#ab174678a8e8cdfe40e12b03b64812960">_frontGeodeInstalled</a> = <span class="keyword">true</span>;
        <a class="code" href="classSinglePassTerrainTechnique.html#a4d520a524293b3fa797e22f5de77813f">_backGeode</a> = 0L;
        <a class="code" href="classSinglePassTerrainTechnique.html#a4c9a8639abfe2435828ce9c53492ce32">_pendingFullUpdate</a> = <span class="keyword">false</span>;
        <a class="code" href="classSinglePassTerrainTechnique.html#a8d28aa7d2f1729d355b76c480c337032">_pendingGeometryUpdate</a> = <span class="keyword">false</span>;
        applied = <span class="keyword">true</span>;
    }

    <span class="keywordflow">else</span>
    {
        <span class="comment">// process any pending LIVE geometry updates:</span>
        <span class="keywordflow">if</span> ( <a class="code" href="classSinglePassTerrainTechnique.html#a8d28aa7d2f1729d355b76c480c337032">_pendingGeometryUpdate</a> )
        {
            osg::Geode* frontGeode = <a class="code" href="classSinglePassTerrainTechnique.html#a569874547276caff6a69d142e7910538">getFrontGeode</a>();

            <span class="keywordflow">if</span> (frontGeode)
            {

                <span class="keywordflow">if</span> ( <a class="code" href="classSinglePassTerrainTechnique.html#ac52309b549b7b332c14e81241ce25e3a">_texCompositor</a>-&gt;requiresUnitTextureSpace() )
                {
                    <span class="comment">// in &quot;unit-texture-space&quot; mode, we can take the shortcut of just updating</span>
                    <span class="comment">// the geometry VBOs. The texture coordinates never change.</span>
                    <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classSinglePassTerrainTechnique.html#a4d520a524293b3fa797e22f5de77813f">_backGeode</a>-&gt;getNumDrawables(); ++i )
                    {
                        osg::Geometry* backGeom = <span class="keyword">static_cast&lt;</span>osg::Geometry*<span class="keyword">&gt;</span>( <a class="code" href="classSinglePassTerrainTechnique.html#a4d520a524293b3fa797e22f5de77813f">_backGeode</a>-&gt;getDrawable(i) );
                        osg::Vec3Array* backVerts = <span class="keyword">static_cast&lt;</span>osg::Vec3Array*<span class="keyword">&gt;</span>( backGeom-&gt;getVertexArray() );

                        osg::Geometry* frontGeom = <span class="keyword">static_cast&lt;</span>osg::Geometry*<span class="keyword">&gt;</span>( frontGeode-&gt;getDrawable(i) );
                        osg::Vec3Array* frontVerts = <span class="keyword">static_cast&lt;</span>osg::Vec3Array*<span class="keyword">&gt;</span>( frontGeom-&gt;getVertexArray() );

                        <span class="keywordflow">if</span> ( backVerts-&gt;size() == frontVerts-&gt;size() )
                        {
                            <span class="comment">// simple VBO update:</span>
                            <a class="code" href="namespaceanonymous__namespace_02MeshConsolidator_8cpp_03.html#aa89185796215b0f0669f5a44549b6eed">std::copy</a>( backVerts-&gt;begin(), backVerts-&gt;end(), frontVerts-&gt;begin() );
                            frontVerts-&gt;dirty();

                            osg::Vec3Array* backNormals = <span class="keyword">static_cast&lt;</span>osg::Vec3Array*<span class="keyword">&gt;</span>( backGeom-&gt;getNormalArray() );
                            <span class="keywordflow">if</span> ( backNormals )
                            {
                                osg::Vec3Array* frontNormals = <span class="keyword">static_cast&lt;</span>osg::Vec3Array*<span class="keyword">&gt;</span>( frontGeom-&gt;getNormalArray() );
                                <a class="code" href="namespaceanonymous__namespace_02MeshConsolidator_8cpp_03.html#aa89185796215b0f0669f5a44549b6eed">std::copy</a>( backNormals-&gt;begin(), backNormals-&gt;end(), frontNormals-&gt;begin() );
                                frontNormals-&gt;dirty();
                            }

                            osg::Vec2Array* backTexCoords = <span class="keyword">static_cast&lt;</span>osg::Vec2Array*<span class="keyword">&gt;</span>( backGeom-&gt;getTexCoordArray(0) );
                            <span class="keywordflow">if</span> ( backTexCoords )
                            {
                                osg::Vec2Array* frontTexCoords = <span class="keyword">static_cast&lt;</span>osg::Vec2Array*<span class="keyword">&gt;</span>( frontGeom-&gt;getTexCoordArray(0) );
                                <a class="code" href="namespaceanonymous__namespace_02MeshConsolidator_8cpp_03.html#aa89185796215b0f0669f5a44549b6eed">std::copy</a>( backTexCoords-&gt;begin(), backTexCoords-&gt;end(), frontTexCoords-&gt;begin() );
                                frontTexCoords-&gt;dirty();
                            }
                        }
                        <span class="keywordflow">else</span>
                        {
                            frontGeom-&gt;setVertexArray( backVerts );
                            frontGeom-&gt;setTexCoordArray( 0, backGeom-&gt;getTexCoordArray( 0 ) ); <span class="comment">// TODO: un-hard-code</span>
                            <span class="keywordflow">if</span> ( backGeom-&gt;getNormalArray() )
                                frontGeom-&gt;setNormalArray( backGeom-&gt;getNormalArray() );
                        }
                    }
                }
                <span class="keywordflow">else</span>
                {
                    <span class="comment">// copy the drawables from the back buffer to the front buffer. By doing this,</span>
                    <span class="comment">// we don&#39;t touch the front geode&#39;s stateset (which contains the textures) and</span>
                    <span class="comment">// therefore they don&#39;t get re-applied.</span>
                    <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classSinglePassTerrainTechnique.html#a4d520a524293b3fa797e22f5de77813f">_backGeode</a>-&gt;getNumDrawables(); ++i )
                    {
                        frontGeode-&gt;setDrawable( i, <a class="code" href="classSinglePassTerrainTechnique.html#a4d520a524293b3fa797e22f5de77813f">_backGeode</a>-&gt;getDrawable( i ) );
                    }
                }
            }

            <a class="code" href="classSinglePassTerrainTechnique.html#a8d28aa7d2f1729d355b76c480c337032">_pendingGeometryUpdate</a> = <span class="keyword">false</span>;
            <a class="code" href="classSinglePassTerrainTechnique.html#a4d520a524293b3fa797e22f5de77813f">_backGeode</a> = 0L;
            applied = <span class="keyword">true</span>;
        }

        <span class="comment">// process any pending LIVE per-layer updates:</span>
        osg::StateSet* parentStateSet = 0;

        <span class="keywordflow">if</span> ( !<a class="code" href="classSinglePassTerrainTechnique.html#a440f50a57de0f1d872deb42ba35edc76">_pendingImageLayerUpdates</a>.empty() )
        {
            parentStateSet = <a class="code" href="classSinglePassTerrainTechnique.html#aa775992f0528849e57df987f7ea2a99a">getParentStateSet</a>();
        }

        <span class="keywordflow">while</span>( <a class="code" href="classSinglePassTerrainTechnique.html#a440f50a57de0f1d872deb42ba35edc76">_pendingImageLayerUpdates</a>.size() &gt; 0 )
        {
            <span class="keyword">const</span> ImageLayerUpdate&amp; update = <a class="code" href="classSinglePassTerrainTechnique.html#a440f50a57de0f1d872deb42ba35edc76">_pendingImageLayerUpdates</a>.front();

            osg::ref_ptr&lt; osg::Geode &gt; frontGeode = <a class="code" href="classSinglePassTerrainTechnique.html#a569874547276caff6a69d142e7910538">getFrontGeode</a>();
            <span class="keywordflow">if</span> (frontGeode.valid())
            {
                <a class="code" href="classSinglePassTerrainTechnique.html#ac52309b549b7b332c14e81241ce25e3a">_texCompositor</a>-&gt;applyLayerUpdate(
                    frontGeode-&gt;getStateSet(),
                    update._layerUID,
                    update._image,
                    <a class="code" href="classSinglePassTerrainTechnique.html#a2a1afb3a9679e9c57102e343d9d23ec7">_tileKey</a>,
                    update._isRealData ? parentStateSet : 0L );
            }

            <a class="code" href="classSinglePassTerrainTechnique.html#a440f50a57de0f1d872deb42ba35edc76">_pendingImageLayerUpdates</a>.pop();
            applied = <span class="keyword">true</span>;

        }
    }

    <span class="keywordflow">if</span> ( <a class="code" href="classSinglePassTerrainTechnique.html#ad638242ef259e6af7c7fffc5dc7b0fb0">_debug</a> )
    {
        <a class="code" href="Notify.html#a29c29c62ae325bf5871ce5b1695c1720">OE_NOTICE</a> &lt;&lt; <span class="stringliteral">&quot;applyTileUpdates()&quot;</span> &lt;&lt; std::endl;
    }

    <span class="keywordflow">return</span> applied;
}
</pre></div>
<p><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classSinglePassTerrainTechnique_ab32efb9633174fc7d8f89a9521feb9cb_cgraph.png" border="0" usemap="#classSinglePassTerrainTechnique_ab32efb9633174fc7d8f89a9521feb9cb_cgraph" alt=""/></div>
<map name="classSinglePassTerrainTechnique_ab32efb9633174fc7d8f89a9521feb9cb_cgraph" id="classSinglePassTerrainTechnique_ab32efb9633174fc7d8f89a9521feb9cb_cgraph">
<area shape="rect" id="node3" href="namespaceanonymous__namespace_02MeshConsolidator_8cpp_03.html#aa89185796215b0f0669f5a44549b6eed" title="anonymous_namespace\{MeshConsolidator::cpp\}::copy" alt="" coords="352,5,693,35"/><area shape="rect" id="node5" href="classSinglePassTerrainTechnique.html#a569874547276caff6a69d142e7910538" title="SinglePassTerrainTechnique::getFrontGeode" alt="" coords="1093,84,1376,113"/><area shape="rect" id="node7" href="classSinglePassTerrainTechnique.html#aa775992f0528849e57df987f7ea2a99a" title="SinglePassTerrainTechnique::getParentStateSet" alt="" coords="372,109,673,139"/><area shape="rect" id="node9" href="classSinglePassTerrainTechnique.html#a4f815dffbcff201fdd1703ba7ee8e288" title="SinglePassTerrainTechnique::getActiveStateSet" alt="" coords="743,109,1044,139"/></map>
</div>
</p>

<p><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png"/> Here is the caller graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classSinglePassTerrainTechnique_ab32efb9633174fc7d8f89a9521feb9cb_icgraph.png" border="0" usemap="#classSinglePassTerrainTechnique_ab32efb9633174fc7d8f89a9521feb9cb_icgraph" alt=""/></div>
<map name="classSinglePassTerrainTechnique_ab32efb9633174fc7d8f89a9521feb9cb_icgraph" id="classSinglePassTerrainTechnique_ab32efb9633174fc7d8f89a9521feb9cb_icgraph">
<area shape="rect" id="node3" href="classSinglePassTerrainTechnique.html#aad7ee72f83efd718654a798045f8a41c" title="SinglePassTerrainTechnique::init" alt="" coords="352,5,565,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a51849da28ac79c19e5f9820160daf5e0"></a><!-- doxytag: member="SinglePassTerrainTechnique::calculateSampling" ref="a51849da28ac79c19e5f9820160daf5e0" args="(unsigned int &amp;out_rows, unsigned int &amp;out_cols, double &amp;out_i, double &amp;out_j)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SinglePassTerrainTechnique::calculateSampling </td>
          <td>(</td>
          <td class="paramtype">unsigned int &amp;&#160;</td>
          <td class="paramname"><em>out_rows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int &amp;&#160;</td>
          <td class="paramname"><em>out_cols</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>out_i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>out_j</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_8cpp_source.html#l00492">492</a> of file <a class="el" href="SinglePassTerrainTechnique_8cpp_source.html">SinglePassTerrainTechnique.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{            
    osgTerrain::Layer* elevationLayer = <a class="code" href="classTerrainTechnique.html#acfc47d91458541b74f3b60a7eede69a3">_tile</a>-&gt;<a class="code" href="classTile.html#a36219d91d8b17471099bcc5c4bc1b2ed">getElevationLayer</a>();

    out_rows = elevationLayer-&gt;getNumRows();
    out_cols = elevationLayer-&gt;getNumColumns();
    out_i = 1.0;
    out_j = 1.0;

    <span class="keywordtype">float</span> sampleRatio = <a class="code" href="classTerrainTechnique.html#acfc47d91458541b74f3b60a7eede69a3">_tile</a>-&gt;<a class="code" href="classTile.html#a7c0c83673975b5474d61a9845a0cd02b">getTerrain</a>() ? <a class="code" href="classTerrainTechnique.html#acfc47d91458541b74f3b60a7eede69a3">_tile</a>-&gt;<a class="code" href="classTile.html#a7c0c83673975b5474d61a9845a0cd02b">getTerrain</a>()-&gt;<a class="code" href="classTerrain.html#afc533f56374093322731448e6a4b813e">getSampleRatio</a>() : 1.0f;
    <span class="keywordflow">if</span> ( sampleRatio != 1.0f )
    {
        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> originalNumColumns = out_cols;
        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> originalNumRows = out_rows;

        out_cols = osg::maximum((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) (<span class="keywordtype">float</span>(originalNumColumns)*sqrtf(sampleRatio)), 4u);
        out_rows = osg::maximum((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) (<span class="keywordtype">float</span>(originalNumRows)*sqrtf(sampleRatio)),4u);

        out_i = double(originalNumColumns-1)/double(out_cols-1);
        out_j = double(originalNumRows-1)/double(out_rows-1);
    }
}
</pre></div>
<p><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classSinglePassTerrainTechnique_a51849da28ac79c19e5f9820160daf5e0_cgraph.png" border="0" usemap="#classSinglePassTerrainTechnique_a51849da28ac79c19e5f9820160daf5e0_cgraph" alt=""/></div>
<map name="classSinglePassTerrainTechnique_a51849da28ac79c19e5f9820160daf5e0_cgraph" id="classSinglePassTerrainTechnique_a51849da28ac79c19e5f9820160daf5e0_cgraph">
<area shape="rect" id="node3" href="classTile.html#a36219d91d8b17471099bcc5c4bc1b2ed" title="Tile::getElevationLayer" alt="" coords="361,5,516,35"/><area shape="rect" id="node5" href="classTerrain.html#afc533f56374093322731448e6a4b813e" title="Terrain::getSampleRatio" alt="" coords="357,59,520,88"/><area shape="rect" id="node7" href="classTile.html#a7c0c83673975b5474d61a9845a0cd02b" title="Tile::getTerrain" alt="" coords="384,112,493,141"/></map>
</div>
</p>

<p><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png"/> Here is the caller graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classSinglePassTerrainTechnique_a51849da28ac79c19e5f9820160daf5e0_icgraph.png" border="0" usemap="#classSinglePassTerrainTechnique_a51849da28ac79c19e5f9820160daf5e0_icgraph" alt=""/></div>
<map name="classSinglePassTerrainTechnique_a51849da28ac79c19e5f9820160daf5e0_icgraph" id="classSinglePassTerrainTechnique_a51849da28ac79c19e5f9820160daf5e0_icgraph">
<area shape="rect" id="node3" href="classSinglePassTerrainTechnique.html#a46e28db8765c6497caa7d6d89e4acb64" title="SinglePassTerrainTechnique::createGeometry" alt="" coords="359,5,647,35"/><area shape="rect" id="node5" href="classSinglePassTerrainTechnique.html#a38db1d0b19580a4db1b8b29fa245702c" title="SinglePassTerrainTechnique::compile" alt="" coords="697,5,937,35"/><area shape="rect" id="node7" href="classSinglePassTerrainTechnique.html#aad7ee72f83efd718654a798045f8a41c" title="SinglePassTerrainTechnique::init" alt="" coords="987,5,1200,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a38db1d0b19580a4db1b8b29fa245702c"></a><!-- doxytag: member="SinglePassTerrainTechnique::compile" ref="a38db1d0b19580a4db1b8b29fa245702c" args="(const TileUpdate &amp;updateSpec, ProgressCallback *progress)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SinglePassTerrainTechnique::compile </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structTileUpdate.html">TileUpdate</a> &amp;&#160;</td>
          <td class="paramname"><em>updateSpec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classosgEarth_1_1ProgressCallback.html">ProgressCallback</a> *&#160;</td>
          <td class="paramname"><em>progress</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implements <a class="el" href="classCustomTerrainTechnique.html#a1cae6a08eb47d822b77c5e2ce23f308c">CustomTerrainTechnique</a>.</p>

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_8cpp_source.html#l00134">134</a> of file <a class="el" href="SinglePassTerrainTechnique_8cpp_source.html">SinglePassTerrainTechnique.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// safety check</span>
    <span class="keywordflow">if</span> ( !<a class="code" href="classTerrainTechnique.html#acfc47d91458541b74f3b60a7eede69a3">_tile</a> ) 
    {
        <a class="code" href="Notify.html#a13b79c6470fc74594070bd2098afc9de">OE_WARN</a> &lt;&lt; <a class="code" href="SinglePassTerrainTechnique_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;Illegal; terrain tile is null&quot;</span> &lt;&lt; std::endl;
        <span class="keywordflow">return</span>;
    }

    <span class="comment">//if ( _debug )</span>
    <span class="comment">//{</span>
    <span class="comment">//    OE_NOTICE &lt;&lt; LC &lt;&lt; &quot;compile() &quot; &lt;&lt; std::endl;</span>
    <span class="comment">//}</span>

    <span class="comment">// serialize access to the compilation procedure.</span>
    OpenThreads::ScopedLock&lt;Mutex&gt; exclusiveLock( <a class="code" href="classSinglePassTerrainTechnique.html#ad1bc9e9de18135eeeba07976e83ad857">_compileMutex</a> );
    
    <span class="comment">// make a frame to use during compilation.</span>
    <a class="code" href="classTileFrame.html">TileFrame</a> tilef( <a class="code" href="classTerrainTechnique.html#acfc47d91458541b74f3b60a7eede69a3">_tile</a> );

    <span class="comment">// establish the master tile locator if this is the first compilation:</span>
    <span class="keywordflow">if</span> ( !<a class="code" href="classSinglePassTerrainTechnique.html#a91405d8a9044d1c224d46f4b6017dfad">_masterLocator</a>.valid() || !<a class="code" href="classSinglePassTerrainTechnique.html#ab4f26ad5ef62bd9f8c1785c2edd7a4cc">_transform</a>.valid() )
    {
        <a class="code" href="classSinglePassTerrainTechnique.html#a91405d8a9044d1c224d46f4b6017dfad">_masterLocator</a> = <span class="keyword">static_cast&lt;</span><a class="code" href="classosgEarth_1_1GeoLocator.html">GeoLocator</a>*<span class="keyword">&gt;</span>( tilef._locator.get() );
        <a class="code" href="classSinglePassTerrainTechnique.html#a91405d8a9044d1c224d46f4b6017dfad">_masterLocator</a>-&gt;convertLocalToModel( osg::Vec3(.5,.5,0), <a class="code" href="classSinglePassTerrainTechnique.html#a31e8cf34154ced3efa730fd531cf6e14">_centerModel</a> );

        <a class="code" href="classSinglePassTerrainTechnique.html#ab4f26ad5ef62bd9f8c1785c2edd7a4cc">_transform</a> = <span class="keyword">new</span> osg::MatrixTransform( osg::Matrix::translate(<a class="code" href="classSinglePassTerrainTechnique.html#a31e8cf34154ced3efa730fd531cf6e14">_centerModel</a>) );
        <span class="comment">// this is a placeholder so that we can always just call setChild(0) later.</span>
        <a class="code" href="classSinglePassTerrainTechnique.html#ab4f26ad5ef62bd9f8c1785c2edd7a4cc">_transform</a>-&gt;addChild( <span class="keyword">new</span> osg::Group );
    }

    <span class="comment">// see whether a full update is required.</span>
    <span class="keywordtype">bool</span> partialUpdateOK = <a class="code" href="classSinglePassTerrainTechnique.html#ac52309b549b7b332c14e81241ce25e3a">_texCompositor</a>-&gt;supportsLayerUpdate() &amp;&amp; <a class="code" href="classSinglePassTerrainTechnique.html#ab174678a8e8cdfe40e12b03b64812960">_frontGeodeInstalled</a>;

    <span class="comment">// handle image layer addition or update:</span>
    <span class="keywordflow">if</span> (partialUpdateOK &amp;&amp; 
        ( update.getAction() == <a class="code" href="structTileUpdate.html#a6e936293df482c0d99b4aa5fe80bcabda678dff68a2a346db1648149b75e79243">TileUpdate::ADD_IMAGE_LAYER</a> || update.getAction() == <a class="code" href="structTileUpdate.html#a6e936293df482c0d99b4aa5fe80bcabda9df79fd76aceff12ee7fc378537634c3">TileUpdate::UPDATE_IMAGE_LAYER</a> ))
    {
        <a class="code" href="classSinglePassTerrainTechnique.html#aaff3bb19a4bf4cfc19060c3c26053fb9">prepareImageLayerUpdate</a>( update.getLayerUID(), tilef );

        <span class="comment">// conditionally regenerate the texture coordinates for this layer.</span>
        <span class="comment">// TODO: optimize this with a method that ONLY regenerates the texture coordinates.</span>
        <span class="keywordflow">if</span> ( !<a class="code" href="classSinglePassTerrainTechnique.html#ac52309b549b7b332c14e81241ce25e3a">_texCompositor</a>-&gt;requiresUnitTextureSpace() )
        {
            osg::ref_ptr&lt;osg::StateSet&gt; stateSet = <a class="code" href="classSinglePassTerrainTechnique.html#a4d520a524293b3fa797e22f5de77813f">_backGeode</a>.valid() ? <a class="code" href="classSinglePassTerrainTechnique.html#a4d520a524293b3fa797e22f5de77813f">_backGeode</a>-&gt;getStateSet() : 0L;
            <a class="code" href="classSinglePassTerrainTechnique.html#a4d520a524293b3fa797e22f5de77813f">_backGeode</a> = <a class="code" href="classSinglePassTerrainTechnique.html#a46e28db8765c6497caa7d6d89e4acb64">createGeometry</a>( tilef );
            <a class="code" href="classSinglePassTerrainTechnique.html#a4d520a524293b3fa797e22f5de77813f">_backGeode</a>-&gt;setStateSet( stateSet.get() );

            <a class="code" href="classSinglePassTerrainTechnique.html#a8d28aa7d2f1729d355b76c480c337032">_pendingGeometryUpdate</a> = <span class="keyword">true</span>;
        }
    }

    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (partialUpdateOK &amp;&amp; update.getAction() == <a class="code" href="structTileUpdate.html#a6e936293df482c0d99b4aa5fe80bcabda137c487a5379dfdde021423ee7aa03c5">TileUpdate::MOVE_IMAGE_LAYER</a> )
    {
        <span class="comment">//nop - layer re-ordering happens entirely in the texture compositor.</span>
    }

    <span class="comment">//TODO: we should not need to check supportsLayerUpdate here, but it is not working properly in</span>
    <span class="comment">// multitexture mode (white tiles show up). Need to investigate and fix.</span>
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( partialUpdateOK &amp;&amp; update.getAction() == <a class="code" href="structTileUpdate.html#a6e936293df482c0d99b4aa5fe80bcabda22d3b51dc5ea6b4c5672c3fd41d52c3b">TileUpdate::UPDATE_ELEVATION</a> )
    {
        osg::ref_ptr&lt;osg::StateSet&gt; stateSet = <a class="code" href="classSinglePassTerrainTechnique.html#a4d520a524293b3fa797e22f5de77813f">_backGeode</a>.valid() ? <a class="code" href="classSinglePassTerrainTechnique.html#a4d520a524293b3fa797e22f5de77813f">_backGeode</a>-&gt;getStateSet() : 0L;
        <a class="code" href="classSinglePassTerrainTechnique.html#a4d520a524293b3fa797e22f5de77813f">_backGeode</a> = <a class="code" href="classSinglePassTerrainTechnique.html#a46e28db8765c6497caa7d6d89e4acb64">createGeometry</a>( tilef );
        <a class="code" href="classSinglePassTerrainTechnique.html#a4d520a524293b3fa797e22f5de77813f">_backGeode</a>-&gt;setStateSet( stateSet.get() );

        <a class="code" href="classSinglePassTerrainTechnique.html#a8d28aa7d2f1729d355b76c480c337032">_pendingGeometryUpdate</a> = <span class="keyword">true</span>;
    }

    <span class="keywordflow">else</span> <span class="comment">// all other update types</span>
    {
        <span class="comment">// give the engine a chance to bail out before generating geometry</span>
        <span class="keywordflow">if</span> ( progress &amp;&amp; progress-&gt;<a class="code" href="classosgEarth_1_1ProgressCallback.html#abe0f8bf93f93716f3aad268c0fe4c1e7">isCanceled</a>() )
        {
            <a class="code" href="classSinglePassTerrainTechnique.html#a4d520a524293b3fa797e22f5de77813f">_backGeode</a> = 0L;
            <span class="keywordflow">return</span>;
        }
    
        <span class="comment">// create the geometry and texture coordinates for this tile in a new buffer</span>
        <a class="code" href="classSinglePassTerrainTechnique.html#a4d520a524293b3fa797e22f5de77813f">_backGeode</a> = <a class="code" href="classSinglePassTerrainTechnique.html#a46e28db8765c6497caa7d6d89e4acb64">createGeometry</a>( tilef );
        <span class="keywordflow">if</span> ( !<a class="code" href="classSinglePassTerrainTechnique.html#a4d520a524293b3fa797e22f5de77813f">_backGeode</a>.valid() )
        {
            <a class="code" href="Notify.html#a13b79c6470fc74594070bd2098afc9de">OE_WARN</a> &lt;&lt; <a class="code" href="SinglePassTerrainTechnique_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;createGeometry returned NULL&quot;</span> &lt;&lt; std::endl;
            <span class="keywordflow">return</span>;
        }

        <span class="comment">// give the engine a chance to bail out before building the texture stateset:</span>
        <span class="keywordflow">if</span> ( progress &amp;&amp; progress-&gt;<a class="code" href="classosgEarth_1_1ProgressCallback.html#abe0f8bf93f93716f3aad268c0fe4c1e7">isCanceled</a>() )
        {
            <a class="code" href="classSinglePassTerrainTechnique.html#a4d520a524293b3fa797e22f5de77813f">_backGeode</a> = 0L;
            <span class="keywordflow">return</span>;
        }

        <span class="comment">// create the stateset for this tile, which contains all the texture information.</span>
        osg::StateSet* stateSet = <a class="code" href="classSinglePassTerrainTechnique.html#a0804134cb4f0834a42e6630329884b4e">createStateSet</a>( tilef );
        <span class="keywordflow">if</span> ( stateSet )
        {
            <a class="code" href="classSinglePassTerrainTechnique.html#a4d520a524293b3fa797e22f5de77813f">_backGeode</a>-&gt;setStateSet( stateSet );
        }

        <span class="comment">// give the engine a chance to bail out before swapping buffers</span>
        <span class="keywordflow">if</span> ( progress &amp;&amp; progress-&gt;<a class="code" href="classosgEarth_1_1ProgressCallback.html#abe0f8bf93f93716f3aad268c0fe4c1e7">isCanceled</a>() )
        {
            <a class="code" href="classSinglePassTerrainTechnique.html#a4d520a524293b3fa797e22f5de77813f">_backGeode</a> = 0L;
            <span class="keywordflow">return</span>;
        }
       
        <a class="code" href="classSinglePassTerrainTechnique.html#a5cd17d084ce423ce9092a48201bdffc4">_initCount</a>++;
        <span class="keywordflow">if</span> ( <a class="code" href="classSinglePassTerrainTechnique.html#a5cd17d084ce423ce9092a48201bdffc4">_initCount</a> &gt; 1 )
            <a class="code" href="Notify.html#a13b79c6470fc74594070bd2098afc9de">OE_WARN</a> &lt;&lt; <a class="code" href="SinglePassTerrainTechnique_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;Tile was fully build &quot;</span> &lt;&lt; <a class="code" href="classSinglePassTerrainTechnique.html#a5cd17d084ce423ce9092a48201bdffc4">_initCount</a> &lt;&lt; <span class="stringliteral">&quot; times&quot;</span> &lt;&lt; std::endl;

        <span class="keywordflow">if</span> ( <a class="code" href="classSinglePassTerrainTechnique.html#a4d520a524293b3fa797e22f5de77813f">_backGeode</a>.valid() &amp;&amp; !<a class="code" href="classSinglePassTerrainTechnique.html#a4d520a524293b3fa797e22f5de77813f">_backGeode</a>-&gt;getStateSet() )
            <a class="code" href="Notify.html#a13b79c6470fc74594070bd2098afc9de">OE_WARN</a> &lt;&lt; <a class="code" href="SinglePassTerrainTechnique_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;ILLEGAL! no stateset in BackGeode!!&quot;</span> &lt;&lt; std::endl;

        <a class="code" href="classSinglePassTerrainTechnique.html#a4c9a8639abfe2435828ce9c53492ce32">_pendingFullUpdate</a> = <span class="keyword">true</span>;
    }
}
</pre></div>
<p><div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png"/> Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classSinglePassTerrainTechnique_a38db1d0b19580a4db1b8b29fa245702c_cgraph.png" border="0" usemap="#classSinglePassTerrainTechnique_a38db1d0b19580a4db1b8b29fa245702c_cgraph" alt=""/></div>
<map name="classSinglePassTerrainTechnique_a38db1d0b19580a4db1b8b29fa245702c_cgraph" id="classSinglePassTerrainTechnique_a38db1d0b19580a4db1b8b29fa245702c_cgraph">
<area shape="rect" id="node3" href="classSinglePassTerrainTechnique.html#a46e28db8765c6497caa7d6d89e4acb64" title="SinglePassTerrainTechnique::createGeometry" alt="" coords="327,255,615,284"/><area shape="rect" id="node41" href="classSinglePassTerrainTechnique.html#a0804134cb4f0834a42e6630329884b4e" title="SinglePassTerrainTechnique::createStateSet" alt="" coords="329,596,612,625"/><area shape="rect" id="node68" href="structTileUpdate.html#a8462dd4c2eee5ffe575de63f4f5bafb6" title="TileUpdate::getAction" alt="" coords="397,729,544,759"/><area shape="rect" id="node70" href="structTileUpdate.html#a9290735e48c4063f0ca693463d082ab3" title="TileUpdate::getLayerUID" alt="" coords="388,783,553,812"/><area shape="rect" id="node72" href="classosgEarth_1_1ProgressCallback.html#abe0f8bf93f93716f3aad268c0fe4c1e7" title="osgEarth::ProgressCallback::isCanceled" alt="" coords="341,836,600,865"/><area shape="rect" id="node74" href="classSinglePassTerrainTechnique.html#aaff3bb19a4bf4cfc19060c3c26053fb9" title="SinglePassTerrainTechnique::prepareImageLayerUpdate" alt="" coords="296,676,645,705"/><area shape="rect" id="node5" href="classSinglePassTerrainTechnique.html#a51849da28ac79c19e5f9820160daf5e0" title="SinglePassTerrainTechnique::calculateSampling" alt="" coords="695,69,996,99"/><area shape="rect" id="node7" href="classTile.html#a36219d91d8b17471099bcc5c4bc1b2ed" title="Tile::getElevationLayer" alt="" coords="1160,15,1315,44"/><area shape="rect" id="node11" href="classTile.html#a7c0c83673975b5474d61a9845a0cd02b" title="Tile::getTerrain" alt="" coords="1183,121,1292,151"/><area shape="rect" id="node14" href="classosgEarth_1_1GeoLocator.html#a125f2bd702f4a911c65c6fe9334c640a" title="osgEarth::GeoLocator::getGeographicFromGeocentric" alt="" coords="1071,439,1404,468"/><area shape="rect" id="node22" href="classosgEarth_1_1Symbology_1_1Polygon.html#aef6967b31b28c8a5119269aaed5ad429" title="osgEarth::Symbology::Polygon::getHoles" alt="" coords="715,228,976,257"/><area shape="rect" id="node25" href="classosgEarth_1_1Symbology_1_1Geometry.html#a12044f75418af11e87a616a78967e5b1" title="osgEarth::Symbology::Geometry::getType" alt="" coords="712,281,979,311"/><area shape="rect" id="node27" href="classCustomColorLayer.html#af539b1957865fd51e5eb75ef7bd497ed" title="CustomColorLayer::getUID" alt="" coords="755,439,936,468"/><area shape="rect" id="node29" href="classTerrain.html#a9137bf26a5edaf11515e74aa58a6caf4" title="Terrain::getVerticalScale" alt="" coords="763,335,928,364"/><area shape="rect" id="node31" href="classosgEarth_1_1Symbology_1_1Geometry.html#ab226e51c4de9dac844f6ed63fded1129" title="osgEarth::Symbology::Geometry::toVec3Array" alt="" coords="700,175,991,204"/><area shape="rect" id="node9" href="classTerrain.html#afc533f56374093322731448e6a4b813e" title="Terrain::getSampleRatio" alt="" coords="1156,68,1319,97"/><area shape="rect" id="node16" href="classosgEarth_1_1GeoLocator.html#a3d6d7da71a8187c45110890a550b5655" title="osgEarth::GeoLocator::GeoLocator" alt="" coords="1507,465,1731,495"/><area shape="rect" id="node18" href="classosgEarth_1_1GeoExtent.html#afa0bd831daf0541cbbb161763ed9291f" title="osgEarth::GeoExtent::getBounds" alt="" coords="1512,359,1725,388"/><area shape="rect" id="node20" href="classosgEarth_1_1GeoLocator.html#a0ed2730a383c6a42c1df8bb6b07fc6df" title="osgEarth::GeoLocator::getDataExtent" alt="" coords="1499,412,1739,441"/><area shape="rect" id="node33" href="classosgEarth_1_1MixinVector.html#a09e839d601931f13776d30648ecd97f0" title="osgEarth::MixinVector\&lt; osg::Vec3d, osg::Referenced \&gt;::begin" alt="" coords="1045,335,1429,364"/><area shape="rect" id="node35" href="namespaceanonymous__namespace_02MeshConsolidator_8cpp_03.html#aa89185796215b0f0669f5a44549b6eed" title="anonymous_namespace\{MeshConsolidator::cpp\}::copy" alt="" coords="1067,175,1408,204"/><area shape="rect" id="node37" href="classosgEarth_1_1MixinVector.html#ad40d751f91c9b8637fc5a274e75cd8a7" title="osgEarth::MixinVector\&lt; osg::Vec3d, osg::Referenced \&gt;::end" alt="" coords="1051,228,1424,257"/><area shape="rect" id="node39" href="classosgEarth_1_1MixinVector.html#a29d1318457f75e1e0841d7e20f61dadb" title="osgEarth::MixinVector\&lt; osg::Vec3d, osg::Referenced \&gt;::size" alt="" coords="1049,281,1425,311"/><area shape="rect" id="node43" href="classSinglePassTerrainTechnique.html#aaf6c1a4c000dbcefc89a2c1b795dc26f" title="SinglePassTerrainTechnique::createGeoImage" alt="" coords="700,649,991,679"/><area shape="rect" id="node51" href="classSinglePassTerrainTechnique.html#aa775992f0528849e57df987f7ea2a99a" title="SinglePassTerrainTechnique::getParentStateSet" alt="" coords="695,543,996,572"/><area shape="rect" id="node58" href="classCustomColorLayer.html#abf341a630a68be118bfe8ab562b6eb78" title="CustomColorLayer::isFallbackData" alt="" coords="732,703,959,732"/><area shape="rect" id="node60" href="classosgEarth_1_1GeoExtent.html#a8151cbc0905e59c9d88e6fad5690a0ce" title="osgEarth::GeoExtent::isValid" alt="" coords="751,596,940,625"/><area shape="rect" id="node46" href="classCustomColorLayer.html#a761fdfb07388be6ac6438c2b96c7639d" title="CustomColorLayer::getImage" alt="" coords="1141,679,1333,708"/><area shape="rect" id="node48" href="classCustomColorLayer.html#ac9725adc85c194c7b4a4c99ed26d3d52" title="CustomColorLayer::getLocator" alt="" coords="1137,732,1337,761"/><area shape="rect" id="node53" href="classSinglePassTerrainTechnique.html#a4f815dffbcff201fdd1703ba7ee8e288" title="SinglePassTerrainTechnique::getActiveStateSet" alt="" coords="1087,519,1388,548"/><area shape="rect" id="node55" href="classSinglePassTerrainTechnique.html#a569874547276caff6a69d142e7910538" title="SinglePassTerrainTechnique::getFrontGeode" alt="" coords="1477,519,1760,548"/><area shape="rect" id="node62" href="classosgEarth_1_1GeoExtent.html#a9ed09180cbcdd15321ced7b24f4c4c9d" title="osgEarth::GeoExtent::height" alt="" coords="1144,625,1331,655"/><area shape="rect" id="node64" href="classosgEarth_1_1GeoExtent.html#a1161940ef6756ba732ff7fc7da21db2d" title="osgEarth::GeoExtent::width" alt="" coords="1147,572,1328,601"/><area shape="rect" id="node66" href="classosgEarth_1_1GeoExtent.html#a744d26309f6eddfd74b72a01c159dc79" title="osgEarth::GeoExtent::crossesDateLine" alt="" coords="1493,572,1744,601"/><area shape="rect" id="node77" href="classTileFrame.html#aa64f473bf7c23057885cb44209238ea2" title="TileFrame::getCustomColorLayer" alt="" coords="739,756,952,785"/><area shape="rect" id="node80" href="classosgEarth_1_1GeoImage.html#a40db87ae60b4dde189b1f218ff3c8777" title="osgEarth::GeoImage::valid" alt="" coords="757,809,933,839"/></map>
</div>
</p>

<p><div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png"/> Here is the caller graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classSinglePassTerrainTechnique_a38db1d0b19580a4db1b8b29fa245702c_icgraph.png" border="0" usemap="#classSinglePassTerrainTechnique_a38db1d0b19580a4db1b8b29fa245702c_icgraph" alt=""/></div>
<map name="classSinglePassTerrainTechnique_a38db1d0b19580a4db1b8b29fa245702c_icgraph" id="classSinglePassTerrainTechnique_a38db1d0b19580a4db1b8b29fa245702c_icgraph">
<area shape="rect" id="node3" href="classSinglePassTerrainTechnique.html#aad7ee72f83efd718654a798045f8a41c" title="SinglePassTerrainTechnique::init" alt="" coords="296,5,509,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a96f237077327155338085d0b825cfb95"></a><!-- doxytag: member="SinglePassTerrainTechnique::computeCenterModel" ref="a96f237077327155338085d0b825cfb95" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">osg::Vec3d SinglePassTerrainTechnique::computeCenterModel </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aaf6c1a4c000dbcefc89a2c1b795dc26f"></a><!-- doxytag: member="SinglePassTerrainTechnique::createGeoImage" ref="aaf6c1a4c000dbcefc89a2c1b795dc26f" args="(const CustomColorLayer &amp;layer, GeoImage &amp;image) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool SinglePassTerrainTechnique::createGeoImage </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCustomColorLayer.html">CustomColorLayer</a> &amp;&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classosgEarth_1_1GeoImage.html">GeoImage</a> &amp;&#160;</td>
          <td class="paramname"><em>image</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_8cpp_source.html#l00405">405</a> of file <a class="el" href="SinglePassTerrainTechnique_8cpp_source.html">SinglePassTerrainTechnique.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    osg::ref_ptr&lt;const GeoLocator&gt; layerLocator = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="classosgEarth_1_1GeoLocator.html">GeoLocator</a>*<span class="keyword">&gt;</span>( colorLayer.getLocator() );
    <span class="keywordflow">if</span> ( layerLocator.valid() )
    {
        <span class="keywordflow">if</span> ( layerLocator-&gt;getCoordinateSystemType() == osgTerrain::Locator::GEOCENTRIC )
            layerLocator = layerLocator-&gt;<a class="code" href="classosgEarth_1_1GeoLocator.html#a125f2bd702f4a911c65c6fe9334c640a">getGeographicFromGeocentric</a>();

        <span class="keyword">const</span> <a class="code" href="classosgEarth_1_1GeoExtent.html">GeoExtent</a>&amp; imageExtent = layerLocator-&gt;getDataExtent();
        image = <a class="code" href="classosgEarth_1_1GeoImage.html">GeoImage</a>( colorLayer.getImage(), imageExtent ); <span class="comment">//const_cast&lt;osg::Image*&gt;(colorLayer.getImage()), imageExtent );</span>
        <span class="keywordflow">return</span> <span class="keyword">true</span>;
    }
    <span class="keywordflow">return</span> <span class="keyword">false</span>;
}
</pre></div>
<p><div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png"/> Here is the call graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classSinglePassTerrainTechnique_aaf6c1a4c000dbcefc89a2c1b795dc26f_cgraph.png" border="0" usemap="#classSinglePassTerrainTechnique_aaf6c1a4c000dbcefc89a2c1b795dc26f_cgraph" alt=""/></div>
<map name="classSinglePassTerrainTechnique_aaf6c1a4c000dbcefc89a2c1b795dc26f_cgraph" id="classSinglePassTerrainTechnique_aaf6c1a4c000dbcefc89a2c1b795dc26f_cgraph">
<area shape="rect" id="node3" href="classosgEarth_1_1GeoLocator.html#a125f2bd702f4a911c65c6fe9334c640a" title="osgEarth::GeoLocator::getGeographicFromGeocentric" alt="" coords="348,59,681,88"/><area shape="rect" id="node11" href="classCustomColorLayer.html#a761fdfb07388be6ac6438c2b96c7639d" title="CustomColorLayer::getImage" alt="" coords="419,112,611,141"/><area shape="rect" id="node13" href="classCustomColorLayer.html#ac9725adc85c194c7b4a4c99ed26d3d52" title="CustomColorLayer::getLocator" alt="" coords="415,165,615,195"/><area shape="rect" id="node5" href="classosgEarth_1_1GeoLocator.html#a3d6d7da71a8187c45110890a550b5655" title="osgEarth::GeoLocator::GeoLocator" alt="" coords="740,5,964,35"/><area shape="rect" id="node7" href="classosgEarth_1_1GeoExtent.html#afa0bd831daf0541cbbb161763ed9291f" title="osgEarth::GeoExtent::getBounds" alt="" coords="745,59,959,88"/><area shape="rect" id="node9" href="classosgEarth_1_1GeoLocator.html#a0ed2730a383c6a42c1df8bb6b07fc6df" title="osgEarth::GeoLocator::getDataExtent" alt="" coords="732,112,972,141"/></map>
</div>
</p>

<p><div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="closed.png"/> Here is the caller graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classSinglePassTerrainTechnique_aaf6c1a4c000dbcefc89a2c1b795dc26f_icgraph.png" border="0" usemap="#classSinglePassTerrainTechnique_aaf6c1a4c000dbcefc89a2c1b795dc26f_icgraph" alt=""/></div>
<map name="classSinglePassTerrainTechnique_aaf6c1a4c000dbcefc89a2c1b795dc26f_icgraph" id="classSinglePassTerrainTechnique_aaf6c1a4c000dbcefc89a2c1b795dc26f_icgraph">
<area shape="rect" id="node3" href="classSinglePassTerrainTechnique.html#a0804134cb4f0834a42e6630329884b4e" title="SinglePassTerrainTechnique::createStateSet" alt="" coords="380,5,663,35"/><area shape="rect" id="node9" href="classSinglePassTerrainTechnique.html#aaff3bb19a4bf4cfc19060c3c26053fb9" title="SinglePassTerrainTechnique::prepareImageLayerUpdate" alt="" coords="347,59,696,88"/><area shape="rect" id="node5" href="classSinglePassTerrainTechnique.html#a38db1d0b19580a4db1b8b29fa245702c" title="SinglePassTerrainTechnique::compile" alt="" coords="745,32,985,61"/><area shape="rect" id="node7" href="classSinglePassTerrainTechnique.html#aad7ee72f83efd718654a798045f8a41c" title="SinglePassTerrainTechnique::init" alt="" coords="1035,32,1248,61"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a46e28db8765c6497caa7d6d89e4acb64"></a><!-- doxytag: member="SinglePassTerrainTechnique::createGeometry" ref="a46e28db8765c6497caa7d6d89e4acb64" args="(const TileFrame &amp;tilef)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">osg::Geode * SinglePassTerrainTechnique::createGeometry </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTileFrame.html">TileFrame</a> &amp;&#160;</td>
          <td class="paramname"><em>tilef</em></td><td>)</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_8cpp_source.html#l00552">552</a> of file <a class="el" href="SinglePassTerrainTechnique_8cpp_source.html">SinglePassTerrainTechnique.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    osg::ref_ptr&lt;GeoLocator&gt; masterTextureLocator = <a class="code" href="classSinglePassTerrainTechnique.html#a91405d8a9044d1c224d46f4b6017dfad">_masterLocator</a>.get();
    <span class="comment">//GeoLocator* geoMasterLocator = dynamic_cast&lt;GeoLocator*&gt;(_masterLocator.get());</span>

        <span class="keywordtype">bool</span> isCube = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classosgEarth_1_1CubeFaceLocator.html">CubeFaceLocator</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSinglePassTerrainTechnique.html#a91405d8a9044d1c224d46f4b6017dfad">_masterLocator</a>.get()) != <a class="code" href="Export.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;

    <span class="comment">// If we have a geocentric locator, get a geographic version of it to avoid converting</span>
    <span class="comment">// to/from geocentric when computing texture coordinats</span>
    <span class="keywordflow">if</span> (!isCube &amp;&amp; <span class="comment">/*geoMasterLocator &amp;&amp; */</span> <a class="code" href="classSinglePassTerrainTechnique.html#a91405d8a9044d1c224d46f4b6017dfad">_masterLocator</a>-&gt;getCoordinateSystemType() == osgTerrain::Locator::GEOCENTRIC)
    {
        masterTextureLocator = masterTextureLocator-&gt;getGeographicFromGeocentric();
    }
    
    osgTerrain::Layer* elevationLayer = <a class="code" href="classTerrainTechnique.html#acfc47d91458541b74f3b60a7eede69a3">_tile</a>-&gt;<a class="code" href="classTile.html#a36219d91d8b17471099bcc5c4bc1b2ed">getElevationLayer</a>();

    <span class="comment">// fire up a brand new geode.</span>
    osg::Geode* geode = <span class="keyword">new</span> osg::Geode();
    geode-&gt;setThreadSafeRefUnref(<span class="keyword">true</span>);
    
    <span class="comment">// setting the geometry to DYNAMIC means its draw will not overlap the next frame&#39;s update/cull</span>
    <span class="comment">// traversal - which could access the buffer without a mutex</span>

    osg::Geometry* surface = <span class="keyword">new</span> osg::Geometry();
    surface-&gt;setThreadSafeRefUnref(<span class="keyword">true</span>); <span class="comment">// TODO: probably unnecessary.</span>
    surface-&gt;setDataVariance( osg::Object::DYNAMIC );
    surface-&gt;setUseDisplayList(<span class="keyword">false</span>);
    surface-&gt;setUseVertexBufferObjects(<span class="keyword">true</span>);
    geode-&gt;addDrawable( surface );

    osg::Geometry* skirt = <span class="keyword">new</span> osg::Geometry();
    skirt-&gt;setThreadSafeRefUnref(<span class="keyword">true</span>); <span class="comment">// TODO: probably unnecessary.</span>
    skirt-&gt;setDataVariance( osg::Object::DYNAMIC );
    skirt-&gt;setUseDisplayList(<span class="keyword">false</span>);
    skirt-&gt;setUseVertexBufferObjects(<span class="keyword">true</span>);
    geode-&gt;addDrawable( skirt );

        osg::ref_ptr&lt;GeoLocator&gt; geoLocator = <a class="code" href="classSinglePassTerrainTechnique.html#a91405d8a9044d1c224d46f4b6017dfad">_masterLocator</a>;
        <span class="comment">// Avoid coordinates conversion when GEOCENTRIC, so get a GEOGRAPHIC version of Locator </span>
        <span class="keywordflow">if</span> (<a class="code" href="classSinglePassTerrainTechnique.html#a91405d8a9044d1c224d46f4b6017dfad">_masterLocator</a>-&gt;getCoordinateSystemType() == osgTerrain::Locator::GEOCENTRIC) {
                geoLocator = <a class="code" href="classSinglePassTerrainTechnique.html#a91405d8a9044d1c224d46f4b6017dfad">_masterLocator</a>-&gt;getGeographicFromGeocentric();
        }

        <span class="keywordtype">float</span> scaleHeight = 
                <a class="code" href="classSinglePassTerrainTechnique.html#ab3ba452d350fb8303ae315ec2e17d34e">_verticalScaleOverride</a> != 1.0? <a class="code" href="classSinglePassTerrainTechnique.html#ab3ba452d350fb8303ae315ec2e17d34e">_verticalScaleOverride</a> :
                <a class="code" href="classTerrainTechnique.html#acfc47d91458541b74f3b60a7eede69a3">_tile</a>-&gt;<a class="code" href="classTile.html#a7c0c83673975b5474d61a9845a0cd02b">getTerrain</a>() ? <a class="code" href="classTerrainTechnique.html#acfc47d91458541b74f3b60a7eede69a3">_tile</a>-&gt;<a class="code" href="classTile.html#a7c0c83673975b5474d61a9845a0cd02b">getTerrain</a>()-&gt;<a class="code" href="classTerrain.html#a9137bf26a5edaf11515e74aa58a6caf4">getVerticalScale</a>() :
                1.0f;

    <a class="code" href="namespaceanonymous__namespace_02SinglePassTerrainTechnique_8cpp_03.html#a24dbc2754f5d1a234317b52f6f5506df">MaskRecordVector</a> masks;
    <span class="keywordflow">for</span> (MaskLayerVector::const_iterator it = tilef.<a class="code" href="classTileFrame.html#a7239c6bdd436bab296831728bb924930">_masks</a>.begin(); it != tilef.<a class="code" href="classTileFrame.html#a7239c6bdd436bab296831728bb924930">_masks</a>.end(); ++it)
    {
          <span class="comment">// When displaying Plate Carre, Heights have to be converted from meters to degrees.</span>
          <span class="comment">// This is also true for mask feature</span>
          <span class="comment">// TODO: adjust this calculation based on the actual EllipsoidModel.</span>
          <span class="keywordtype">float</span> scale = scaleHeight;
          <span class="keywordflow">if</span> (<a class="code" href="classSinglePassTerrainTechnique.html#a91405d8a9044d1c224d46f4b6017dfad">_masterLocator</a>-&gt;getCoordinateSystemType() == osgEarth::GeoLocator::GEOGRAPHIC)
                scale = scaleHeight / 111319.0f;

          <span class="comment">// TODO: Get the map SRS if possible instead of masterLocator&#39;s one</span>
          osg::Vec3dArray* boundary = (*it)-&gt;getOrCreateBoundary(scale, <a class="code" href="classSinglePassTerrainTechnique.html#a91405d8a9044d1c224d46f4b6017dfad">_masterLocator</a>-&gt;getDataExtent().getSRS());

      <span class="keywordflow">if</span> ( boundary )
      {
          osg::Vec3d min, max;
          min = max = boundary-&gt;front();

          <span class="keywordflow">for</span> (osg::Vec3dArray::iterator it = boundary-&gt;begin(); it != boundary-&gt;end(); ++it)
          {
            <span class="keywordflow">if</span> (it-&gt;x() &lt; min.x())
              min.x() = it-&gt;x();

            <span class="keywordflow">if</span> (it-&gt;y() &lt; min.y())
              min.y() = it-&gt;y();

            <span class="keywordflow">if</span> (it-&gt;x() &gt; max.x())
              max.x() = it-&gt;x();

            <span class="keywordflow">if</span> (it-&gt;y() &gt; max.y())
              max.y() = it-&gt;y();
          }

          osg::Vec3d min_ndc, max_ndc;
          geoLocator-&gt;convertModelToLocal(min, min_ndc);
          geoLocator-&gt;convertModelToLocal(max, max_ndc);

          <span class="keywordtype">bool</span> x_match = ((min_ndc.x() &gt;= 0.0 &amp;&amp; max_ndc.x() &lt;= 1.0) ||
                          (min_ndc.x() &lt;= 0.0 &amp;&amp; max_ndc.x() &gt; 0.0) ||
                          (min_ndc.x() &lt; 1.0 &amp;&amp; max_ndc.x() &gt;= 1.0));

          <span class="keywordtype">bool</span> y_match = ((min_ndc.y() &gt;= 0.0 &amp;&amp; max_ndc.y() &lt;= 1.0) ||
                          (min_ndc.y() &lt;= 0.0 &amp;&amp; max_ndc.y() &gt; 0.0) ||
                          (min_ndc.y() &lt; 1.0 &amp;&amp; max_ndc.y() &gt;= 1.0));

          <span class="keywordflow">if</span> (x_match &amp;&amp; y_match)
          {
            osg::Geometry* mask_geom = <span class="keyword">new</span> osg::Geometry();
            mask_geom-&gt;setThreadSafeRefUnref(<span class="keyword">true</span>);
            mask_geom-&gt;setDataVariance( osg::Object::DYNAMIC );
            mask_geom-&gt;setUseDisplayList(<span class="keyword">false</span>);
            mask_geom-&gt;setUseVertexBufferObjects(<span class="keyword">true</span>);
            <span class="comment">//mask_geom-&gt;getOrCreateStateSet()-&gt;setAttribute(new osg::Point( 5.0f ), osg::StateAttribute::ON);</span>
            geode-&gt;addDrawable(mask_geom);

            masks.push_back(MaskRecord(boundary, min_ndc, max_ndc, mask_geom));
          }
       }
    }

    osg::Geometry* stitching_skirts = 0L;
    osg::Vec3Array* ss_verts = 0L;
    <span class="keywordflow">if</span> (masks.size() &gt; 0)
    {
      stitching_skirts = <span class="keyword">new</span> osg::Geometry();
      stitching_skirts-&gt;setThreadSafeRefUnref(<span class="keyword">true</span>);
      stitching_skirts-&gt;setDataVariance( osg::Object::DYNAMIC );
      stitching_skirts-&gt;setUseDisplayList(<span class="keyword">false</span>);
      stitching_skirts-&gt;setUseVertexBufferObjects(<span class="keyword">true</span>);
      <span class="comment">//stitching_skirts-&gt;getOrCreateStateSet()-&gt;setAttribute(new osg::Point( 5.0f ), osg::StateAttribute::ON);</span>
      geode-&gt;addDrawable( stitching_skirts);

      ss_verts = <span class="keyword">new</span> osg::Vec3Array();
      stitching_skirts-&gt;setVertexArray(ss_verts);
    }


    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> numRows = 20;
    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> numColumns = 20;
    
    <span class="keywordflow">if</span> (elevationLayer)
    {
        numColumns = elevationLayer-&gt;getNumColumns();
        numRows = elevationLayer-&gt;getNumRows();
    }
    
    <span class="keywordtype">double</span> i_sampleFactor, j_sampleFactor;
    <a class="code" href="classSinglePassTerrainTechnique.html#a51849da28ac79c19e5f9820160daf5e0">calculateSampling</a>( numColumns, numRows, i_sampleFactor, j_sampleFactor );
    
    <span class="keywordtype">float</span> skirtHeight = 0.0f;
    osgTerrain::HeightFieldLayer* hfl = <span class="keyword">dynamic_cast&lt;</span>osgTerrain::HeightFieldLayer*<span class="keyword">&gt;</span>(elevationLayer);
    <span class="keywordflow">if</span> (hfl &amp;&amp; hfl-&gt;getHeightField()) 
    {
        skirtHeight = hfl-&gt;getHeightField()-&gt;getSkirtHeight();
    }
    
    <span class="keywordtype">bool</span> createSkirt = skirtHeight != 0.0f;
  
    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> numVerticesInSurface = numColumns*numRows;
    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> numVerticesInSkirt = createSkirt ? (2 * (numColumns*2 + numRows*2 - 4)) : 0;
    <span class="comment">//unsigned int numVertices = numVerticesInBody+numVerticesInSkirt;</span>

    <span class="comment">// allocate and assign vertices</span>
    osg::ref_ptr&lt;osg::Vec3Array&gt; surfaceVerts = <span class="keyword">new</span> osg::Vec3Array;
    surfaceVerts-&gt;reserve( numVerticesInSurface );
    surface-&gt;setVertexArray( surfaceVerts.get() );

    <span class="comment">// allocate and assign normals</span>
    osg::ref_ptr&lt;osg::Vec3Array&gt; normals = <span class="keyword">new</span> osg::Vec3Array();
    normals-&gt;reserve(numVerticesInSurface);
    surface-&gt;setNormalArray(normals.get());
    surface-&gt;setNormalBinding(osg::Geometry::BIND_PER_VERTEX);

    <span class="comment">// skirt texture coordinates, if applicable:</span>
    osg::Vec2Array* unifiedSkirtTexCoords = 0L;

    <span class="comment">// stitching skirt texture coordinates, if applicable:</span>
    osg::Vec2Array* unifiedStitchSkirtTexCoords = 0L;

    <span class="comment">// allocate and assign texture coordinates</span>
    osg::Vec2Array* unifiedSurfaceTexCoords = 0L;

    <span class="comment">//int numColorLayers = _tile-&gt;getNumColorLayers();</span>
    <a class="code" href="namespaceanonymous__namespace_02SinglePassTerrainTechnique_8cpp_03.html#ad801d2614a3d4153690f306d74f2ab6b">RenderLayerVector</a> renderLayers;

    <span class="keywordflow">if</span> ( <a class="code" href="classSinglePassTerrainTechnique.html#ac52309b549b7b332c14e81241ce25e3a">_texCompositor</a>-&gt;requiresUnitTextureSpace() )
    {
        <span class="comment">// for a unified unit texture space, just make a single texture coordinate array.</span>
        unifiedSurfaceTexCoords = <span class="keyword">new</span> osg::Vec2Array();
        unifiedSurfaceTexCoords-&gt;reserve( numVerticesInSurface );
        surface-&gt;setTexCoordArray( 0, unifiedSurfaceTexCoords );
        <span class="keywordflow">if</span> (createSkirt)
        {
            unifiedSkirtTexCoords = <span class="keyword">new</span> osg::Vec2Array();
            unifiedSkirtTexCoords-&gt;reserve( numVerticesInSkirt );        
            skirt-&gt;setTexCoordArray( 0, unifiedSkirtTexCoords );
        }

        <span class="keywordflow">if</span> (masks.size() &gt; 0)
        {
            unifiedStitchSkirtTexCoords = <span class="keyword">new</span> osg::Vec2Array();
            <span class="comment">//unifiedStitchSkirtTexCoords-&gt;reserve( ? );        </span>
            stitching_skirts-&gt;setTexCoordArray( 0, unifiedStitchSkirtTexCoords );
        }
    }

    <span class="keywordflow">else</span> <span class="comment">// if ( !_texCompositor-&gt;requiresUnitTextureSpace() )</span>
    {
        LocatorToTexCoordTable locatorToTexCoordTable;
        renderLayers.reserve( tilef.<a class="code" href="classTileFrame.html#a1f75e20b5596b6a14d27fe3938b37075">_colorLayers</a>.size() );

        <span class="comment">// build a list of &quot;render layers&quot;, in slot order, sharing texture coordinate</span>
        <span class="comment">// arrays wherever possible.</span>
        <span class="keywordflow">for</span>( ColorLayersByUID::const_iterator i = tilef.<a class="code" href="classTileFrame.html#a1f75e20b5596b6a14d27fe3938b37075">_colorLayers</a>.begin(); i != tilef.<a class="code" href="classTileFrame.html#a1f75e20b5596b6a14d27fe3938b37075">_colorLayers</a>.end(); ++i )
        {
            <span class="keyword">const</span> <a class="code" href="classCustomColorLayer.html">CustomColorLayer</a>&amp; colorLayer = i-&gt;second;
            RenderLayer r;
            r.<a class="code" href="classCustomColorLayer.html#afb7ee8aab7b0690196b38d62a698c2f3">_layer</a> = colorLayer;

            <span class="keyword">const</span> <a class="code" href="classosgEarth_1_1GeoLocator.html">GeoLocator</a>* locator = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="classosgEarth_1_1GeoLocator.html">GeoLocator</a>*<span class="keyword">&gt;</span>( r._layer.getLocator() );
            <span class="keywordflow">if</span> ( locator )
            {
                r._texCoords = locatorToTexCoordTable.find( locator );
                <span class="keywordflow">if</span> ( !r._texCoords.valid() )
                {
                    r._texCoords = <span class="keyword">new</span> osg::Vec2Array();
                    r._texCoords-&gt;reserve( numVerticesInSurface );
                    r._ownsTexCoords = <span class="keyword">true</span>;
                    locatorToTexCoordTable.push_back( <a class="code" href="namespaceanonymous__namespace_02SinglePassTerrainTechnique_8cpp_03.html#a14060758321b19c8d4096ddba61aeec5">LocatorTexCoordPair</a>(locator, r._texCoords.get()) );
                }

                r._skirtTexCoords = <span class="keyword">new</span> osg::Vec2Array();
                r._skirtTexCoords-&gt;reserve( numVerticesInSkirt );

                <span class="keywordflow">if</span> ( masks.size() &gt; 0 )
                {
                    r._stitchTexCoords = <span class="keyword">new</span> osg::Vec2Array();
                    r._stitchSkirtTexCoords = <span class="keyword">new</span> osg::Vec2Array();
                }

                r._locator = locator;
                <span class="keywordflow">if</span> ( locator-&gt;getCoordinateSystemType() == osgTerrain::Locator::GEOCENTRIC )
                {
                    <span class="keyword">const</span> <a class="code" href="classosgEarth_1_1GeoLocator.html">GeoLocator</a>* geo = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="classosgEarth_1_1GeoLocator.html">GeoLocator</a>*<span class="keyword">&gt;</span>(locator);
                    <span class="keywordflow">if</span> ( geo )
                        r._locator = geo-&gt;<a class="code" href="classosgEarth_1_1GeoLocator.html#a125f2bd702f4a911c65c6fe9334c640a">getGeographicFromGeocentric</a>();
                }

                <a class="code" href="classSinglePassTerrainTechnique.html#ac52309b549b7b332c14e81241ce25e3a">_texCompositor</a>-&gt;assignTexCoordArray( surface, colorLayer.<a class="code" href="classCustomColorLayer.html#af539b1957865fd51e5eb75ef7bd497ed">getUID</a>(), r._texCoords.get() );
                <a class="code" href="classSinglePassTerrainTechnique.html#ac52309b549b7b332c14e81241ce25e3a">_texCompositor</a>-&gt;assignTexCoordArray( skirt, colorLayer.<a class="code" href="classCustomColorLayer.html#af539b1957865fd51e5eb75ef7bd497ed">getUID</a>(), r._skirtTexCoords.get() );

                <span class="keywordflow">for</span> (MaskRecordVector::iterator mr = masks.begin(); mr != masks.end(); ++mr)
                    <a class="code" href="classSinglePassTerrainTechnique.html#ac52309b549b7b332c14e81241ce25e3a">_texCompositor</a>-&gt;assignTexCoordArray( (*mr)._geom, colorLayer.<a class="code" href="classCustomColorLayer.html#af539b1957865fd51e5eb75ef7bd497ed">getUID</a>(), r._stitchTexCoords.get() );

                <span class="keywordflow">if</span> (stitching_skirts)
                    <a class="code" href="classSinglePassTerrainTechnique.html#ac52309b549b7b332c14e81241ce25e3a">_texCompositor</a>-&gt;assignTexCoordArray( stitching_skirts, colorLayer.<a class="code" href="classCustomColorLayer.html#af539b1957865fd51e5eb75ef7bd497ed">getUID</a>(), r._stitchSkirtTexCoords.get() );

                <span class="comment">//surface-&gt;setTexCoordArray( renderLayers.size(), r._texCoords );</span>
                renderLayers.push_back( r );
            }
            <span class="keywordflow">else</span>
            {
                <a class="code" href="Notify.html#a13b79c6470fc74594070bd2098afc9de">OE_WARN</a> &lt;&lt; <a class="code" href="SinglePassTerrainTechnique_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;Found a Locator, but it wasn&#39;t a GeoLocator.&quot;</span> &lt;&lt; std::endl;
            }
        }
    }

    osg::ref_ptr&lt;osg::FloatArray&gt; elevations = <span class="keyword">new</span> osg::FloatArray;
    <span class="keywordflow">if</span> (elevations.valid()) elevations-&gt;reserve(numVerticesInSurface);        

    <span class="comment">// allocate and assign color</span>
    osg::ref_ptr&lt;osg::Vec4Array&gt; <a class="code" href="osgearth__tilesource_8cpp.html#a9e71186980a23d60f4d42454c5b968f3">colors</a> = <span class="keyword">new</span> osg::Vec4Array(1);
    (*colors)[0].set(1.0f,1.0f,1.0f,1.0f);
    
    surface-&gt;setColorArray(colors.get());
    surface-&gt;setColorBinding(osg::Geometry::BIND_OVERALL);

    <span class="keyword">typedef</span> std::vector&lt;int&gt; Indices;
    Indices indices(numVerticesInSurface, -1);    

    <span class="comment">// populate vertex and tex coord arrays    </span>
    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i, j; <span class="comment">//, k=0;</span>
    <span class="keywordflow">for</span>(j=0; j&lt;numRows; ++j)
    {
        <span class="keywordflow">for</span>(i=0; i&lt;numColumns; ++i) <span class="comment">// ++k)</span>
        {
            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iv = j*numColumns + i;
            osg::Vec3d ndc( ((<span class="keywordtype">double</span>)i)/(<span class="keywordtype">double</span>)(numColumns-1), ((<span class="keywordtype">double</span>)j)/(<span class="keywordtype">double</span>)(numRows-1), 0.0);
     
            <span class="keywordtype">bool</span> validValue = <span class="keyword">true</span>;
            
            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_equiv = i_sampleFactor==1.0 ? i : (<span class="keywordtype">unsigned</span> int) (<span class="keywordtype">double</span>(i)*i_sampleFactor);

            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j_equiv = j_sampleFactor==1.0 ? j : (<span class="keywordtype">unsigned</span> int) (<span class="keywordtype">double</span>(j)*j_sampleFactor);

            <span class="keywordflow">if</span> (elevationLayer)
            {
                <span class="keywordtype">float</span> value = 0.0f;
                validValue = elevationLayer-&gt;getValidValue(i_equiv,j_equiv, value);
                ndc.z() = value*scaleHeight;
            }

            <span class="comment">//Invalidate if point falls within mask bounding box</span>
            <span class="keywordflow">if</span> (validValue &amp;&amp; masks.size() &gt; 0)
            {
              <span class="keywordflow">for</span> (MaskRecordVector::iterator mr = masks.begin(); mr != masks.end(); ++mr)
              {
                <span class="keywordflow">if</span>(ndc.x() &gt;= (*mr)._ndcMin.x() &amp;&amp; ndc.x() &lt;= (*mr)._ndcMax.x() &amp;&amp;
                   ndc.y() &gt;= (*mr)._ndcMin.y() &amp;&amp; ndc.y() &lt;= (*mr)._ndcMax.y())
                {
                  validValue = <span class="keyword">false</span>;
                  indices[iv] = -2;
                  <span class="keywordflow">break</span>;
                }
              }
            }
            
            <span class="keywordflow">if</span> (validValue)
            {
                <span class="comment">//indices[iv] = k;</span>
                indices[iv] = surfaceVerts-&gt;size();
            
                osg::Vec3d model;
                <a class="code" href="classSinglePassTerrainTechnique.html#a91405d8a9044d1c224d46f4b6017dfad">_masterLocator</a>-&gt;convertLocalToModel(ndc, model);

                <span class="comment">//(*surfaceVerts)[k] = model - centerModel;</span>
                (*surfaceVerts).push_back(model - <a class="code" href="classSinglePassTerrainTechnique.html#a31e8cf34154ced3efa730fd531cf6e14">_centerModel</a>);

                <span class="keywordflow">if</span> ( <a class="code" href="classSinglePassTerrainTechnique.html#ac52309b549b7b332c14e81241ce25e3a">_texCompositor</a>-&gt;requiresUnitTextureSpace() )
                {
                    <span class="comment">// the unified unit texture space requires a single, untransformed unit coord [0..1]</span>
                    (*unifiedSurfaceTexCoords).push_back( osg::Vec2( ndc.x(), ndc.y() ) );
                }
                <span class="keywordflow">else</span>
                {
                    <span class="comment">// the separate texture space requires separate transformed texcoords for each layer.</span>
                    <span class="keywordflow">for</span>( RenderLayerVector::const_iterator r = renderLayers.begin(); r != renderLayers.end(); ++r )
                    {
                        <span class="keywordflow">if</span> ( r-&gt;_ownsTexCoords )
                        {
                            <span class="comment">//if ( r-&gt;_locator.get() != _masterLocator.get() )</span>
                            <span class="comment">//if ( r-&gt;_locator-&gt;isEr-&gt;_locator != masterTextureLocator _masterLocator.get() )</span>
                            <span class="keywordflow">if</span> ( !r-&gt;_locator-&gt;isEquivalentTo( *masterTextureLocator.get() ) )
                            {
                                osg::Vec3d color_ndc;
                                osgTerrain::Locator::convertLocalCoordBetween( *masterTextureLocator.get(), ndc, *r-&gt;_locator.get(), color_ndc );
                                r-&gt;_texCoords-&gt;push_back( osg::Vec2( color_ndc.x(), color_ndc.y() ) );
                            }
                            <span class="keywordflow">else</span>
                            {
                                r-&gt;_texCoords-&gt;push_back( osg::Vec2( ndc.x(), ndc.y() ) );
                            }
                        }
                    }
                }

                <span class="keywordflow">if</span> (elevations.valid())
                {
                    (*elevations).push_back(ndc.z());
                }

                <span class="comment">// compute the local normal</span>
                osg::Vec3d ndc_one = ndc; ndc_one.z() += 1.0;
                osg::Vec3d model_one;
                <a class="code" href="classSinglePassTerrainTechnique.html#a91405d8a9044d1c224d46f4b6017dfad">_masterLocator</a>-&gt;convertLocalToModel(ndc_one, model_one);
                model_one = model_one - model;
                model_one.normalize();    

                <span class="comment">//(*normals)[k] = model_one;</span>
                (*normals).push_back(model_one);
            }
        }
    }


    <span class="keywordflow">for</span> (MaskRecordVector::iterator mr = masks.begin(); mr != masks.end(); ++mr)
    {
      <span class="keywordtype">int</span> min_i = (int)floor((*mr)._ndcMin.x() * (double)(numColumns-1));
      <span class="keywordflow">if</span> (min_i &lt; 0) min_i = 0;
      <span class="keywordflow">if</span> (min_i &gt;= numColumns) min_i = numColumns - 1;

      <span class="keywordtype">int</span> min_j = (int)floor((*mr)._ndcMin.y() * (double)(numRows-1));
      <span class="keywordflow">if</span> (min_j &lt; 0) min_j = 0;
      <span class="keywordflow">if</span> (min_j &gt;= numColumns) min_j = numColumns - 1;

      <span class="keywordtype">int</span> max_i = (int)ceil((*mr)._ndcMax.x() * (double)(numColumns-1));
      <span class="keywordflow">if</span> (max_i &lt; 0) max_i = 0;
      <span class="keywordflow">if</span> (max_i &gt;= numColumns) max_i = numColumns - 1;

      <span class="keywordtype">int</span> max_j = (int)ceil((*mr)._ndcMax.y() * (double)(numRows-1));
      <span class="keywordflow">if</span> (max_j &lt; 0) max_j = 0;
      <span class="keywordflow">if</span> (max_j &gt;= numColumns) max_j = numColumns - 1;

      <span class="keywordflow">if</span> (min_i &gt;= 0 &amp;&amp; max_i &gt;= 0 &amp;&amp; min_j &gt;= 0 &amp;&amp; max_j &gt;= 0)
      {
        <span class="keywordtype">int</span> num_i = max_i - min_i + 1;
        <span class="keywordtype">int</span> num_j = max_j - min_j + 1;

        osg::ref_ptr&lt;osgEarth::Symbology::Polygon&gt; maskSkirtPoly = <span class="keyword">new</span> <a class="code" href="classosgEarth_1_1Symbology_1_1Polygon.html">osgEarth::Symbology::Polygon</a>();
        maskSkirtPoly-&gt;resize(num_i * 2 + num_j * 2 - 4);
        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_i; i++)
        {
          <span class="comment">//int index = indices[min_j*numColumns + i + min_i];</span>
          {
            osg::Vec3d ndc( ((<span class="keywordtype">double</span>)(i + min_i))/(<span class="keywordtype">double</span>)(numColumns-1), ((<span class="keywordtype">double</span>)min_j)/(<span class="keywordtype">double</span>)(numRows-1), 0.0);

            <span class="keywordflow">if</span> (elevationLayer)
            {
              <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_equiv = i_sampleFactor==1.0 ? i + min_i : (<span class="keywordtype">unsigned</span> int) (<span class="keywordtype">double</span>(i + min_i)*i_sampleFactor);
              <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j_equiv = j_sampleFactor==1.0 ? min_j : (<span class="keywordtype">unsigned</span> int) (<span class="keywordtype">double</span>(min_j)*j_sampleFactor);

              <span class="keywordtype">float</span> value = 0.0f;
              <span class="keywordflow">if</span> (elevationLayer-&gt;getValidValue(i_equiv,j_equiv, value))
                ndc.z() = value*scaleHeight;
            }

            (*maskSkirtPoly)[i] = ndc;
          }

          <span class="comment">//index = indices[max_j*numColumns + i + min_i];</span>
          {
            osg::Vec3d ndc( ((<span class="keywordtype">double</span>)(i + min_i))/(<span class="keywordtype">double</span>)(numColumns-1), ((<span class="keywordtype">double</span>)max_j)/(<span class="keywordtype">double</span>)(numRows-1), 0.0);

            <span class="keywordflow">if</span> (elevationLayer)
            {
              <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_equiv = i_sampleFactor==1.0 ? i + min_i : (<span class="keywordtype">unsigned</span> int) (<span class="keywordtype">double</span>(i + min_i)*i_sampleFactor);
              <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j_equiv = j_sampleFactor==1.0 ? max_j : (<span class="keywordtype">unsigned</span> int) (<span class="keywordtype">double</span>(max_j)*j_sampleFactor);

              <span class="keywordtype">float</span> value = 0.0f;
              <span class="keywordflow">if</span> (elevationLayer-&gt;getValidValue(i_equiv,j_equiv, value))
                ndc.z() = value*scaleHeight;
            }

            (*maskSkirtPoly)[i + (2 * num_i + num_j - 3) - 2 * i] = ndc;
          }
        }
        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; num_j - 2; j++)
        {
          <span class="comment">//int index = indices[(min_j + j + 1)*numColumns + max_i];</span>
          {
            osg::Vec3d ndc( ((<span class="keywordtype">double</span>)max_i)/(<span class="keywordtype">double</span>)(numColumns-1), ((<span class="keywordtype">double</span>)(min_j + j + 1))/(<span class="keywordtype">double</span>)(numRows-1), 0.0);

            <span class="keywordflow">if</span> (elevationLayer)
            {
              <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_equiv = i_sampleFactor==1.0 ? max_i : (<span class="keywordtype">unsigned</span> int) (<span class="keywordtype">double</span>(max_i)*i_sampleFactor);
              <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j_equiv = j_sampleFactor==1.0 ? min_j + j + 1 : (<span class="keywordtype">unsigned</span> int) (<span class="keywordtype">double</span>(min_j + j + 1)*j_sampleFactor);

              <span class="keywordtype">float</span> value = 0.0f;
              <span class="keywordflow">if</span> (elevationLayer-&gt;getValidValue(i_equiv,j_equiv, value))
                ndc.z() = value*scaleHeight;
            }

            (*maskSkirtPoly)[j + num_i] = ndc;
          }

          <span class="comment">//index = indices[(min_j + j + 1)*numColumns + min_i];</span>
          {
            osg::Vec3d ndc( ((<span class="keywordtype">double</span>)min_i)/(<span class="keywordtype">double</span>)(numColumns-1), ((<span class="keywordtype">double</span>)(min_j + j + 1))/(<span class="keywordtype">double</span>)(numRows-1), 0.0);

            <span class="keywordflow">if</span> (elevationLayer)
            {
              <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_equiv = i_sampleFactor==1.0 ? min_i : (<span class="keywordtype">unsigned</span> int) (<span class="keywordtype">double</span>(min_i)*i_sampleFactor);
              <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j_equiv = j_sampleFactor==1.0 ? min_j + j + 1 : (<span class="keywordtype">unsigned</span> int) (<span class="keywordtype">double</span>(min_j + j + 1)*j_sampleFactor);

              <span class="keywordtype">float</span> value = 0.0f;
              <span class="keywordflow">if</span> (elevationLayer-&gt;getValidValue(i_equiv,j_equiv, value))
                ndc.z() = value*scaleHeight;
            }

            (*maskSkirtPoly)[j + (2 * num_i + 2 * num_j - 5) - 2 * j] = ndc;
          }
        }

        <span class="comment">//Create local polygon representing mask</span>
        osg::ref_ptr&lt;osgEarth::Symbology::Polygon&gt; maskPoly = <span class="keyword">new</span> <a class="code" href="classosgEarth_1_1Symbology_1_1Polygon.html">osgEarth::Symbology::Polygon</a>();
        <span class="keywordflow">for</span> (osg::Vec3dArray::iterator it = (*mr)._boundary-&gt;begin(); it != (*mr)._boundary-&gt;end(); ++it)
        {
          osg::Vec3d local;
          geoLocator-&gt;convertModelToLocal(*it, local);
          maskPoly-&gt;push_back(local);
        }


<span class="comment">//Change the following two #if statements to see mask skirt polygons</span>
<span class="comment">//before clipping and adjusting</span>
<span class="preprocessor">#if 1</span>
<span class="preprocessor"></span>        <span class="comment">//Do a diff on the polygons to get the actual mask skirt</span>
        osg::ref_ptr&lt;osgEarth::Symbology::Geometry&gt; outPoly;
        maskSkirtPoly-&gt;difference(maskPoly.get(), outPoly);
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>        osg::ref_ptr&lt;osgEarth::Symbology::Geometry&gt; outPoly = maskSkirtPoly;
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
        osg::Vec3Array* outVerts = <span class="keyword">new</span> osg::Vec3Array();

        osg::Geometry* stitch_geom = (*mr)._geom;
        stitch_geom-&gt;setVertexArray(outVerts);

        <span class="keywordtype">bool</span> multiParent = <span class="keyword">false</span>;
        <span class="keywordflow">if</span> (outPoly.valid())
          multiParent = outPoly-&gt;getType() == <a class="code" href="classosgEarth_1_1Symbology_1_1Geometry.html#a6d54f55f7817f9aa25aee616dd82c1e0ab57d0405c07256b925daf8b3f8bcae56">osgEarth::Symbology::Geometry::TYPE_MULTI</a>;
        
        std::vector&lt;int&gt; skirtIndices;

        <a class="code" href="classosgEarth_1_1Symbology_1_1GeometryIterator.html">osgEarth::Symbology::GeometryIterator</a> i( outPoly.get(), false );
        <span class="keywordflow">while</span>( i.hasMore() )
        {
          <a class="code" href="classosgEarth_1_1Symbology_1_1Geometry.html">osgEarth::Symbology::Geometry</a>* part = i.next();
          <span class="keywordflow">if</span> (!part)
            <span class="keywordflow">continue</span>;

          <span class="keywordflow">if</span> (part-&gt;<a class="code" href="classosgEarth_1_1Symbology_1_1Geometry.html#a12044f75418af11e87a616a78967e5b1">getType</a>() == <a class="code" href="classosgEarth_1_1Symbology_1_1Geometry.html#a6d54f55f7817f9aa25aee616dd82c1e0a6ad154c227e2b3ab0480e2713bbb97b2">osgEarth::Symbology::Geometry::TYPE_POLYGON</a>)
          {
            osg::Vec3Array* partVerts = part-&gt;<a class="code" href="classosgEarth_1_1Symbology_1_1Geometry.html#ab226e51c4de9dac844f6ed63fded1129">toVec3Array</a>();
            outVerts-&gt;insert(outVerts-&gt;end(), partVerts-&gt;begin(), partVerts-&gt;end());
            stitch_geom-&gt;addPrimitiveSet(<span class="keyword">new</span> osg::DrawArrays(osg::PrimitiveSet::POLYGON, outVerts-&gt;size() - partVerts-&gt;size(), partVerts-&gt;size()));
            skirtIndices.push_back(outVerts-&gt;size());

            <span class="keywordflow">if</span> (!multiParent)
            {
              osg::ref_ptr&lt;osgEarth::Symbology::Polygon&gt; holePoly = <span class="keyword">static_cast&lt;</span><a class="code" href="classosgEarth_1_1Symbology_1_1Polygon.html">osgEarth::Symbology::Polygon</a>*<span class="keyword">&gt;</span>(outPoly.get());
              <span class="keywordflow">if</span> (holePoly)
              {
                <a class="code" href="namespaceosgEarth_1_1Symbology.html#a46682d9da16fa8f901a2d70e5f3946c4">osgEarth::Symbology::RingCollection</a> holes = holePoly-&gt;<a class="code" href="classosgEarth_1_1Symbology_1_1Polygon.html#aef6967b31b28c8a5119269aaed5ad429">getHoles</a>();
                
                <span class="keywordflow">for</span> (osgEarth::Symbology::RingCollection::iterator hit = holes.begin(); hit != holes.end(); ++hit)
                {
                  (*hit)-&gt;rewind(<a class="code" href="classosgEarth_1_1Symbology_1_1Ring.html#a9dd4dbd937642f5a56370e2b6d2e0fada284992ae207473432549ee12ec909c5e">osgEarth::Symbology::Ring::ORIENTATION_CCW</a>);
                  outVerts-&gt;insert(outVerts-&gt;end(), (*hit)-&gt;begin(), (*hit)-&gt;end());
                  stitch_geom-&gt;addPrimitiveSet(<span class="keyword">new</span> osg::DrawArrays(osg::PrimitiveSet::POLYGON, outVerts-&gt;size() - (*hit)-&gt;size(), (*hit)-&gt;size()));
                  skirtIndices.push_back(outVerts-&gt;size());
                }
              }
            }
          }
        }

        <span class="keywordflow">if</span> (stitch_geom-&gt;getNumPrimitiveSets() &gt; 0)
        {
<span class="preprocessor">#if 1</span>
<span class="preprocessor"></span>          <span class="comment">// Tessellate mask skirt</span>
          osg::ref_ptr&lt;osgUtil::Tessellator&gt; tscx=<span class="keyword">new</span> osgUtil::Tessellator;
          tscx-&gt;setTessellationType(osgUtil::Tessellator::TESS_TYPE_GEOMETRY);
          tscx-&gt;setBoundaryOnly(<span class="keyword">false</span>);
          tscx-&gt;setWindingType(osgUtil::Tessellator::TESS_WINDING_ODD);
          tscx-&gt;retessellatePolygons(*stitch_geom);

          <span class="comment">// Assign normals to the stitching polygon: -gw</span>
          osg::Vec3Array* sgVerts = <span class="keyword">dynamic_cast&lt;</span>osg::Vec3Array*<span class="keyword">&gt;</span>(stitch_geom-&gt;getVertexArray());
          osg::Vec3Array* sgNormals = <span class="keyword">new</span> osg::Vec3Array(sgVerts-&gt;size());
          stitch_geom-&gt;setNormalArray( sgNormals );
          stitch_geom-&gt;setNormalBinding( osg::Geometry::BIND_PER_VERTEX );
          
          <span class="comment">// calculate the normal and convert to model space.</span>
          <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> v=0; v&lt;sgVerts-&gt;size(); ++v )
          {
              <span class="keyword">const</span> osg::Vec3&amp; vert = (*sgVerts)[v];
              osg::Vec3d local_one(vert);
              osg::Vec3d model;
              <a class="code" href="classSinglePassTerrainTechnique.html#a91405d8a9044d1c224d46f4b6017dfad">_masterLocator</a>-&gt;convertLocalToModel( local_one, model );
              local_one.z() += 1.0;
              osg::Vec3d model_one;
              <a class="code" href="classSinglePassTerrainTechnique.html#a91405d8a9044d1c224d46f4b6017dfad">_masterLocator</a>-&gt;convertLocalToModel( local_one, model_one );
              model_one = model_one - model;
              model_one.normalize();
              (*sgNormals)[v] = model_one;
          }

          <span class="comment">//Initialize tex coords</span>
          osg::Vec2Array* unifiedStitchTexCoords = 0L;
          <span class="keywordflow">if</span> (<a class="code" href="classSinglePassTerrainTechnique.html#ac52309b549b7b332c14e81241ce25e3a">_texCompositor</a>-&gt;requiresUnitTextureSpace())
          {
            unifiedStitchTexCoords = <span class="keyword">new</span> osg::Vec2Array();
            unifiedStitchTexCoords-&gt;reserve(outVerts-&gt;size());
            stitch_geom-&gt;setTexCoordArray(0, unifiedStitchTexCoords);
          }
          <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( renderLayers.size() &gt; 0 )
          {
            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; renderLayers.size(); ++i)
            {
              renderLayers[i]._stitchTexCoords-&gt;reserve(outVerts-&gt;size());
            }
          }


          <span class="comment">//Retrieve z values for mask skirt verts</span>
          std::vector&lt;int&gt; isZSet;
          <span class="keywordflow">for</span> (osg::Vec3Array::iterator it = outVerts-&gt;begin(); it != outVerts-&gt;end(); ++it)
          {
            <span class="keywordtype">int</span> zSet = 0;

            <span class="comment">//Look for verts that belong to the original mask skirt polygon</span>
            <span class="keywordflow">for</span> (<a class="code" href="classosgEarth_1_1MixinVector.html#a292f1e571e5b24a927fbffa25ae7b9f0">osgEarth::Symbology::Polygon::iterator</a> mit = maskSkirtPoly-&gt;begin(); mit != maskSkirtPoly-&gt;end(); ++mit)
            {
              <span class="keywordflow">if</span> (osg::absolute((*mit).x() - (*it).x()) &lt; <a class="code" href="SinglePassTerrainTechnique_8cpp.html#a7c4706a3fe0c40ded0456294496bd773">MATCH_TOLERANCE</a> &amp;&amp; osg::absolute((*mit).y() - (*it).y()) &lt; <a class="code" href="SinglePassTerrainTechnique_8cpp.html#a7c4706a3fe0c40ded0456294496bd773">MATCH_TOLERANCE</a>)
              {
                (*it).z() = (*mit).z();
                zSet += 1;
                <span class="keywordflow">break</span>;
              }
            }

            <span class="comment">//Look for verts that belong to the mask polygon</span>
            <span class="keywordflow">for</span> (<a class="code" href="classosgEarth_1_1MixinVector.html#a292f1e571e5b24a927fbffa25ae7b9f0">osgEarth::Symbology::Polygon::iterator</a> mit = maskPoly-&gt;begin(); mit != maskPoly-&gt;end(); ++mit)
            {
              <span class="keywordflow">if</span> (osg::absolute((*mit).x() - (*it).x()) &lt; <a class="code" href="SinglePassTerrainTechnique_8cpp.html#a7c4706a3fe0c40ded0456294496bd773">MATCH_TOLERANCE</a> &amp;&amp; osg::absolute((*mit).y() - (*it).y()) &lt; <a class="code" href="SinglePassTerrainTechnique_8cpp.html#a7c4706a3fe0c40ded0456294496bd773">MATCH_TOLERANCE</a>)
              {
                (*it).z() = (*mit).z();
                zSet += 2;
                <span class="keywordflow">break</span>;
              }
            }

            isZSet.push_back(zSet);
          }

          <span class="comment">//Any mask skirt verts that are still unset are newly created verts where the skirt</span>
          <span class="comment">//meets the mask. Find the mask segment the point lies along and calculate the</span>
          <span class="comment">//appropriate z value for the point.</span>
          <span class="comment">//</span>
          <span class="comment">//Now that all the z values are set, convert each vert into model coords.</span>
          <span class="comment">//</span>
          <span class="comment">//Also, while we are iterating through the verts, set up tex coords.</span>
          <span class="keywordtype">int</span> count = 0;
          <span class="keywordflow">for</span> (osg::Vec3Array::iterator it = outVerts-&gt;begin(); it != outVerts-&gt;end(); ++it)
          {
            <span class="comment">//If the z-value was set from a mask vertex there is no need to change it.  If</span>
            <span class="comment">//it was set from a vertex from the stitching polygon it may need overriden if</span>
            <span class="comment">//the vertex lies along a mask edge.  Or if it is unset, it will need to be set.</span>
            <span class="keywordflow">if</span> (isZSet[count] &lt; 2)
            {
              osg::Vec3d p2 = *it;
              <span class="keywordtype">double</span> closestZ = 0.0;
              <span class="keywordtype">double</span> closestRatio = DBL_MAX;
              <span class="keywordflow">for</span> (<a class="code" href="classosgEarth_1_1MixinVector.html#a292f1e571e5b24a927fbffa25ae7b9f0">osgEarth::Symbology::Polygon::iterator</a> mit = maskPoly-&gt;begin(); mit != maskPoly-&gt;end(); ++mit)
              {
                osg::Vec3d p1 = *mit;
                osg::Vec3d p3 = mit == --maskPoly-&gt;end() ? maskPoly-&gt;front() : (*(mit + 1));

                <span class="comment">//Truncated vales to compensate for accuracy issues</span>
                <span class="keywordtype">double</span> p1x = ((int)(p1.x() * 1000000)) / 1000000.0L;
                <span class="keywordtype">double</span> p3x = ((int)(p3.x() * 1000000)) / 1000000.0L;
                <span class="keywordtype">double</span> p2x = ((int)(p2.x() * 1000000)) / 1000000.0L;

                <span class="keywordtype">double</span> p1y = ((int)(p1.y() * 1000000)) / 1000000.0L;
                <span class="keywordtype">double</span> p3y = ((int)(p3.y() * 1000000)) / 1000000.0L;
                <span class="keywordtype">double</span> p2y = ((int)(p2.y() * 1000000)) / 1000000.0L;

                <span class="keywordflow">if</span> ((p1x &lt; p3x ? p2x &gt;= p1x &amp;&amp; p2x &lt;= p3x : p2x &gt;= p3x &amp;&amp; p2x &lt;= p1x) &amp;&amp;
                    (p1y &lt; p3y ? p2y &gt;= p1y &amp;&amp; p2y &lt;= p3y : p2y &gt;= p3y &amp;&amp; p2y &lt;= p1y))
                {
                  <span class="keywordtype">double</span> l1 =(osg::Vec2d(p2.x(), p2.y()) - osg::Vec2d(p1.x(), p1.y())).length();
                  <span class="keywordtype">double</span> lt = (osg::Vec2d(p3.x(), p3.y()) - osg::Vec2d(p1.x(), p1.y())).length();
                  <span class="keywordtype">double</span> zmag = p3.z() - p1.z();

                  <span class="keywordtype">double</span> foundZ = (l1 / lt) * zmag + p1.z();

                  <span class="keywordtype">double</span> mRatio = 1.0;
                  <span class="keywordflow">if</span> (osg::absolute(p1x - p3x) &lt; <a class="code" href="SinglePassTerrainTechnique_8cpp.html#a7c4706a3fe0c40ded0456294496bd773">MATCH_TOLERANCE</a>)
                  {
                    <span class="keywordflow">if</span> (osg::absolute(p1x-p2x) &lt; <a class="code" href="SinglePassTerrainTechnique_8cpp.html#a7c4706a3fe0c40ded0456294496bd773">MATCH_TOLERANCE</a>)
                      mRatio = 0.0;
                  }
                  <span class="keywordflow">else</span>
                  {
                    <span class="keywordtype">double</span> m1 = p1x == p2x ? 0.0 : (p2y - p1y) / (p2x - p1x);
                    <span class="keywordtype">double</span> m2 = p1x == p3x ? 0.0 : (p3y - p1y) / (p3x - p1x);
                    mRatio = m2 == 0.0 ? m1 : osg::absolute(1.0L - m1 / m2);
                  }

                  <span class="keywordflow">if</span> (mRatio &lt; 0.01)
                  {
                    (*it).z() = foundZ;
                    isZSet[count] = 2;
                    <span class="keywordflow">break</span>;
                  }
                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mRatio &lt; closestRatio)
                  {
                    closestRatio = mRatio;
                    closestZ = foundZ;
                  }
                }
              }

              <span class="keywordflow">if</span> (!isZSet[count] &amp;&amp; closestRatio &lt; DBL_MAX)
              {
                (*it).z() = closestZ;
                isZSet[count] = 2;
              }
            }

            <span class="keywordflow">if</span> (!isZSet[count])
              <a class="code" href="Notify.html#a13b79c6470fc74594070bd2098afc9de">OE_WARN</a> &lt;&lt; <a class="code" href="SinglePassTerrainTechnique_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;Z-value not set for stitching polygon vertex&quot;</span> &lt;&lt; std::endl;

            count++;

            <span class="comment">//Convert to model coords</span>
            osg::Vec3d model;
            <a class="code" href="classSinglePassTerrainTechnique.html#a91405d8a9044d1c224d46f4b6017dfad">_masterLocator</a>-&gt;convertLocalToModel(*it, model);
            model = model - <a class="code" href="classSinglePassTerrainTechnique.html#a31e8cf34154ced3efa730fd531cf6e14">_centerModel</a>;
            (*it).set(model.x(), model.y(), model.z());

            <span class="comment">//Setup tex coords</span>
            osg::Vec3d ndc;
            <a class="code" href="classSinglePassTerrainTechnique.html#a91405d8a9044d1c224d46f4b6017dfad">_masterLocator</a>-&gt;convertModelToLocal(*it + _centerModel, ndc);

            <span class="keywordflow">if</span> (<a class="code" href="classSinglePassTerrainTechnique.html#ac52309b549b7b332c14e81241ce25e3a">_texCompositor</a>-&gt;requiresUnitTextureSpace())
            {
              unifiedStitchTexCoords-&gt;push_back(osg::Vec2(ndc.x(), ndc.y()));
            }
            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (renderLayers.size() &gt; 0)
            {
              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; renderLayers.size(); ++i)
              {
                <span class="keywordflow">if</span> (!renderLayers[i]._locator-&gt;isEquivalentTo(*masterTextureLocator.get()))
                {
                  osg::Vec3d color_ndc;
                  osgTerrain::Locator::convertLocalCoordBetween(*masterTextureLocator.get(), ndc, *renderLayers[i]._locator.get(), color_ndc);
                  renderLayers[i]._stitchTexCoords-&gt;push_back(osg::Vec2(color_ndc.x(), color_ndc.y()));
                }
                <span class="keywordflow">else</span>
                {
                  renderLayers[i]._stitchTexCoords-&gt;push_back(osg::Vec2(ndc.x(), ndc.y()));
                }
              }
            }
          }
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>          <span class="keywordflow">for</span> (osg::Vec3Array::iterator it = outVerts-&gt;begin(); it != outVerts-&gt;end(); ++it)
          {
            <span class="comment">//Convert to model coords</span>
            osg::Vec3d model;
            <a class="code" href="classSinglePassTerrainTechnique.html#a91405d8a9044d1c224d46f4b6017dfad">_masterLocator</a>-&gt;convertLocalToModel(*it, model);
            model = model - <a class="code" href="classSinglePassTerrainTechnique.html#a31e8cf34154ced3efa730fd531cf6e14">_centerModel</a>;
            (*it).set(model.x(), model.y(), model.z());
          }
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>      
          <span class="comment">//Create stitching skirts</span>
          <span class="keywordflow">if</span> (createSkirt &amp;&amp; skirtIndices.size() &gt; 0)
          {
            ss_verts-&gt;reserve(ss_verts-&gt;size() + outVerts-&gt;size() * 4 + skirtIndices.size() * 2);

            <span class="comment">//Add a primative set for each continuous skirt strip</span>
            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p=0; p &lt; skirtIndices.size(); p++)
            {
              <span class="keywordtype">int</span> cursor = ss_verts-&gt;size();

              <span class="keywordtype">int</span> outStart = p == 0 ? 0 : skirtIndices[p-1];
              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=outStart; i &lt; skirtIndices[p]; i++)
              {
                ss_verts-&gt;push_back((*outVerts)[i]);
                ss_verts-&gt;push_back((*outVerts)[i] - (*sgNormals)[i] * skirtHeight);

                <span class="keywordflow">if</span> ( <a class="code" href="classSinglePassTerrainTechnique.html#ac52309b549b7b332c14e81241ce25e3a">_texCompositor</a>-&gt;requiresUnitTextureSpace() )
                {
                    unifiedStitchSkirtTexCoords-&gt;push_back( (*unifiedStitchTexCoords)[i] );
                    unifiedStitchSkirtTexCoords-&gt;push_back( (*unifiedStitchTexCoords)[i] );
                }
                <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( renderLayers.size() &gt; 0 )
                {
                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> r = 0; r &lt; renderLayers.size(); ++r)
                    {
                        <span class="keyword">const</span> osg::Vec2&amp; tc = (*renderLayers[r]._stitchTexCoords.get())[i];
                        renderLayers[r]._stitchSkirtTexCoords-&gt;push_back( tc );
                        renderLayers[r]._stitchSkirtTexCoords-&gt;push_back( tc );
                    }
                }
              }

              <span class="comment">//Add the first vert again to complete the loop</span>
              ss_verts-&gt;push_back((*outVerts)[outStart]);
              ss_verts-&gt;push_back((*outVerts)[outStart] - (*sgNormals)[outStart] * skirtHeight);

              <span class="keywordflow">if</span> ( <a class="code" href="classSinglePassTerrainTechnique.html#ac52309b549b7b332c14e81241ce25e3a">_texCompositor</a>-&gt;requiresUnitTextureSpace() )
              {
                  unifiedStitchSkirtTexCoords-&gt;push_back( (*unifiedStitchTexCoords)[outStart] );
                  unifiedStitchSkirtTexCoords-&gt;push_back( (*unifiedStitchTexCoords)[outStart] );
              }
              <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( renderLayers.size() &gt; 0 )
              {
                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> r = 0; r &lt; renderLayers.size(); ++r)
                  {
                      <span class="keyword">const</span> osg::Vec2&amp; tc = (*renderLayers[r]._stitchTexCoords.get())[outStart];
                      renderLayers[r]._stitchSkirtTexCoords-&gt;push_back( tc );
                      renderLayers[r]._stitchSkirtTexCoords-&gt;push_back( tc );
                  }
              }

              <span class="comment">//Now go back the opposite direction to create a skirt facing the other direction</span>
              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=skirtIndices[p] - 1; i &gt;= outStart; i--)
              {
                ss_verts-&gt;push_back((*outVerts)[i]);
                ss_verts-&gt;push_back((*outVerts)[i] - (*sgNormals)[i] * skirtHeight);

                <span class="keywordflow">if</span> ( <a class="code" href="classSinglePassTerrainTechnique.html#ac52309b549b7b332c14e81241ce25e3a">_texCompositor</a>-&gt;requiresUnitTextureSpace() )
                {
                    unifiedStitchSkirtTexCoords-&gt;push_back( (*unifiedStitchTexCoords)[i] );
                    unifiedStitchSkirtTexCoords-&gt;push_back( (*unifiedStitchTexCoords)[i] );
                }
                <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( renderLayers.size() &gt; 0 )
                {
                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> r = 0; r &lt; renderLayers.size(); ++r)
                    {
                        <span class="keyword">const</span> osg::Vec2&amp; tc = (*renderLayers[r]._stitchTexCoords.get())[i];
                        renderLayers[r]._stitchSkirtTexCoords-&gt;push_back( tc );
                        renderLayers[r]._stitchSkirtTexCoords-&gt;push_back( tc );
                    }
                }
              }

              stitching_skirts-&gt;addPrimitiveSet(<span class="keyword">new</span> osg::DrawArrays( GL_TRIANGLE_STRIP, cursor, ss_verts-&gt;size() - cursor));
            }
          }
        }
      }
    }

    <span class="comment">// populate primitive sets</span>
    <span class="keywordtype">bool</span> swapOrientation = !(<a class="code" href="classSinglePassTerrainTechnique.html#a91405d8a9044d1c224d46f4b6017dfad">_masterLocator</a>-&gt;orientationOpenGL());

    osg::ref_ptr&lt;osg::DrawElementsUInt&gt; elements = <span class="keyword">new</span> osg::DrawElementsUInt(GL_TRIANGLES);
    elements-&gt;reserve((numRows-1) * (numColumns-1) * 6);

    surface-&gt;addPrimitiveSet(elements.get());
    
    osg::ref_ptr&lt;osg::Vec3Array&gt; skirtVectors = <span class="keyword">new</span> osg::Vec3Array( *normals );

          <span class="keywordflow">if</span> (!normals)
        createSkirt = <span class="keyword">false</span>;
    
    <span class="comment">// New separated skirts.</span>
    <span class="keywordflow">if</span> ( createSkirt )
    {        
        <span class="comment">// build the verts first:</span>
        osg::Vec3Array* skirtVerts = <span class="keyword">new</span> osg::Vec3Array();
        osg::Vec3Array* skirtNormals = <span class="keyword">new</span> osg::Vec3Array();

        skirtVerts-&gt;reserve( numVerticesInSkirt );
        skirtNormals-&gt;reserve( numVerticesInSkirt );
        
        Indices skirtBreaks;
        skirtBreaks.push_back(0);

        <span class="comment">// bottom:</span>
        <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> c=0; c&lt;numColumns-1; ++c )
        {
            <span class="keywordtype">int</span> orig_i = indices[c];

            <span class="comment">//int offset = 0;</span>
            <span class="comment">//while (orig_i &lt; 0 &amp;&amp; offset &lt; numRows - 1)</span>
            <span class="comment">//  orig_i = indices[c + ++offset * numColumns];</span>

            <span class="keywordflow">if</span> (orig_i &lt; 0)
            {
              <span class="keywordflow">if</span> (skirtBreaks.back() != skirtVerts-&gt;size())
                skirtBreaks.push_back(skirtVerts-&gt;size());
            }
            <span class="keywordflow">else</span>
            {
              skirtVerts-&gt;push_back( (*surfaceVerts)[orig_i] );
              skirtVerts-&gt;push_back( (*surfaceVerts)[orig_i] - ((*skirtVectors)[orig_i])*skirtHeight );
              skirtNormals-&gt;push_back( (*normals)[orig_i] );             
              skirtNormals-&gt;push_back( (*normals)[orig_i] );             


              <span class="keywordflow">if</span> ( <a class="code" href="classSinglePassTerrainTechnique.html#ac52309b549b7b332c14e81241ce25e3a">_texCompositor</a>-&gt;requiresUnitTextureSpace() )
              {
                  unifiedSkirtTexCoords-&gt;push_back( (*unifiedSurfaceTexCoords)[orig_i] );
                  unifiedSkirtTexCoords-&gt;push_back( (*unifiedSurfaceTexCoords)[orig_i] );
              }
              <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( renderLayers.size() &gt; 0 )
              {
                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; renderLayers.size(); ++i)
                  {
                      <span class="keyword">const</span> osg::Vec2&amp; tc = (*renderLayers[i]._texCoords.get())[orig_i];
                      renderLayers[i]._skirtTexCoords-&gt;push_back( tc );
                      renderLayers[i]._skirtTexCoords-&gt;push_back( tc );
                  }
              }
            }
        }

        <span class="comment">// right:</span>
        <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> r=0; r&lt;numRows-1; ++r )
        {
            <span class="keywordtype">int</span> orig_i = indices[r*numColumns+(numColumns-1)];
            <span class="keywordflow">if</span> (orig_i &lt; 0)
            {
              <span class="keywordflow">if</span> (skirtBreaks.back() != skirtVerts-&gt;size())
                skirtBreaks.push_back(skirtVerts-&gt;size());
            }
            <span class="keywordflow">else</span>
            {
              skirtVerts-&gt;push_back( (*surfaceVerts)[orig_i] );
              skirtVerts-&gt;push_back( (*surfaceVerts)[orig_i] - ((*skirtVectors)[orig_i])*skirtHeight );
              skirtNormals-&gt;push_back( (*normals)[orig_i] );             
              skirtNormals-&gt;push_back( (*normals)[orig_i] );             

              <span class="keywordflow">if</span> ( <a class="code" href="classSinglePassTerrainTechnique.html#ac52309b549b7b332c14e81241ce25e3a">_texCompositor</a>-&gt;requiresUnitTextureSpace() )
              {
                  unifiedSkirtTexCoords-&gt;push_back( (*unifiedSurfaceTexCoords)[orig_i] );
                  unifiedSkirtTexCoords-&gt;push_back( (*unifiedSurfaceTexCoords)[orig_i] );
              }
              <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( renderLayers.size() &gt; 0 )
              {
                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; renderLayers.size(); ++i)
                  {
                      <span class="keyword">const</span> osg::Vec2&amp; tc = (*renderLayers[i]._texCoords.get())[orig_i];
                      renderLayers[i]._skirtTexCoords-&gt;push_back( tc );
                      renderLayers[i]._skirtTexCoords-&gt;push_back( tc );
                  }
              }
            }
        }

        <span class="comment">// top:</span>
        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> c=numColumns-1; c&gt;0; --c )
        {
            <span class="keywordtype">int</span> orig_i = indices[(numRows-1)*numColumns+c];
            <span class="keywordflow">if</span> (orig_i &lt; 0)
            {
              <span class="keywordflow">if</span> (skirtBreaks.back() != skirtVerts-&gt;size())
                skirtBreaks.push_back(skirtVerts-&gt;size());
            }
            <span class="keywordflow">else</span>
            {
              skirtVerts-&gt;push_back( (*surfaceVerts)[orig_i] );
              skirtVerts-&gt;push_back( (*surfaceVerts)[orig_i] - ((*skirtVectors)[orig_i])*skirtHeight );
              skirtNormals-&gt;push_back( (*normals)[orig_i] );             
              skirtNormals-&gt;push_back( (*normals)[orig_i] );             

              <span class="keywordflow">if</span> ( <a class="code" href="classSinglePassTerrainTechnique.html#ac52309b549b7b332c14e81241ce25e3a">_texCompositor</a>-&gt;requiresUnitTextureSpace() )
              {
                  unifiedSkirtTexCoords-&gt;push_back( (*unifiedSurfaceTexCoords)[orig_i] );
                  unifiedSkirtTexCoords-&gt;push_back( (*unifiedSurfaceTexCoords)[orig_i] );
              }
              <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( renderLayers.size() &gt; 0 )
              {
                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; renderLayers.size(); ++i)
                  {
                      <span class="keyword">const</span> osg::Vec2&amp; tc = (*renderLayers[i]._texCoords.get())[orig_i];
                      renderLayers[i]._skirtTexCoords-&gt;push_back( tc );
                      renderLayers[i]._skirtTexCoords-&gt;push_back( tc );
                  }
              }
            }
        }

        <span class="comment">// left:</span>
        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> r=numRows-1; r&gt;=0; --r )
        {
            <span class="keywordtype">int</span> orig_i = indices[r*numColumns];
            <span class="keywordflow">if</span> (orig_i &lt; 0)
            {
              <span class="keywordflow">if</span> (skirtBreaks.back() != skirtVerts-&gt;size())
                skirtBreaks.push_back(skirtVerts-&gt;size());
            }
            <span class="keywordflow">else</span>
            {
              skirtVerts-&gt;push_back( (*surfaceVerts)[orig_i] );
              skirtVerts-&gt;push_back( (*surfaceVerts)[orig_i] - ((*skirtVectors)[orig_i])*skirtHeight );              
              skirtNormals-&gt;push_back( (*normals)[orig_i] );             
              skirtNormals-&gt;push_back( (*normals)[orig_i] );             

              <span class="keywordflow">if</span> ( <a class="code" href="classSinglePassTerrainTechnique.html#ac52309b549b7b332c14e81241ce25e3a">_texCompositor</a>-&gt;requiresUnitTextureSpace() )
              {
                  unifiedSkirtTexCoords-&gt;push_back( (*unifiedSurfaceTexCoords)[orig_i] );
                  unifiedSkirtTexCoords-&gt;push_back( (*unifiedSurfaceTexCoords)[orig_i] );
              }
              <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( renderLayers.size() &gt; 0 )
              {
                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; renderLayers.size(); ++i)
                  {
                      <span class="keyword">const</span> osg::Vec2&amp; tc = (*renderLayers[i]._texCoords.get())[orig_i];
                      renderLayers[i]._skirtTexCoords-&gt;push_back( tc );
                      renderLayers[i]._skirtTexCoords-&gt;push_back( tc );
                  }
              }
            }
        }

        skirt-&gt;setVertexArray( skirtVerts );
        skirt-&gt;setNormalArray( skirtNormals );
        skirt-&gt;setNormalBinding( osg::Geometry::BIND_PER_VERTEX );

        <span class="comment">//Add a primative set for each continuous skirt strip</span>
        skirtBreaks.push_back(skirtVerts-&gt;size());
        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p=1; p &lt; skirtBreaks.size(); p++)
          skirt-&gt;addPrimitiveSet( <span class="keyword">new</span> osg::DrawArrays( GL_TRIANGLE_STRIP, skirtBreaks[p-1], skirtBreaks[p] - skirtBreaks[p-1] ) );
    }
    
    <span class="keywordtype">bool</span> recalcNormals = elevationLayer != <a class="code" href="Export.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;

    <span class="comment">//Clear out the normals</span>
    <span class="keywordflow">if</span> (recalcNormals)
    {
        osg::Vec3Array::iterator nitr;
        <span class="keywordflow">for</span>(nitr = normals-&gt;begin();
            nitr!=normals-&gt;end();
            ++nitr)
        {
            nitr-&gt;set(0.0f,0.0f,0.0f);
        }
    }
    
    <span class="keywordflow">for</span>(j=0; j&lt;numRows-1; ++j)
    {
        <span class="keywordflow">for</span>(i=0; i&lt;numColumns-1; ++i)
        {
            <span class="keywordtype">int</span> i00;
            <span class="keywordtype">int</span> i01;
            <span class="keywordflow">if</span> (swapOrientation)
            {
                i01 = j*numColumns + i;
                i00 = i01+numColumns;
            }
            <span class="keywordflow">else</span>
            {
                i00 = j*numColumns + i;
                i01 = i00+numColumns;
            }

            <span class="keywordtype">int</span> i10 = i00+1;
            <span class="keywordtype">int</span> i11 = i01+1;

            <span class="comment">// remap indices to final vertex positions</span>
            i00 = indices[i00];
            i01 = indices[i01];
            i10 = indices[i10];
            i11 = indices[i11];
            
            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> numValid = 0;
            <span class="keywordflow">if</span> (i00&gt;=0) ++numValid;
            <span class="keywordflow">if</span> (i01&gt;=0) ++numValid;
            <span class="keywordflow">if</span> (i10&gt;=0) ++numValid;
            <span class="keywordflow">if</span> (i11&gt;=0) ++numValid;
            
            <span class="keywordflow">if</span> (numValid==4)
            {

                                <span class="keywordtype">bool</span> VALID = <span class="keyword">true</span>;
                                <span class="keywordflow">for</span> (MaskRecordVector::iterator mr = masks.begin(); mr != masks.end(); ++mr) {
                                        <span class="keywordtype">float</span> min_i = (*mr)._ndcMin.x() * (double)(numColumns-1);
                                        <span class="keywordtype">float</span> min_j = (*mr)._ndcMin.y() * (double)(numRows-1);
                                        <span class="keywordtype">float</span> max_i = (*mr)._ndcMax.x() * (double)(numColumns-1);
                                        <span class="keywordtype">float</span> max_j = (*mr)._ndcMax.y() * (double)(numRows-1);

                                        <span class="comment">// We test if mask is completely in square</span>
                                        <span class="keywordflow">if</span>(i+1 &gt;= min_i &amp;&amp; i &lt;= max_i &amp;&amp; j+1 &gt;= min_j &amp;&amp; j &lt;= max_j) {
                                                VALID = <span class="keyword">false</span>;
                                                <span class="keywordflow">break</span>;
                                        }
                                }

                                <span class="keywordflow">if</span> (VALID) {
                                        <span class="keywordtype">float</span> e00 = (*elevations)[i00];
                                        <span class="keywordtype">float</span> e10 = (*elevations)[i10];
                                        <span class="keywordtype">float</span> e01 = (*elevations)[i01];
                                        <span class="keywordtype">float</span> e11 = (*elevations)[i11];

                osg::Vec3f &amp;v00 = (*surfaceVerts)[i00];
                osg::Vec3f &amp;v10 = (*surfaceVerts)[i10];
                osg::Vec3f &amp;v01 = (*surfaceVerts)[i01];
                osg::Vec3f &amp;v11 = (*surfaceVerts)[i11];

                <span class="keywordflow">if</span> (!<a class="code" href="classSinglePassTerrainTechnique.html#a78a25d3a07259ff92e9025eff8b8c027">_optimizeTriangleOrientation</a> || (e00-e11)&lt;fabsf(e01-e10))
                {
                    elements-&gt;push_back(i01);
                    elements-&gt;push_back(i00);
                    elements-&gt;push_back(i11);

                    elements-&gt;push_back(i00);
                    elements-&gt;push_back(i10);
                    elements-&gt;push_back(i11);

                    <span class="keywordflow">if</span> (recalcNormals)
                    {                        
                        osg::Vec3 normal1 = (v00-v01) ^ (v11-v01);
                        (*normals)[i01] += normal1;
                        (*normals)[i00] += normal1;
                        (*normals)[i11] += normal1;

                        osg::Vec3 normal2 = (v10-v00)^(v11-v00);
                        (*normals)[i00] += normal2;
                        (*normals)[i10] += normal2;
                        (*normals)[i11] += normal2;
                    }
                }
                <span class="keywordflow">else</span>
                {
                    elements-&gt;push_back(i01);
                    elements-&gt;push_back(i00);
                    elements-&gt;push_back(i10);

                    elements-&gt;push_back(i01);
                    elements-&gt;push_back(i10);
                    elements-&gt;push_back(i11);

                    <span class="keywordflow">if</span> (recalcNormals)
                    {                       
                        osg::Vec3 normal1 = (v00-v01) ^ (v10-v01);
                        (*normals)[i01] += normal1;
                        (*normals)[i00] += normal1;
                        (*normals)[i10] += normal1;

                        osg::Vec3 normal2 = (v10-v01)^(v11-v01);
                        (*normals)[i01] += normal2;
                        (*normals)[i10] += normal2;
                        (*normals)[i11] += normal2;
                    }
                }
                                }
            }
            <span class="comment">// As skirtPoly is filling the mask bbox, we don&#39;t need to create isolated triangle</span>
                        <span class="comment">/*else if (numValid==3)</span>
<span class="comment">            {</span>
<span class="comment">                int validIndices[3];</span>
<span class="comment">                int indexPtr = 0;</span>
<span class="comment">                if (i00&gt;=0)</span>
<span class="comment">                {</span>
<span class="comment">                    elements-&gt;push_back(i00);</span>
<span class="comment">                    validIndices[indexPtr++] = i00;</span>
<span class="comment">                }</span>
<span class="comment"></span>
<span class="comment">                if (i01&gt;=0)</span>
<span class="comment">                {</span>
<span class="comment">                    elements-&gt;push_back(i01);</span>
<span class="comment">                    validIndices[indexPtr++] = i01;</span>
<span class="comment">                }</span>
<span class="comment"></span>
<span class="comment">                if (i11&gt;=0)</span>
<span class="comment">                {</span>
<span class="comment">                    elements-&gt;push_back(i11);</span>
<span class="comment">                    validIndices[indexPtr++] = i11;</span>
<span class="comment">                }</span>
<span class="comment"></span>
<span class="comment">                if (i10&gt;=0)</span>
<span class="comment">                {</span>
<span class="comment">                    elements-&gt;push_back(i10);</span>
<span class="comment">                    validIndices[indexPtr++] = i10;</span>
<span class="comment">                }</span>
<span class="comment"></span>
<span class="comment">                if (recalcNormals)</span>
<span class="comment">                {</span>
<span class="comment">                    osg::Vec3f &amp;v1 = (*surfaceVerts)[validIndices[0]];</span>
<span class="comment">                    osg::Vec3f &amp;v2 = (*surfaceVerts)[validIndices[1]];</span>
<span class="comment">                    osg::Vec3f &amp;v3 = (*surfaceVerts)[validIndices[2]];</span>
<span class="comment">                    osg::Vec3f normal = (v2 - v1) ^ (v3 - v1);</span>
<span class="comment">                    (*normals)[validIndices[0]] += normal;</span>
<span class="comment">                    (*normals)[validIndices[1]] += normal;</span>
<span class="comment">                    (*normals)[validIndices[2]] += normal;</span>
<span class="comment">                }</span>
<span class="comment">            } */</span>
        }
    }

    <span class="comment">//Normalize the normals</span>
    <span class="keywordflow">if</span> (recalcNormals)
    {
        osg::Vec3Array::iterator nitr;
        <span class="keywordflow">for</span>(nitr = normals-&gt;begin();
            nitr!=normals-&gt;end();
            ++nitr)
        {
            nitr-&gt;normalize();
        }
    }

  

    MeshConsolidator::run( *surface );

    <span class="keywordflow">if</span> ( skirt )
        MeshConsolidator::run( *skirt );

    <span class="keywordflow">for</span> (MaskRecordVector::iterator mr = masks.begin(); mr != masks.end(); ++mr)
        MeshConsolidator::run( *((*mr)._geom) );
    
   
    <span class="keywordflow">if</span> (osgDB::Registry::instance()-&gt;getBuildKdTreesHint()==osgDB::ReaderWriter::Options::BUILD_KDTREES &amp;&amp;
        osgDB::Registry::instance()-&gt;getKdTreeBuilder())
    {            
        osg::ref_ptr&lt;osg::KdTreeBuilder&gt; builder = osgDB::Registry::instance()-&gt;getKdTreeBuilder()-&gt;clone();
        geode-&gt;accept(*builder);
    }

    <span class="keywordflow">return</span> geode;
}
</pre></div>
<p><div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="closed.png"/> Here is the call graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classSinglePassTerrainTechnique_a46e28db8765c6497caa7d6d89e4acb64_cgraph.png" border="0" usemap="#classSinglePassTerrainTechnique_a46e28db8765c6497caa7d6d89e4acb64_cgraph" alt=""/></div>
<map name="classSinglePassTerrainTechnique_a46e28db8765c6497caa7d6d89e4acb64_cgraph" id="classSinglePassTerrainTechnique_a46e28db8765c6497caa7d6d89e4acb64_cgraph">
<area shape="rect" id="node3" href="classSinglePassTerrainTechnique.html#a51849da28ac79c19e5f9820160daf5e0" title="SinglePassTerrainTechnique::calculateSampling" alt="" coords="361,72,663,101"/><area shape="rect" id="node5" href="classTile.html#a36219d91d8b17471099bcc5c4bc1b2ed" title="Tile::getElevationLayer" alt="" coords="843,17,997,46"/><area shape="rect" id="node9" href="classTile.html#a7c0c83673975b5474d61a9845a0cd02b" title="Tile::getTerrain" alt="" coords="865,124,975,153"/><area shape="rect" id="node12" href="classosgEarth_1_1GeoLocator.html#a125f2bd702f4a911c65c6fe9334c640a" title="osgEarth::GeoLocator::getGeographicFromGeocentric" alt="" coords="345,177,679,206"/><area shape="rect" id="node20" href="classosgEarth_1_1Symbology_1_1Polygon.html#aef6967b31b28c8a5119269aaed5ad429" title="osgEarth::Symbology::Polygon::getHoles" alt="" coords="381,230,643,260"/><area shape="rect" id="node23" href="classosgEarth_1_1Symbology_1_1Geometry.html#a12044f75418af11e87a616a78967e5b1" title="osgEarth::Symbology::Geometry::getType" alt="" coords="379,284,645,313"/><area shape="rect" id="node25" href="classCustomColorLayer.html#af539b1957865fd51e5eb75ef7bd497ed" title="CustomColorLayer::getUID" alt="" coords="421,337,603,366"/><area shape="rect" id="node27" href="classTerrain.html#a9137bf26a5edaf11515e74aa58a6caf4" title="Terrain::getVerticalScale" alt="" coords="429,390,595,420"/><area shape="rect" id="node29" href="classosgEarth_1_1Symbology_1_1Geometry.html#ab226e51c4de9dac844f6ed63fded1129" title="osgEarth::Symbology::Geometry::toVec3Array" alt="" coords="367,444,657,473"/><area shape="rect" id="node7" href="classTerrain.html#afc533f56374093322731448e6a4b813e" title="Terrain::getSampleRatio" alt="" coords="839,70,1001,100"/><area shape="rect" id="node14" href="classosgEarth_1_1GeoLocator.html#a3d6d7da71a8187c45110890a550b5655" title="osgEarth::GeoLocator::GeoLocator" alt="" coords="808,177,1032,206"/><area shape="rect" id="node16" href="classosgEarth_1_1GeoExtent.html#afa0bd831daf0541cbbb161763ed9291f" title="osgEarth::GeoExtent::getBounds" alt="" coords="813,230,1027,260"/><area shape="rect" id="node18" href="classosgEarth_1_1GeoLocator.html#a0ed2730a383c6a42c1df8bb6b07fc6df" title="osgEarth::GeoLocator::getDataExtent" alt="" coords="800,284,1040,313"/><area shape="rect" id="node31" href="classosgEarth_1_1MixinVector.html#a09e839d601931f13776d30648ecd97f0" title="osgEarth::MixinVector\&lt; osg::Vec3d, osg::Referenced \&gt;::begin" alt="" coords="728,364,1112,393"/><area shape="rect" id="node33" href="namespaceanonymous__namespace_02MeshConsolidator_8cpp_03.html#aa89185796215b0f0669f5a44549b6eed" title="anonymous_namespace\{MeshConsolidator::cpp\}::copy" alt="" coords="749,417,1091,446"/><area shape="rect" id="node35" href="classosgEarth_1_1MixinVector.html#ad40d751f91c9b8637fc5a274e75cd8a7" title="osgEarth::MixinVector\&lt; osg::Vec3d, osg::Referenced \&gt;::end" alt="" coords="733,470,1107,500"/><area shape="rect" id="node37" href="classosgEarth_1_1MixinVector.html#a29d1318457f75e1e0841d7e20f61dadb" title="osgEarth::MixinVector\&lt; osg::Vec3d, osg::Referenced \&gt;::size" alt="" coords="732,524,1108,553"/></map>
</div>
</p>

<p><div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="closed.png"/> Here is the caller graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classSinglePassTerrainTechnique_a46e28db8765c6497caa7d6d89e4acb64_icgraph.png" border="0" usemap="#classSinglePassTerrainTechnique_a46e28db8765c6497caa7d6d89e4acb64_icgraph" alt=""/></div>
<map name="classSinglePassTerrainTechnique_a46e28db8765c6497caa7d6d89e4acb64_icgraph" id="classSinglePassTerrainTechnique_a46e28db8765c6497caa7d6d89e4acb64_icgraph">
<area shape="rect" id="node3" href="classSinglePassTerrainTechnique.html#a38db1d0b19580a4db1b8b29fa245702c" title="SinglePassTerrainTechnique::compile" alt="" coords="345,5,585,35"/><area shape="rect" id="node5" href="classSinglePassTerrainTechnique.html#aad7ee72f83efd718654a798045f8a41c" title="SinglePassTerrainTechnique::init" alt="" coords="635,5,848,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0804134cb4f0834a42e6630329884b4e"></a><!-- doxytag: member="SinglePassTerrainTechnique::createStateSet" ref="a0804134cb4f0834a42e6630329884b4e" args="(const TileFrame &amp;tilef)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">osg::StateSet * SinglePassTerrainTechnique::createStateSet </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTileFrame.html">TileFrame</a> &amp;&#160;</td>
          <td class="paramname"><em>tilef</em></td><td>)</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_8cpp_source.html#l00449">449</a> of file <a class="el" href="SinglePassTerrainTechnique_8cpp_source.html">SinglePassTerrainTechnique.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">// establish the tile extent. we will calculate texture coordinate offset/scale based on this</span>
    <span class="keywordflow">if</span> ( !<a class="code" href="classSinglePassTerrainTechnique.html#ac3cd7043773f87b27a031fdf30cd6ca6">_tileExtent</a>.<a class="code" href="classosgEarth_1_1GeoExtent.html#a8151cbc0905e59c9d88e6fad5690a0ce">isValid</a>() )
    {
        osg::ref_ptr&lt;GeoLocator&gt; tileLocator = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classosgEarth_1_1GeoLocator.html">GeoLocator</a>*<span class="keyword">&gt;</span>( tilef.<a class="code" href="classTileFrame.html#aa9f38be86727ff3cb3240ae227f52eb3">_locator</a>.get() ); <span class="comment">// _terrainTile-&gt;getLocator() );</span>
        <span class="keywordflow">if</span> ( tileLocator.valid() )
        {
            <span class="keywordflow">if</span> ( tileLocator-&gt;getCoordinateSystemType() == osgTerrain::Locator::GEOCENTRIC )
                tileLocator = tileLocator-&gt;<a class="code" href="classosgEarth_1_1GeoLocator.html#a125f2bd702f4a911c65c6fe9334c640a">getGeographicFromGeocentric</a>();

            <a class="code" href="classSinglePassTerrainTechnique.html#ac3cd7043773f87b27a031fdf30cd6ca6">_tileExtent</a> = tileLocator-&gt;getDataExtent();
        }
        <a class="code" href="classSinglePassTerrainTechnique.html#a2a1afb3a9679e9c57102e343d9d23ec7">_tileKey</a> = tilef.<a class="code" href="classTileFrame.html#a80e388d2d6e69047140409ce6ee0127d">_tileKey</a>;
    }

    osg::StateSet* stateSet = <span class="keyword">new</span> osg::StateSet();
    osg::StateSet* parentStateSet = <a class="code" href="classSinglePassTerrainTechnique.html#aa775992f0528849e57df987f7ea2a99a">getParentStateSet</a>();

    <span class="keywordflow">for</span>( ColorLayersByUID::const_iterator i = tilef.<a class="code" href="classTileFrame.html#a1f75e20b5596b6a14d27fe3938b37075">_colorLayers</a>.begin(); i != tilef.<a class="code" href="classTileFrame.html#a1f75e20b5596b6a14d27fe3938b37075">_colorLayers</a>.end(); ++i )
    {
        <span class="keyword">const</span> <a class="code" href="classCustomColorLayer.html">CustomColorLayer</a>&amp; colorLayer = i-&gt;second;

        <span class="keywordtype">bool</span> isRealData = !colorLayer.<a class="code" href="classCustomColorLayer.html#abf341a630a68be118bfe8ab562b6eb78">isFallbackData</a>();

        <a class="code" href="classosgEarth_1_1GeoImage.html">GeoImage</a> image;
        <span class="keywordflow">if</span> ( <a class="code" href="classSinglePassTerrainTechnique.html#aaf6c1a4c000dbcefc89a2c1b795dc26f">createGeoImage</a>( colorLayer, image ) )
        {
            image = <a class="code" href="classSinglePassTerrainTechnique.html#ac52309b549b7b332c14e81241ce25e3a">_texCompositor</a>-&gt;prepareImage( image, <a class="code" href="classSinglePassTerrainTechnique.html#ac3cd7043773f87b27a031fdf30cd6ca6">_tileExtent</a> );

            <a class="code" href="classSinglePassTerrainTechnique.html#ac52309b549b7b332c14e81241ce25e3a">_texCompositor</a>-&gt;applyLayerUpdate( 
                stateSet, 
                colorLayer.<a class="code" href="classCustomColorLayer.html#af539b1957865fd51e5eb75ef7bd497ed">getUID</a>(), 
                image, 
                <a class="code" href="classSinglePassTerrainTechnique.html#a2a1afb3a9679e9c57102e343d9d23ec7">_tileKey</a>, 
                isRealData ? parentStateSet : 0L );
        }
    }

    <span class="keywordflow">return</span> stateSet;
}
</pre></div>
<p><div id="dynsection-12" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="closed.png"/> Here is the call graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classSinglePassTerrainTechnique_a0804134cb4f0834a42e6630329884b4e_cgraph.png" border="0" usemap="#classSinglePassTerrainTechnique_a0804134cb4f0834a42e6630329884b4e_cgraph" alt=""/></div>
<map name="classSinglePassTerrainTechnique_a0804134cb4f0834a42e6630329884b4e_cgraph" id="classSinglePassTerrainTechnique_a0804134cb4f0834a42e6630329884b4e_cgraph">
<area shape="rect" id="node3" href="classSinglePassTerrainTechnique.html#aaf6c1a4c000dbcefc89a2c1b795dc26f" title="SinglePassTerrainTechnique::createGeoImage" alt="" coords="343,112,633,141"/><area shape="rect" id="node5" href="classosgEarth_1_1GeoLocator.html#a125f2bd702f4a911c65c6fe9334c640a" title="osgEarth::GeoLocator::getGeographicFromGeocentric" alt="" coords="689,59,1023,88"/><area shape="rect" id="node18" href="classSinglePassTerrainTechnique.html#aa775992f0528849e57df987f7ea2a99a" title="SinglePassTerrainTechnique::getParentStateSet" alt="" coords="337,165,639,195"/><area shape="rect" id="node24" href="classCustomColorLayer.html#af539b1957865fd51e5eb75ef7bd497ed" title="CustomColorLayer::getUID" alt="" coords="397,219,579,248"/><area shape="rect" id="node26" href="classCustomColorLayer.html#abf341a630a68be118bfe8ab562b6eb78" title="CustomColorLayer::isFallbackData" alt="" coords="375,272,601,301"/><area shape="rect" id="node28" href="classosgEarth_1_1GeoExtent.html#a8151cbc0905e59c9d88e6fad5690a0ce" title="osgEarth::GeoExtent::isValid" alt="" coords="393,325,583,355"/><area shape="rect" id="node13" href="classCustomColorLayer.html#a761fdfb07388be6ac6438c2b96c7639d" title="CustomColorLayer::getImage" alt="" coords="760,112,952,141"/><area shape="rect" id="node15" href="classCustomColorLayer.html#ac9725adc85c194c7b4a4c99ed26d3d52" title="CustomColorLayer::getLocator" alt="" coords="756,165,956,195"/><area shape="rect" id="node7" href="classosgEarth_1_1GeoLocator.html#a3d6d7da71a8187c45110890a550b5655" title="osgEarth::GeoLocator::GeoLocator" alt="" coords="1101,5,1325,35"/><area shape="rect" id="node9" href="classosgEarth_1_1GeoExtent.html#afa0bd831daf0541cbbb161763ed9291f" title="osgEarth::GeoExtent::getBounds" alt="" coords="1107,59,1320,88"/><area shape="rect" id="node11" href="classosgEarth_1_1GeoLocator.html#a0ed2730a383c6a42c1df8bb6b07fc6df" title="osgEarth::GeoLocator::getDataExtent" alt="" coords="1093,112,1333,141"/><area shape="rect" id="node20" href="classSinglePassTerrainTechnique.html#a4f815dffbcff201fdd1703ba7ee8e288" title="SinglePassTerrainTechnique::getActiveStateSet" alt="" coords="705,219,1007,248"/><area shape="rect" id="node22" href="classSinglePassTerrainTechnique.html#a569874547276caff6a69d142e7910538" title="SinglePassTerrainTechnique::getFrontGeode" alt="" coords="1072,219,1355,248"/><area shape="rect" id="node30" href="classosgEarth_1_1GeoExtent.html#a9ed09180cbcdd15321ced7b24f4c4c9d" title="osgEarth::GeoExtent::height" alt="" coords="763,299,949,328"/><area shape="rect" id="node32" href="classosgEarth_1_1GeoExtent.html#a1161940ef6756ba732ff7fc7da21db2d" title="osgEarth::GeoExtent::width" alt="" coords="765,352,947,381"/><area shape="rect" id="node34" href="classosgEarth_1_1GeoExtent.html#a744d26309f6eddfd74b72a01c159dc79" title="osgEarth::GeoExtent::crossesDateLine" alt="" coords="1088,352,1339,381"/></map>
</div>
</p>

<p><div id="dynsection-13" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="closed.png"/> Here is the caller graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classSinglePassTerrainTechnique_a0804134cb4f0834a42e6630329884b4e_icgraph.png" border="0" usemap="#classSinglePassTerrainTechnique_a0804134cb4f0834a42e6630329884b4e_icgraph" alt=""/></div>
<map name="classSinglePassTerrainTechnique_a0804134cb4f0834a42e6630329884b4e_icgraph" id="classSinglePassTerrainTechnique_a0804134cb4f0834a42e6630329884b4e_icgraph">
<area shape="rect" id="node3" href="classSinglePassTerrainTechnique.html#a38db1d0b19580a4db1b8b29fa245702c" title="SinglePassTerrainTechnique::compile" alt="" coords="337,5,577,35"/><area shape="rect" id="node5" href="classSinglePassTerrainTechnique.html#aad7ee72f83efd718654a798045f8a41c" title="SinglePassTerrainTechnique::init" alt="" coords="627,5,840,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4f815dffbcff201fdd1703ba7ee8e288"></a><!-- doxytag: member="SinglePassTerrainTechnique::getActiveStateSet" ref="a4f815dffbcff201fdd1703ba7ee8e288" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">osg::StateSet * SinglePassTerrainTechnique::getActiveStateSet </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_8cpp_source.html#l00422">422</a> of file <a class="el" href="SinglePassTerrainTechnique_8cpp_source.html">SinglePassTerrainTechnique.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    OpenThreads::ScopedLock&lt;Mutex&gt; exclusiveLock( const_cast&lt;SinglePassTerrainTechnique*&gt;(<span class="keyword">this</span>)-&gt;<a class="code" href="classSinglePassTerrainTechnique.html#ad1bc9e9de18135eeeba07976e83ad857">_compileMutex</a> );

    osg::StateSet* result = 0L;
    osg::Geode* front = <a class="code" href="classSinglePassTerrainTechnique.html#a569874547276caff6a69d142e7910538">getFrontGeode</a>();
    <span class="keywordflow">if</span> ( front ) 
        result = front-&gt;getStateSet();
    <span class="keywordflow">if</span> ( !result &amp;&amp; <a class="code" href="classSinglePassTerrainTechnique.html#a4d520a524293b3fa797e22f5de77813f">_backGeode</a>.valid() )
        result = <a class="code" href="classSinglePassTerrainTechnique.html#a4d520a524293b3fa797e22f5de77813f">_backGeode</a>-&gt;getStateSet();

    <span class="keywordflow">return</span> result;
}
</pre></div>
<p><div id="dynsection-14" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="closed.png"/> Here is the call graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classSinglePassTerrainTechnique_a4f815dffbcff201fdd1703ba7ee8e288_cgraph.png" border="0" usemap="#classSinglePassTerrainTechnique_a4f815dffbcff201fdd1703ba7ee8e288_cgraph" alt=""/></div>
<map name="classSinglePassTerrainTechnique_a4f815dffbcff201fdd1703ba7ee8e288_cgraph" id="classSinglePassTerrainTechnique_a4f815dffbcff201fdd1703ba7ee8e288_cgraph">
<area shape="rect" id="node3" href="classSinglePassTerrainTechnique.html#a569874547276caff6a69d142e7910538" title="SinglePassTerrainTechnique::getFrontGeode" alt="" coords="357,5,640,35"/></map>
</div>
</p>

<p><div id="dynsection-15" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-15-trigger" src="closed.png"/> Here is the caller graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classSinglePassTerrainTechnique_a4f815dffbcff201fdd1703ba7ee8e288_icgraph.png" border="0" usemap="#classSinglePassTerrainTechnique_a4f815dffbcff201fdd1703ba7ee8e288_icgraph" alt=""/></div>
<map name="classSinglePassTerrainTechnique_a4f815dffbcff201fdd1703ba7ee8e288_icgraph" id="classSinglePassTerrainTechnique_a4f815dffbcff201fdd1703ba7ee8e288_icgraph">
<area shape="rect" id="node3" href="classSinglePassTerrainTechnique.html#aa775992f0528849e57df987f7ea2a99a" title="SinglePassTerrainTechnique::getParentStateSet" alt="" coords="359,33,660,63"/><area shape="rect" id="node5" href="classSinglePassTerrainTechnique.html#ab32efb9633174fc7d8f89a9521feb9cb" title="SinglePassTerrainTechnique::applyTileUpdates" alt="" coords="1041,5,1337,35"/><area shape="rect" id="node9" href="classSinglePassTerrainTechnique.html#a0804134cb4f0834a42e6630329884b4e" title="SinglePassTerrainTechnique::createStateSet" alt="" coords="709,59,992,88"/><area shape="rect" id="node7" href="classSinglePassTerrainTechnique.html#aad7ee72f83efd718654a798045f8a41c" title="SinglePassTerrainTechnique::init" alt="" coords="1387,32,1600,61"/><area shape="rect" id="node11" href="classSinglePassTerrainTechnique.html#a38db1d0b19580a4db1b8b29fa245702c" title="SinglePassTerrainTechnique::compile" alt="" coords="1069,59,1309,88"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a569874547276caff6a69d142e7910538"></a><!-- doxytag: member="SinglePassTerrainTechnique::getFrontGeode" ref="a569874547276caff6a69d142e7910538" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">osg::Geode* SinglePassTerrainTechnique::getFrontGeode </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_source.html#l00174">174</a> of file <a class="el" href="SinglePassTerrainTechnique_source.html">SinglePassTerrainTechnique</a>.</p>
<div class="fragment"><pre class="fragment">                                           {
        <span class="keywordflow">if</span> (<a class="code" href="classSinglePassTerrainTechnique.html#ab4f26ad5ef62bd9f8c1785c2edd7a4cc">_transform</a>.valid() &amp;&amp; <a class="code" href="classSinglePassTerrainTechnique.html#ab4f26ad5ef62bd9f8c1785c2edd7a4cc">_transform</a>-&gt;getNumChildren() &gt; 0)
            <span class="keywordflow">return</span> static_cast&lt;osg::Geode*&gt;( <a class="code" href="classSinglePassTerrainTechnique.html#ab4f26ad5ef62bd9f8c1785c2edd7a4cc">_transform</a>-&gt;getChild(0) ); 
        <span class="keywordflow">return</span> <a class="code" href="Export.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
    }
</pre></div>
<p><div id="dynsection-16" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-16-trigger" src="closed.png"/> Here is the caller graph for this function:</div>
<div id="dynsection-16-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-16-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classSinglePassTerrainTechnique_a569874547276caff6a69d142e7910538_icgraph.png" border="0" usemap="#classSinglePassTerrainTechnique_a569874547276caff6a69d142e7910538_icgraph" alt=""/></div>
<map name="classSinglePassTerrainTechnique_a569874547276caff6a69d142e7910538_icgraph" id="classSinglePassTerrainTechnique_a569874547276caff6a69d142e7910538_icgraph">
<area shape="rect" id="node3" href="classSinglePassTerrainTechnique.html#ab32efb9633174fc7d8f89a9521feb9cb" title="SinglePassTerrainTechnique::applyTileUpdates" alt="" coords="1041,5,1337,35"/><area shape="rect" id="node7" href="classSinglePassTerrainTechnique.html#a4f815dffbcff201fdd1703ba7ee8e288" title="SinglePassTerrainTechnique::getActiveStateSet" alt="" coords="337,57,639,87"/><area shape="rect" id="node5" href="classSinglePassTerrainTechnique.html#aad7ee72f83efd718654a798045f8a41c" title="SinglePassTerrainTechnique::init" alt="" coords="1677,33,1891,63"/><area shape="rect" id="node9" href="classSinglePassTerrainTechnique.html#aa775992f0528849e57df987f7ea2a99a" title="SinglePassTerrainTechnique::getParentStateSet" alt="" coords="689,57,991,87"/><area shape="rect" id="node12" href="classSinglePassTerrainTechnique.html#a0804134cb4f0834a42e6630329884b4e" title="SinglePassTerrainTechnique::createStateSet" alt="" coords="1048,59,1331,88"/><area shape="rect" id="node14" href="classSinglePassTerrainTechnique.html#a38db1d0b19580a4db1b8b29fa245702c" title="SinglePassTerrainTechnique::compile" alt="" coords="1388,59,1628,88"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a231e9b18a46e861834e0016df0e6d647"></a><!-- doxytag: member="SinglePassTerrainTechnique::getIndexOfColorLayerWithUID" ref="a231e9b18a46e861834e0016df0e6d647" args="(UID uid) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SinglePassTerrainTechnique::getIndexOfColorLayerWithUID </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceosgEarth.html#afc79b9a35ed940aaee797fde114b9801">UID</a>&#160;</td>
          <td class="paramname"><em>uid</em></td><td>)</td>
          <td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a72fe68f4c968f91ac77e32051c296f0b"></a><!-- doxytag: member="SinglePassTerrainTechnique::getOptimizeTriangleOrientation" ref="a72fe68f4c968f91ac77e32051c296f0b" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool SinglePassTerrainTechnique::getOptimizeTriangleOrientation </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implements <a class="el" href="classCustomTerrainTechnique.html#a777ff35493e1c7dd4480d8607af368bb">CustomTerrainTechnique</a>.</p>

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_8cpp_source.html#l00121">121</a> of file <a class="el" href="SinglePassTerrainTechnique_8cpp_source.html">SinglePassTerrainTechnique.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> <a class="code" href="classSinglePassTerrainTechnique.html#a78a25d3a07259ff92e9025eff8b8c027">_optimizeTriangleOrientation</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa775992f0528849e57df987f7ea2a99a"></a><!-- doxytag: member="SinglePassTerrainTechnique::getParentStateSet" ref="aa775992f0528849e57df987f7ea2a99a" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">osg::StateSet * SinglePassTerrainTechnique::getParentStateSet </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_8cpp_source.html#l00437">437</a> of file <a class="el" href="SinglePassTerrainTechnique_8cpp_source.html">SinglePassTerrainTechnique.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    osg::StateSet* parentStateSet = 0;
    osg::ref_ptr&lt;Tile&gt; parentTile_safe = <a class="code" href="classSinglePassTerrainTechnique.html#a2eebc195c0ab7234ffd6c06370b022a8">_parentTile</a>.get();
    <span class="keywordflow">if</span> ( parentTile_safe.valid() )
    {
        <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><a class="code" href="classSinglePassTerrainTechnique.html">SinglePassTerrainTechnique</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSinglePassTerrainTechnique.html#a2eebc195c0ab7234ffd6c06370b022a8">_parentTile</a>-&gt;getTerrainTechnique())-&gt;<a class="code" href="classSinglePassTerrainTechnique.html#a4f815dffbcff201fdd1703ba7ee8e288">getActiveStateSet</a>();
    }
    <span class="keywordflow">else</span> <span class="keywordflow">return</span> 0L;
}
</pre></div>
<p><div id="dynsection-17" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-17-trigger" src="closed.png"/> Here is the call graph for this function:</div>
<div id="dynsection-17-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-17-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classSinglePassTerrainTechnique_aa775992f0528849e57df987f7ea2a99a_cgraph.png" border="0" usemap="#classSinglePassTerrainTechnique_aa775992f0528849e57df987f7ea2a99a_cgraph" alt=""/></div>
<map name="classSinglePassTerrainTechnique_aa775992f0528849e57df987f7ea2a99a_cgraph" id="classSinglePassTerrainTechnique_aa775992f0528849e57df987f7ea2a99a_cgraph">
<area shape="rect" id="node3" href="classSinglePassTerrainTechnique.html#a4f815dffbcff201fdd1703ba7ee8e288" title="SinglePassTerrainTechnique::getActiveStateSet" alt="" coords="359,5,660,35"/><area shape="rect" id="node5" href="classSinglePassTerrainTechnique.html#a569874547276caff6a69d142e7910538" title="SinglePassTerrainTechnique::getFrontGeode" alt="" coords="709,5,992,35"/></map>
</div>
</p>

<p><div id="dynsection-18" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-18-trigger" src="closed.png"/> Here is the caller graph for this function:</div>
<div id="dynsection-18-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-18-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classSinglePassTerrainTechnique_aa775992f0528849e57df987f7ea2a99a_icgraph.png" border="0" usemap="#classSinglePassTerrainTechnique_aa775992f0528849e57df987f7ea2a99a_icgraph" alt=""/></div>
<map name="classSinglePassTerrainTechnique_aa775992f0528849e57df987f7ea2a99a_icgraph" id="classSinglePassTerrainTechnique_aa775992f0528849e57df987f7ea2a99a_icgraph">
<area shape="rect" id="node3" href="classSinglePassTerrainTechnique.html#ab32efb9633174fc7d8f89a9521feb9cb" title="SinglePassTerrainTechnique::applyTileUpdates" alt="" coords="689,5,985,35"/><area shape="rect" id="node7" href="classSinglePassTerrainTechnique.html#a0804134cb4f0834a42e6630329884b4e" title="SinglePassTerrainTechnique::createStateSet" alt="" coords="357,59,640,88"/><area shape="rect" id="node5" href="classSinglePassTerrainTechnique.html#aad7ee72f83efd718654a798045f8a41c" title="SinglePassTerrainTechnique::init" alt="" coords="1035,32,1248,61"/><area shape="rect" id="node9" href="classSinglePassTerrainTechnique.html#a38db1d0b19580a4db1b8b29fa245702c" title="SinglePassTerrainTechnique::compile" alt="" coords="717,59,957,88"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4b1083c8b3090b78dc9198ce16710f5d"></a><!-- doxytag: member="SinglePassTerrainTechnique::getVerticalScaleOverride" ref="a4b1083c8b3090b78dc9198ce16710f5d" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float SinglePassTerrainTechnique::getVerticalScaleOverride </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Gets the overriden vertical scale value. </p>

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_8cpp_source.html#l00109">109</a> of file <a class="el" href="SinglePassTerrainTechnique_8cpp_source.html">SinglePassTerrainTechnique.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> <a class="code" href="classSinglePassTerrainTechnique.html#ab3ba452d350fb8303ae315ec2e17d34e">_verticalScaleOverride</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aad7ee72f83efd718654a798045f8a41c"></a><!-- doxytag: member="SinglePassTerrainTechnique::init" ref="aad7ee72f83efd718654a798045f8a41c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SinglePassTerrainTechnique::init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implements <a class="el" href="classTerrainTechnique.html#aea039a0faafda60832d0e948c78b8e29">TerrainTechnique</a>.</p>

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_8cpp_source.html#l00127">127</a> of file <a class="el" href="SinglePassTerrainTechnique_8cpp_source.html">SinglePassTerrainTechnique.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="classSinglePassTerrainTechnique.html#a38db1d0b19580a4db1b8b29fa245702c">compile</a>( <a class="code" href="structTileUpdate.html">TileUpdate</a>(<a class="code" href="structTileUpdate.html#a6e936293df482c0d99b4aa5fe80bcabda1427d9e91d1aa0309b9bf3dc6fd55695">TileUpdate::UPDATE_ALL</a>), 0L );
    <a class="code" href="classSinglePassTerrainTechnique.html#ab32efb9633174fc7d8f89a9521feb9cb">applyTileUpdates</a>();
}
</pre></div>
<p><div id="dynsection-19" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-19-trigger" src="closed.png"/> Here is the call graph for this function:</div>
<div id="dynsection-19-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-19-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classSinglePassTerrainTechnique_aad7ee72f83efd718654a798045f8a41c_cgraph.png" border="0" usemap="#classSinglePassTerrainTechnique_aad7ee72f83efd718654a798045f8a41c_cgraph" alt=""/></div>
<map name="classSinglePassTerrainTechnique_aad7ee72f83efd718654a798045f8a41c_cgraph" id="classSinglePassTerrainTechnique_aad7ee72f83efd718654a798045f8a41c_cgraph">
<area shape="rect" id="node3" href="classSinglePassTerrainTechnique.html#ab32efb9633174fc7d8f89a9521feb9cb" title="SinglePassTerrainTechnique::applyTileUpdates" alt="" coords="584,58,880,88"/><area shape="rect" id="node14" href="classSinglePassTerrainTechnique.html#a38db1d0b19580a4db1b8b29fa245702c" title="SinglePassTerrainTechnique::compile" alt="" coords="268,322,508,352"/><area shape="rect" id="node5" href="namespaceanonymous__namespace_02MeshConsolidator_8cpp_03.html#aa89185796215b0f0669f5a44549b6eed" title="anonymous_namespace\{MeshConsolidator::cpp\}::copy" alt="" coords="1328,30,1669,60"/><area shape="rect" id="node7" href="classSinglePassTerrainTechnique.html#a569874547276caff6a69d142e7910538" title="SinglePassTerrainTechnique::getFrontGeode" alt="" coords="1739,32,2021,61"/><area shape="rect" id="node9" href="classSinglePassTerrainTechnique.html#aa775992f0528849e57df987f7ea2a99a" title="SinglePassTerrainTechnique::getParentStateSet" alt="" coords="956,84,1257,113"/><area shape="rect" id="node11" href="classSinglePassTerrainTechnique.html#a4f815dffbcff201fdd1703ba7ee8e288" title="SinglePassTerrainTechnique::getActiveStateSet" alt="" coords="1348,84,1649,113"/><area shape="rect" id="node16" href="classSinglePassTerrainTechnique.html#a46e28db8765c6497caa7d6d89e4acb64" title="SinglePassTerrainTechnique::createGeometry" alt="" coords="588,376,876,405"/><area shape="rect" id="node53" href="classSinglePassTerrainTechnique.html#a0804134cb4f0834a42e6630329884b4e" title="SinglePassTerrainTechnique::createStateSet" alt="" coords="591,608,873,637"/><area shape="rect" id="node75" href="structTileUpdate.html#a8462dd4c2eee5ffe575de63f4f5bafb6" title="TileUpdate::getAction" alt="" coords="659,216,805,245"/><area shape="rect" id="node77" href="structTileUpdate.html#a9290735e48c4063f0ca693463d082ab3" title="TileUpdate::getLayerUID" alt="" coords="649,269,815,298"/><area shape="rect" id="node79" href="classosgEarth_1_1ProgressCallback.html#abe0f8bf93f93716f3aad268c0fe4c1e7" title="osgEarth::ProgressCallback::isCanceled" alt="" coords="603,322,861,352"/><area shape="rect" id="node81" href="classSinglePassTerrainTechnique.html#aaff3bb19a4bf4cfc19060c3c26053fb9" title="SinglePassTerrainTechnique::prepareImageLayerUpdate" alt="" coords="557,766,907,796"/><area shape="rect" id="node18" href="classSinglePassTerrainTechnique.html#a51849da28ac79c19e5f9820160daf5e0" title="SinglePassTerrainTechnique::calculateSampling" alt="" coords="956,401,1257,430"/><area shape="rect" id="node20" href="classTile.html#a36219d91d8b17471099bcc5c4bc1b2ed" title="Tile::getElevationLayer" alt="" coords="1421,348,1576,377"/><area shape="rect" id="node24" href="classTile.html#a7c0c83673975b5474d61a9845a0cd02b" title="Tile::getTerrain" alt="" coords="1444,454,1553,484"/><area shape="rect" id="node27" href="classosgEarth_1_1GeoLocator.html#a125f2bd702f4a911c65c6fe9334c640a" title="osgEarth::GeoLocator::getGeographicFromGeocentric" alt="" coords="1332,606,1665,636"/><area shape="rect" id="node35" href="classosgEarth_1_1Symbology_1_1Polygon.html#aef6967b31b28c8a5119269aaed5ad429" title="osgEarth::Symbology::Polygon::getHoles" alt="" coords="976,244,1237,273"/><area shape="rect" id="node38" href="classosgEarth_1_1Symbology_1_1Geometry.html#a12044f75418af11e87a616a78967e5b1" title="osgEarth::Symbology::Geometry::getType" alt="" coords="973,297,1240,326"/><area shape="rect" id="node40" href="classCustomColorLayer.html#af539b1957865fd51e5eb75ef7bd497ed" title="CustomColorLayer::getUID" alt="" coords="1016,556,1197,585"/><area shape="rect" id="node42" href="classTerrain.html#a9137bf26a5edaf11515e74aa58a6caf4" title="Terrain::getVerticalScale" alt="" coords="1024,190,1189,220"/><area shape="rect" id="node44" href="classosgEarth_1_1Symbology_1_1Geometry.html#ab226e51c4de9dac844f6ed63fded1129" title="osgEarth::Symbology::Geometry::toVec3Array" alt="" coords="961,137,1252,166"/><area shape="rect" id="node22" href="classTerrain.html#afc533f56374093322731448e6a4b813e" title="Terrain::getSampleRatio" alt="" coords="1417,401,1580,430"/><area shape="rect" id="node29" href="classosgEarth_1_1GeoLocator.html#a3d6d7da71a8187c45110890a550b5655" title="osgEarth::GeoLocator::GeoLocator" alt="" coords="1768,660,1992,689"/><area shape="rect" id="node31" href="classosgEarth_1_1GeoExtent.html#afa0bd831daf0541cbbb161763ed9291f" title="osgEarth::GeoExtent::getBounds" alt="" coords="1773,553,1987,582"/><area shape="rect" id="node33" href="classosgEarth_1_1GeoLocator.html#a0ed2730a383c6a42c1df8bb6b07fc6df" title="osgEarth::GeoLocator::getDataExtent" alt="" coords="1760,606,2000,636"/><area shape="rect" id="node46" href="classosgEarth_1_1MixinVector.html#a09e839d601931f13776d30648ecd97f0" title="osgEarth::MixinVector\&lt; osg::Vec3d, osg::Referenced \&gt;::begin" alt="" coords="1307,190,1691,220"/><area shape="rect" id="node49" href="classosgEarth_1_1MixinVector.html#ad40d751f91c9b8637fc5a274e75cd8a7" title="osgEarth::MixinVector\&lt; osg::Vec3d, osg::Referenced \&gt;::end" alt="" coords="1312,244,1685,273"/><area shape="rect" id="node51" href="classosgEarth_1_1MixinVector.html#a29d1318457f75e1e0841d7e20f61dadb" title="osgEarth::MixinVector\&lt; osg::Vec3d, osg::Referenced \&gt;::size" alt="" coords="1311,137,1687,166"/><area shape="rect" id="node55" href="classSinglePassTerrainTechnique.html#aaf6c1a4c000dbcefc89a2c1b795dc26f" title="SinglePassTerrainTechnique::createGeoImage" alt="" coords="961,766,1252,796"/><area shape="rect" id="node65" href="classCustomColorLayer.html#abf341a630a68be118bfe8ab562b6eb78" title="CustomColorLayer::isFallbackData" alt="" coords="993,713,1220,742"/><area shape="rect" id="node67" href="classosgEarth_1_1GeoExtent.html#a8151cbc0905e59c9d88e6fad5690a0ce" title="osgEarth::GeoExtent::isValid" alt="" coords="1012,660,1201,689"/><area shape="rect" id="node58" href="classCustomColorLayer.html#a761fdfb07388be6ac6438c2b96c7639d" title="CustomColorLayer::getImage" alt="" coords="1403,766,1595,796"/><area shape="rect" id="node60" href="classCustomColorLayer.html#ac9725adc85c194c7b4a4c99ed26d3d52" title="CustomColorLayer::getLocator" alt="" coords="1399,820,1599,849"/><area shape="rect" id="node69" href="classosgEarth_1_1GeoExtent.html#a9ed09180cbcdd15321ced7b24f4c4c9d" title="osgEarth::GeoExtent::height" alt="" coords="1405,660,1592,689"/><area shape="rect" id="node71" href="classosgEarth_1_1GeoExtent.html#a1161940ef6756ba732ff7fc7da21db2d" title="osgEarth::GeoExtent::width" alt="" coords="1408,713,1589,742"/><area shape="rect" id="node73" href="classosgEarth_1_1GeoExtent.html#a744d26309f6eddfd74b72a01c159dc79" title="osgEarth::GeoExtent::crossesDateLine" alt="" coords="1755,713,2005,742"/><area shape="rect" id="node84" href="classTileFrame.html#aa64f473bf7c23057885cb44209238ea2" title="TileFrame::getCustomColorLayer" alt="" coords="1000,820,1213,849"/><area shape="rect" id="node87" href="classosgEarth_1_1GeoImage.html#a40db87ae60b4dde189b1f218ff3c8777" title="osgEarth::GeoImage::valid" alt="" coords="1019,873,1195,902"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a19b8a3e14dd898be941b082436ad30bf"></a><!-- doxytag: member="SinglePassTerrainTechnique::META_Object" ref="a19b8a3e14dd898be941b082436ad30bf" args="(osgEarth, SinglePassTerrainTechnique)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SinglePassTerrainTechnique::META_Object </td>
          <td>(</td>
          <td class="paramtype">osgEarth&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSinglePassTerrainTechnique.html">SinglePassTerrainTechnique</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aaff3bb19a4bf4cfc19060c3c26053fb9"></a><!-- doxytag: member="SinglePassTerrainTechnique::prepareImageLayerUpdate" ref="aaff3bb19a4bf4cfc19060c3c26053fb9" args="(int layerIndex, const TileFrame &amp;tilef)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SinglePassTerrainTechnique::prepareImageLayerUpdate </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>layerIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTileFrame.html">TileFrame</a> &amp;&#160;</td>
          <td class="paramname"><em>tilef</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_8cpp_source.html#l00382">382</a> of file <a class="el" href="SinglePassTerrainTechnique_8cpp_source.html">SinglePassTerrainTechnique.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="classCustomColorLayer.html">CustomColorLayer</a> layer;
    <span class="keywordflow">if</span> ( tilef.<a class="code" href="classTileFrame.html#aa64f473bf7c23057885cb44209238ea2">getCustomColorLayer</a>( layerUID, layer ) )
    {
        <a class="code" href="classosgEarth_1_1GeoImage.html">GeoImage</a> geoImage, secondaryImage;

        <span class="keywordflow">if</span> ( <a class="code" href="classSinglePassTerrainTechnique.html#aaf6c1a4c000dbcefc89a2c1b795dc26f">createGeoImage</a>( layer, geoImage ) )
        {
            ImageLayerUpdate update;
            
            update.<a class="code" href="classosgEarth_1_1GeoImage.html#aa70fb92101c2b2899b665fdc1616fff6">_image</a> = <a class="code" href="classSinglePassTerrainTechnique.html#ac52309b549b7b332c14e81241ce25e3a">_texCompositor</a>-&gt;prepareImage( geoImage, <a class="code" href="classSinglePassTerrainTechnique.html#ac3cd7043773f87b27a031fdf30cd6ca6">_tileExtent</a> );
            update._layerUID = layerUID;
            update._isRealData = !layer.<a class="code" href="classCustomColorLayer.html#abf341a630a68be118bfe8ab562b6eb78">isFallbackData</a>();

            <span class="keywordflow">if</span> ( update._image.valid() )
                <a class="code" href="classSinglePassTerrainTechnique.html#a440f50a57de0f1d872deb42ba35edc76">_pendingImageLayerUpdates</a>.push( update );
        }

    }
}
</pre></div>
<p><div id="dynsection-20" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-20-trigger" src="closed.png"/> Here is the call graph for this function:</div>
<div id="dynsection-20-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-20-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classSinglePassTerrainTechnique_aaff3bb19a4bf4cfc19060c3c26053fb9_cgraph.png" border="0" usemap="#classSinglePassTerrainTechnique_aaff3bb19a4bf4cfc19060c3c26053fb9_cgraph" alt=""/></div>
<map name="classSinglePassTerrainTechnique_aaff3bb19a4bf4cfc19060c3c26053fb9_cgraph" id="classSinglePassTerrainTechnique_aaff3bb19a4bf4cfc19060c3c26053fb9_cgraph">
<area shape="rect" id="node3" href="classSinglePassTerrainTechnique.html#aaf6c1a4c000dbcefc89a2c1b795dc26f" title="SinglePassTerrainTechnique::createGeoImage" alt="" coords="404,112,695,141"/><area shape="rect" id="node17" href="classTileFrame.html#aa64f473bf7c23057885cb44209238ea2" title="TileFrame::getCustomColorLayer" alt="" coords="443,165,656,195"/><area shape="rect" id="node19" href="classCustomColorLayer.html#abf341a630a68be118bfe8ab562b6eb78" title="CustomColorLayer::isFallbackData" alt="" coords="436,219,663,248"/><area shape="rect" id="node21" href="classosgEarth_1_1GeoImage.html#a40db87ae60b4dde189b1f218ff3c8777" title="osgEarth::GeoImage::valid" alt="" coords="461,272,637,301"/><area shape="rect" id="node5" href="classosgEarth_1_1GeoLocator.html#a125f2bd702f4a911c65c6fe9334c640a" title="osgEarth::GeoLocator::getGeographicFromGeocentric" alt="" coords="745,59,1079,88"/><area shape="rect" id="node13" href="classCustomColorLayer.html#a761fdfb07388be6ac6438c2b96c7639d" title="CustomColorLayer::getImage" alt="" coords="816,112,1008,141"/><area shape="rect" id="node15" href="classCustomColorLayer.html#ac9725adc85c194c7b4a4c99ed26d3d52" title="CustomColorLayer::getLocator" alt="" coords="812,165,1012,195"/><area shape="rect" id="node7" href="classosgEarth_1_1GeoLocator.html#a3d6d7da71a8187c45110890a550b5655" title="osgEarth::GeoLocator::GeoLocator" alt="" coords="1137,5,1361,35"/><area shape="rect" id="node9" href="classosgEarth_1_1GeoExtent.html#afa0bd831daf0541cbbb161763ed9291f" title="osgEarth::GeoExtent::getBounds" alt="" coords="1143,59,1356,88"/><area shape="rect" id="node11" href="classosgEarth_1_1GeoLocator.html#a0ed2730a383c6a42c1df8bb6b07fc6df" title="osgEarth::GeoLocator::getDataExtent" alt="" coords="1129,112,1369,141"/></map>
</div>
</p>

<p><div id="dynsection-21" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-21-trigger" src="closed.png"/> Here is the caller graph for this function:</div>
<div id="dynsection-21-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-21-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classSinglePassTerrainTechnique_aaff3bb19a4bf4cfc19060c3c26053fb9_icgraph.png" border="0" usemap="#classSinglePassTerrainTechnique_aaff3bb19a4bf4cfc19060c3c26053fb9_icgraph" alt=""/></div>
<map name="classSinglePassTerrainTechnique_aaff3bb19a4bf4cfc19060c3c26053fb9_icgraph" id="classSinglePassTerrainTechnique_aaff3bb19a4bf4cfc19060c3c26053fb9_icgraph">
<area shape="rect" id="node3" href="classSinglePassTerrainTechnique.html#a38db1d0b19580a4db1b8b29fa245702c" title="SinglePassTerrainTechnique::compile" alt="" coords="404,5,644,35"/><area shape="rect" id="node5" href="classSinglePassTerrainTechnique.html#aad7ee72f83efd718654a798045f8a41c" title="SinglePassTerrainTechnique::init" alt="" coords="693,5,907,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a59f217ea27238586b91f6f3a3b414cdc"></a><!-- doxytag: member="SinglePassTerrainTechnique::releaseGLObjects" ref="a59f217ea27238586b91f6f3a3b414cdc" args="(osg::State *=0) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SinglePassTerrainTechnique::releaseGLObjects </td>
          <td>(</td>
          <td class="paramtype">osg::State *&#160;</td>
          <td class="paramname"><em>state</em> = <code>0</code></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>If State is non-zero, this function releases any associated OpenGL objects for the specified graphics context. Otherwise, releases OpenGL objects for all graphics contexts. </p>

<p>Implements <a class="el" href="classTerrainTechnique.html#a70a7b972d036ee518bcbb6bb83047b26">TerrainTechnique</a>.</p>

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_8cpp_source.html#l01743">1743</a> of file <a class="el" href="SinglePassTerrainTechnique_8cpp_source.html">SinglePassTerrainTechnique.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="classSinglePassTerrainTechnique.html">SinglePassTerrainTechnique</a>* ncThis = <span class="keyword">const_cast&lt;</span><a class="code" href="classSinglePassTerrainTechnique.html">SinglePassTerrainTechnique</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);

    <a class="code" href="structosgEarth_1_1Threading_1_1ScopedWriteLock.html">Threading::ScopedWriteLock</a> lock( static_cast&lt;Tile*&gt;(ncThis-&gt;<a class="code" href="classTerrainTechnique.html#acfc47d91458541b74f3b60a7eede69a3">_tile</a>)-&gt;getTileLayersMutex() );

    <span class="keywordflow">if</span> ( <a class="code" href="classSinglePassTerrainTechnique.html#ab4f26ad5ef62bd9f8c1785c2edd7a4cc">_transform</a>.valid() )
    {
        <a class="code" href="classSinglePassTerrainTechnique.html#ab4f26ad5ef62bd9f8c1785c2edd7a4cc">_transform</a>-&gt;releaseGLObjects( state );
    }

    <span class="keywordflow">if</span> ( <a class="code" href="classSinglePassTerrainTechnique.html#a4d520a524293b3fa797e22f5de77813f">_backGeode</a>.valid() )
    {
        <a class="code" href="classSinglePassTerrainTechnique.html#a4d520a524293b3fa797e22f5de77813f">_backGeode</a>-&gt;releaseGLObjects(state);
        ncThis-&gt;<a class="code" href="classSinglePassTerrainTechnique.html#a4d520a524293b3fa797e22f5de77813f">_backGeode</a> = 0L;
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a3b5874efacff9ce3c09e55b0a7939e87"></a><!-- doxytag: member="SinglePassTerrainTechnique::setOptimizeTriangleOrientation" ref="a3b5874efacff9ce3c09e55b0a7939e87" args="(bool optimizeTriangleOrientation)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SinglePassTerrainTechnique::setOptimizeTriangleOrientation </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>optimizeTriangleOrientation</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Sets whether to try to optimize the triangle orientation based on the elevation values. If false, </p>

<p>Implements <a class="el" href="classCustomTerrainTechnique.html#a397f7b301607fa948ac4fb9832b7cf5e">CustomTerrainTechnique</a>.</p>

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_8cpp_source.html#l00115">115</a> of file <a class="el" href="SinglePassTerrainTechnique_8cpp_source.html">SinglePassTerrainTechnique.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="classSinglePassTerrainTechnique.html#a78a25d3a07259ff92e9025eff8b8c027">_optimizeTriangleOrientation</a> = optimizeTriangleOrientation;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a103e83251de3710de67e810952f24747"></a><!-- doxytag: member="SinglePassTerrainTechnique::setParentTile" ref="a103e83251de3710de67e810952f24747" args="(Tile *tile)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SinglePassTerrainTechnique::setParentTile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTile.html">Tile</a> *&#160;</td>
          <td class="paramname"><em>tile</em></td><td>)</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implements <a class="el" href="classCustomTerrainTechnique.html#a45388c70257008e2b80806d23686ef99">CustomTerrainTechnique</a>.</p>

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_source.html#l00084">84</a> of file <a class="el" href="SinglePassTerrainTechnique_source.html">SinglePassTerrainTechnique</a>.</p>
<div class="fragment"><pre class="fragment">{ <a class="code" href="classSinglePassTerrainTechnique.html#a2eebc195c0ab7234ffd6c06370b022a8">_parentTile</a> = tile; }
</pre></div>
</div>
</div>
<a class="anchor" id="ab01bff854cb10e8649f72fe6b77f011b"></a><!-- doxytag: member="SinglePassTerrainTechnique::setVerticalScaleOverride" ref="ab01bff854cb10e8649f72fe6b77f011b" args="(float value)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SinglePassTerrainTechnique::setVerticalScaleOverride </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>value</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Sets a factor by which to scale elevation height values. By default, this object will get the vertical scale from the osgTerrain::Terrain with which the tile is associated. Setting this value overrides that (or sets it if there is no terrain). </p>

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_8cpp_source.html#l00103">103</a> of file <a class="el" href="SinglePassTerrainTechnique_8cpp_source.html">SinglePassTerrainTechnique.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="classSinglePassTerrainTechnique.html#ab3ba452d350fb8303ae315ec2e17d34e">_verticalScaleOverride</a> = value;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac7a0d617084eff87f0075e5e0547e2e7"></a><!-- doxytag: member="SinglePassTerrainTechnique::traverse" ref="ac7a0d617084eff87f0075e5e0547e2e7" args="(osg::NodeVisitor &amp;nv)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SinglePassTerrainTechnique::traverse </td>
          <td>(</td>
          <td class="paramtype">osg::NodeVisitor &amp;&#160;</td>
          <td class="paramname"><em>nv</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Traverse the terrain subgraph. </p>

<p>Implements <a class="el" href="classTerrainTechnique.html#a5735bb67b4765a485a1fb91de99de291">TerrainTechnique</a>.</p>

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_8cpp_source.html#l01731">1731</a> of file <a class="el" href="SinglePassTerrainTechnique_8cpp_source.html">SinglePassTerrainTechnique.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> ( !<a class="code" href="classTerrainTechnique.html#acfc47d91458541b74f3b60a7eede69a3">_tile</a> )
        <span class="keywordflow">return</span>;

    <span class="keywordflow">if</span> ( <a class="code" href="classSinglePassTerrainTechnique.html#ab4f26ad5ef62bd9f8c1785c2edd7a4cc">_transform</a>.valid() )
    {
        <a class="code" href="classSinglePassTerrainTechnique.html#ab4f26ad5ef62bd9f8c1785c2edd7a4cc">_transform</a>-&gt;accept( nv );
    }
}
</pre></div>
</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a4d520a524293b3fa797e22f5de77813f"></a><!-- doxytag: member="SinglePassTerrainTechnique::_backGeode" ref="a4d520a524293b3fa797e22f5de77813f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">osg::ref_ptr&lt;osg::Geode&gt; <a class="el" href="classSinglePassTerrainTechnique.html#a4d520a524293b3fa797e22f5de77813f">SinglePassTerrainTechnique::_backGeode</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_source.html#l00135">135</a> of file <a class="el" href="SinglePassTerrainTechnique_source.html">SinglePassTerrainTechnique</a>.</p>

</div>
</div>
<a class="anchor" id="a31e8cf34154ced3efa730fd531cf6e14"></a><!-- doxytag: member="SinglePassTerrainTechnique::_centerModel" ref="a31e8cf34154ced3efa730fd531cf6e14" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">osg::Vec3d <a class="el" href="classSinglePassTerrainTechnique.html#a31e8cf34154ced3efa730fd531cf6e14">SinglePassTerrainTechnique::_centerModel</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_source.html#l00137">137</a> of file <a class="el" href="SinglePassTerrainTechnique_source.html">SinglePassTerrainTechnique</a>.</p>

</div>
</div>
<a class="anchor" id="ad1bc9e9de18135eeeba07976e83ad857"></a><!-- doxytag: member="SinglePassTerrainTechnique::_compileMutex" ref="ad1bc9e9de18135eeeba07976e83ad857" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OpenThreads::Mutex <a class="el" href="classSinglePassTerrainTechnique.html#ad1bc9e9de18135eeeba07976e83ad857">SinglePassTerrainTechnique::_compileMutex</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_source.html#l00132">132</a> of file <a class="el" href="SinglePassTerrainTechnique_source.html">SinglePassTerrainTechnique</a>.</p>

</div>
</div>
<a class="anchor" id="ad638242ef259e6af7c7fffc5dc7b0fb0"></a><!-- doxytag: member="SinglePassTerrainTechnique::_debug" ref="ad638242ef259e6af7c7fffc5dc7b0fb0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classSinglePassTerrainTechnique.html#ad638242ef259e6af7c7fffc5dc7b0fb0">SinglePassTerrainTechnique::_debug</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_source.html#l00130">130</a> of file <a class="el" href="SinglePassTerrainTechnique_source.html">SinglePassTerrainTechnique</a>.</p>

</div>
</div>
<a class="anchor" id="ab174678a8e8cdfe40e12b03b64812960"></a><!-- doxytag: member="SinglePassTerrainTechnique::_frontGeodeInstalled" ref="ab174678a8e8cdfe40e12b03b64812960" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classSinglePassTerrainTechnique.html#ab174678a8e8cdfe40e12b03b64812960">SinglePassTerrainTechnique::_frontGeodeInstalled</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_source.html#l00164">164</a> of file <a class="el" href="SinglePassTerrainTechnique_source.html">SinglePassTerrainTechnique</a>.</p>

</div>
</div>
<a class="anchor" id="ab50572dc24e8bd208905f08a682386dd"></a><!-- doxytag: member="SinglePassTerrainTechnique::_imageLayerStampUniform" ref="ab50572dc24e8bd208905f08a682386dd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">osg::ref_ptr&lt;osg::Uniform&gt; <a class="el" href="classSinglePassTerrainTechnique.html#ab50572dc24e8bd208905f08a682386dd">SinglePassTerrainTechnique::_imageLayerStampUniform</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_source.html#l00136">136</a> of file <a class="el" href="SinglePassTerrainTechnique_source.html">SinglePassTerrainTechnique</a>.</p>

</div>
</div>
<a class="anchor" id="a5cd17d084ce423ce9092a48201bdffc4"></a><!-- doxytag: member="SinglePassTerrainTechnique::_initCount" ref="a5cd17d084ce423ce9092a48201bdffc4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classSinglePassTerrainTechnique.html#a5cd17d084ce423ce9092a48201bdffc4">SinglePassTerrainTechnique::_initCount</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_source.html#l00141">141</a> of file <a class="el" href="SinglePassTerrainTechnique_source.html">SinglePassTerrainTechnique</a>.</p>

</div>
</div>
<a class="anchor" id="adc4866954df72c2d5d0a6048f77e9687"></a><!-- doxytag: member="SinglePassTerrainTechnique::_layerUIDtoIndexMap" ref="adc4866954df72c2d5d0a6048f77e9687" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSinglePassTerrainTechnique.html#a4ca8ab62c29ab0d43d8cfe604c724282">LayerUIDtoIndexMap</a> <a class="el" href="classSinglePassTerrainTechnique.html#adc4866954df72c2d5d0a6048f77e9687">SinglePassTerrainTechnique::_layerUIDtoIndexMap</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_source.html#l00155">155</a> of file <a class="el" href="SinglePassTerrainTechnique_source.html">SinglePassTerrainTechnique</a>.</p>

</div>
</div>
<a class="anchor" id="a91405d8a9044d1c224d46f4b6017dfad"></a><!-- doxytag: member="SinglePassTerrainTechnique::_masterLocator" ref="a91405d8a9044d1c224d46f4b6017dfad" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">osg::ref_ptr&lt;<a class="el" href="classosgEarth_1_1GeoLocator.html">GeoLocator</a>&gt; <a class="el" href="classSinglePassTerrainTechnique.html#a91405d8a9044d1c224d46f4b6017dfad">SinglePassTerrainTechnique::_masterLocator</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_source.html#l00139">139</a> of file <a class="el" href="SinglePassTerrainTechnique_source.html">SinglePassTerrainTechnique</a>.</p>

</div>
</div>
<a class="anchor" id="a78a25d3a07259ff92e9025eff8b8c027"></a><!-- doxytag: member="SinglePassTerrainTechnique::_optimizeTriangleOrientation" ref="a78a25d3a07259ff92e9025eff8b8c027" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classSinglePassTerrainTechnique.html#a78a25d3a07259ff92e9025eff8b8c027">SinglePassTerrainTechnique::_optimizeTriangleOrientation</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_source.html#l00161">161</a> of file <a class="el" href="SinglePassTerrainTechnique_source.html">SinglePassTerrainTechnique</a>.</p>

</div>
</div>
<a class="anchor" id="a2eebc195c0ab7234ffd6c06370b022a8"></a><!-- doxytag: member="SinglePassTerrainTechnique::_parentTile" ref="a2eebc195c0ab7234ffd6c06370b022a8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">osg::observer_ptr&lt;<a class="el" href="classTile.html">Tile</a>&gt; <a class="el" href="classSinglePassTerrainTechnique.html#a2eebc195c0ab7234ffd6c06370b022a8">SinglePassTerrainTechnique::_parentTile</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_source.html#l00184">184</a> of file <a class="el" href="SinglePassTerrainTechnique_source.html">SinglePassTerrainTechnique</a>.</p>

</div>
</div>
<a class="anchor" id="a4c9a8639abfe2435828ce9c53492ce32"></a><!-- doxytag: member="SinglePassTerrainTechnique::_pendingFullUpdate" ref="a4c9a8639abfe2435828ce9c53492ce32" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classSinglePassTerrainTechnique.html#a4c9a8639abfe2435828ce9c53492ce32">SinglePassTerrainTechnique::_pendingFullUpdate</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_source.html#l00142">142</a> of file <a class="el" href="SinglePassTerrainTechnique_source.html">SinglePassTerrainTechnique</a>.</p>

</div>
</div>
<a class="anchor" id="a8d28aa7d2f1729d355b76c480c337032"></a><!-- doxytag: member="SinglePassTerrainTechnique::_pendingGeometryUpdate" ref="a8d28aa7d2f1729d355b76c480c337032" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classSinglePassTerrainTechnique.html#a8d28aa7d2f1729d355b76c480c337032">SinglePassTerrainTechnique::_pendingGeometryUpdate</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_source.html#l00143">143</a> of file <a class="el" href="SinglePassTerrainTechnique_source.html">SinglePassTerrainTechnique</a>.</p>

</div>
</div>
<a class="anchor" id="a440f50a57de0f1d872deb42ba35edc76"></a><!-- doxytag: member="SinglePassTerrainTechnique::_pendingImageLayerUpdates" ref="a440f50a57de0f1d872deb42ba35edc76" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSinglePassTerrainTechnique.html#a21bd8ad402466a8078a45a5fe572cdb1">ImageLayerUpdates</a> <a class="el" href="classSinglePassTerrainTechnique.html#a440f50a57de0f1d872deb42ba35edc76">SinglePassTerrainTechnique::_pendingImageLayerUpdates</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_source.html#l00151">151</a> of file <a class="el" href="SinglePassTerrainTechnique_source.html">SinglePassTerrainTechnique</a>.</p>

</div>
</div>
<a class="anchor" id="ac52309b549b7b332c14e81241ce25e3a"></a><!-- doxytag: member="SinglePassTerrainTechnique::_texCompositor" ref="ac52309b549b7b332c14e81241ce25e3a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">osg::ref_ptr&lt;const <a class="el" href="classosgEarth_1_1TextureCompositor.html">TextureCompositor</a>&gt; <a class="el" href="classSinglePassTerrainTechnique.html#ac52309b549b7b332c14e81241ce25e3a">SinglePassTerrainTechnique::_texCompositor</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_source.html#l00163">163</a> of file <a class="el" href="SinglePassTerrainTechnique_source.html">SinglePassTerrainTechnique</a>.</p>

</div>
</div>
<a class="anchor" id="ac3cd7043773f87b27a031fdf30cd6ca6"></a><!-- doxytag: member="SinglePassTerrainTechnique::_tileExtent" ref="ac3cd7043773f87b27a031fdf30cd6ca6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classosgEarth_1_1GeoExtent.html">GeoExtent</a> <a class="el" href="classSinglePassTerrainTechnique.html#ac3cd7043773f87b27a031fdf30cd6ca6">SinglePassTerrainTechnique::_tileExtent</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_source.html#l00158">158</a> of file <a class="el" href="SinglePassTerrainTechnique_source.html">SinglePassTerrainTechnique</a>.</p>

</div>
</div>
<a class="anchor" id="a2a1afb3a9679e9c57102e343d9d23ec7"></a><!-- doxytag: member="SinglePassTerrainTechnique::_tileKey" ref="a2a1afb3a9679e9c57102e343d9d23ec7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classosgEarth_1_1TileKey.html">TileKey</a> <a class="el" href="classSinglePassTerrainTechnique.html#a2a1afb3a9679e9c57102e343d9d23ec7">SinglePassTerrainTechnique::_tileKey</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_source.html#l00159">159</a> of file <a class="el" href="SinglePassTerrainTechnique_source.html">SinglePassTerrainTechnique</a>.</p>

</div>
</div>
<a class="anchor" id="ab4f26ad5ef62bd9f8c1785c2edd7a4cc"></a><!-- doxytag: member="SinglePassTerrainTechnique::_transform" ref="ab4f26ad5ef62bd9f8c1785c2edd7a4cc" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">osg::ref_ptr&lt;osg::MatrixTransform&gt; <a class="el" href="classSinglePassTerrainTechnique.html#ab4f26ad5ef62bd9f8c1785c2edd7a4cc">SinglePassTerrainTechnique::_transform</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_source.html#l00134">134</a> of file <a class="el" href="SinglePassTerrainTechnique_source.html">SinglePassTerrainTechnique</a>.</p>

</div>
</div>
<a class="anchor" id="ab3ba452d350fb8303ae315ec2e17d34e"></a><!-- doxytag: member="SinglePassTerrainTechnique::_verticalScaleOverride" ref="ab3ba452d350fb8303ae315ec2e17d34e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float <a class="el" href="classSinglePassTerrainTechnique.html#ab3ba452d350fb8303ae315ec2e17d34e">SinglePassTerrainTechnique::_verticalScaleOverride</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="SinglePassTerrainTechnique_source.html#l00138">138</a> of file <a class="el" href="SinglePassTerrainTechnique_source.html">SinglePassTerrainTechnique</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/cube/sources/osgearth/src/osgEarthDrivers/engine_osgterrain/<a class="el" href="SinglePassTerrainTechnique_source.html">SinglePassTerrainTechnique</a></li>
<li>/home/cube/sources/osgearth/src/osgEarthDrivers/engine_osgterrain/<a class="el" href="SinglePassTerrainTechnique_8cpp_source.html">SinglePassTerrainTechnique.cpp</a></li>
</ul>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Wed Jan 18 2012 15:02:46 for osgEarth by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
