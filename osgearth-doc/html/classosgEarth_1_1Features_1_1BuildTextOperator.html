<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>osgEarth: osgEarth::Features::BuildTextOperator Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = 'open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = 'closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">osgEarth&#160;<span id="projectnumber">2.1.1</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="namespaceosgEarth.html">osgEarth</a>      </li>
      <li class="navelem"><a class="el" href="namespaceosgEarth_1_1Features.html">Features</a>      </li>
      <li class="navelem"><a class="el" href="classosgEarth_1_1Features_1_1BuildTextOperator.html">BuildTextOperator</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a>  </div>
  <div class="headertitle">
<h1>osgEarth::Features::BuildTextOperator Class Reference</h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="osgEarth::Features::BuildTextOperator" -->
<p><a href="classosgEarth_1_1Features_1_1BuildTextOperator-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classosgEarth_1_1Features_1_1BuildTextOperator.html#a07037297195cb6a7239742d4f480684b">BuildTextOperator</a> (bool hideClutter=false)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">osg::Node *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classosgEarth_1_1Features_1_1BuildTextOperator.html#aa6e12cb28a335505aee7c07598e5e847">operator()</a> (const <a class="el" href="namespaceosgEarth_1_1Features.html#a1e64d25cc48ef96694c4325b5c31f28b">FeatureList</a> &amp;features, const <a class="el" href="classosgEarth_1_1Symbology_1_1TextSymbol.html">osgEarth::Symbology::TextSymbol</a> *symbol, const <a class="el" href="classosgEarth_1_1Features_1_1FilterContext.html">FilterContext</a> &amp;context)</td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classosgEarth_1_1Features_1_1BuildTextOperator.html#ae0bb62311f08eadf2915e042ab1ab741">_hideClutter</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Creates a text node that labels feature data. </p>

<p>Definition at line <a class="el" href="BuildTextOperator_source.html#l00034">34</a> of file <a class="el" href="BuildTextOperator_source.html">BuildTextOperator</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a07037297195cb6a7239742d4f480684b"></a><!-- doxytag: member="osgEarth::Features::BuildTextOperator::BuildTextOperator" ref="a07037297195cb6a7239742d4f480684b" args="(bool hideClutter=false)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">osgEarth::Features::BuildTextOperator::BuildTextOperator </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>hideClutter</em> = <code>false</code></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="BuildTextOperator_source.html#l00037">37</a> of file <a class="el" href="BuildTextOperator_source.html">BuildTextOperator</a>.</p>
<div class="fragment"><pre class="fragment">: <a class="code" href="classosgEarth_1_1Features_1_1BuildTextOperator.html#ae0bb62311f08eadf2915e042ab1ab741">_hideClutter</a>(hideClutter) { };
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="aa6e12cb28a335505aee7c07598e5e847"></a><!-- doxytag: member="osgEarth::Features::BuildTextOperator::operator()" ref="aa6e12cb28a335505aee7c07598e5e847" args="(const FeatureList &amp;features, const osgEarth::Symbology::TextSymbol *symbol, const FilterContext &amp;context)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">osg::Node * BuildTextOperator::operator() </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceosgEarth_1_1Features.html#a1e64d25cc48ef96694c4325b5c31f28b">FeatureList</a> &amp;&#160;</td>
          <td class="paramname"><em>features</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classosgEarth_1_1Symbology_1_1TextSymbol.html">osgEarth::Symbology::TextSymbol</a> *&#160;</td>
          <td class="paramname"><em>symbol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classosgEarth_1_1Features_1_1FilterContext.html">FilterContext</a> &amp;&#160;</td>
          <td class="paramname"><em>context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="BuildTextOperator_8cpp_source.html#l00081">81</a> of file <a class="el" href="BuildTextOperator_8cpp_source.html">BuildTextOperator.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (!symbol) <span class="keywordflow">return</span> 0;

    std::set&lt; std::string &gt; labelNames;

    <span class="keywordtype">bool</span> removeDuplicateLabels = symbol-&gt;<a class="code" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#a2ebaddf98769da5c384657b9f982e152">removeDuplicateLabels</a>().<a class="code" href="structosgEarth_1_1optional.html#aa094207bf2b22a4848989cd017dc4365">isSet</a>() ? symbol-&gt;<a class="code" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#a2ebaddf98769da5c384657b9f982e152">removeDuplicateLabels</a>().<a class="code" href="structosgEarth_1_1optional.html#ac10ed828e5fb151d8cabf856e1fc3d3e">get</a>() : <span class="keyword">false</span>;

    <a class="code" href="classosgEarth_1_1Symbology_1_1StringExpression.html">StringExpression</a> contentExpr = *symbol-&gt;<a class="code" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#af4dc10f833fbccf33f138ae9d9ee4ac3">content</a>();

    osg::Geode* result = <span class="keyword">new</span> osg::Geode;
    <span class="keywordflow">for</span> (FeatureList::const_iterator itr = features.begin(); itr != features.end(); ++itr)
    {
        <a class="code" href="classosgEarth_1_1Features_1_1Feature.html">Feature</a>* feature = itr-&gt;get();
        <span class="keywordflow">if</span> (!feature-&gt;<a class="code" href="classosgEarth_1_1Features_1_1Feature.html#a2027c4708491dc48da4091b0ab7e8c57">getGeometry</a>()) <span class="keywordflow">continue</span>;

        std::string text;
        <span class="keywordflow">if</span> (symbol-&gt;<a class="code" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#af4dc10f833fbccf33f138ae9d9ee4ac3">content</a>().<a class="code" href="structosgEarth_1_1optional.html#aa094207bf2b22a4848989cd017dc4365">isSet</a>())
        {
            <span class="comment">//Get the text from the specified content and referenced attributes</span>
            text = feature-&gt;<a class="code" href="classosgEarth_1_1Features_1_1Feature.html#a7e45df02c1660959d070d7f4603d4dcd">eval</a>( contentExpr );
        }

        <span class="keywordflow">if</span> (text.empty()) <span class="keywordflow">continue</span>;

        <span class="comment">//See if there is a duplicate name</span>
        <span class="keywordflow">if</span> (removeDuplicateLabels &amp;&amp; labelNames.find(text) != labelNames.end()) <span class="keywordflow">continue</span>;

        <span class="keywordtype">bool</span> rotateToScreen = symbol-&gt;<a class="code" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#a09d72da7c5ddb48bec7f5419ff7d898d">rotateToScreen</a>().<a class="code" href="structosgEarth_1_1optional.html#aa094207bf2b22a4848989cd017dc4365">isSet</a>() ? symbol-&gt;<a class="code" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#a09d72da7c5ddb48bec7f5419ff7d898d">rotateToScreen</a>().<a class="code" href="structosgEarth_1_1optional.html#a9e71f677728602dc521d7102c9be7820">value</a>() : <span class="keyword">false</span>;

        <span class="comment">// find the centroid</span>
        osg::Vec3d position;
        osg::Quat orientation;

        <a class="code" href="classosgEarth_1_1Symbology_1_1GeometryIterator.html">GeometryIterator</a> gi( feature-&gt;<a class="code" href="classosgEarth_1_1Features_1_1Feature.html#a2027c4708491dc48da4091b0ab7e8c57">getGeometry</a>() );
        <span class="keywordflow">while</span>( gi.hasMore() )
        {
            <a class="code" href="classosgEarth_1_1Symbology_1_1Geometry.html">Geometry</a>* geom = gi.next();

            <a class="code" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#a331e3f98df658523428db87f46e3fd1b">TextSymbol::LinePlacement</a> linePlacement = symbol-&gt;<a class="code" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#a31b00e981203367ea406df231ab456e7">linePlacement</a>().<a class="code" href="structosgEarth_1_1optional.html#aa094207bf2b22a4848989cd017dc4365">isSet</a>() ? symbol-&gt;<a class="code" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#a31b00e981203367ea406df231ab456e7">linePlacement</a>().<a class="code" href="structosgEarth_1_1optional.html#ac10ed828e5fb151d8cabf856e1fc3d3e">get</a>() : <a class="code" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#a331e3f98df658523428db87f46e3fd1baecb5e1f28f89ea2e56395546b3c51e9e">TextSymbol::LINEPLACEMENT_ALONG_LINE</a>;
            <span class="keywordflow">if</span> (geom-&gt;<a class="code" href="classosgEarth_1_1Symbology_1_1Geometry.html#a12044f75418af11e87a616a78967e5b1">getType</a>() == <a class="code" href="classosgEarth_1_1Symbology_1_1Geometry.html#a6d54f55f7817f9aa25aee616dd82c1e0a6f015d5a167d4ee27f5bd8a5c2053ce8">Symbology::Geometry::TYPE_LINESTRING</a> &amp;&amp; linePlacement == <a class="code" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#a331e3f98df658523428db87f46e3fd1baecb5e1f28f89ea2e56395546b3c51e9e">TextSymbol::LINEPLACEMENT_ALONG_LINE</a>)
            {
                <span class="comment">//Compute the &quot;middle&quot; of the line string</span>
                <a class="code" href="classosgEarth_1_1Symbology_1_1LineString.html">LineString</a>* lineString = <span class="keyword">static_cast&lt;</span><a class="code" href="classosgEarth_1_1Symbology_1_1LineString.html">LineString</a>*<span class="keyword">&gt;</span>(geom);
                <span class="keywordtype">double</span> length = lineString-&gt;<a class="code" href="classosgEarth_1_1Symbology_1_1LineString.html#a9b5b6e9b331071d46fbf1a76eca84c7b">getLength</a>();
                <span class="keywordtype">double</span> center = length / 2.0;
                osg::Vec3d start, end;
                <span class="keywordflow">if</span> (lineString-&gt;<a class="code" href="classosgEarth_1_1Symbology_1_1LineString.html#a15aaca980d8f483426582978d9c41561">getSegment</a>(center, start, end))
                {
                    <a class="code" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#aaf4650788090cc2f3a29d1671ea6d14e">TextSymbol::LineOrientation</a> lineOrientation = symbol-&gt;<a class="code" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#a2ee8bcca128aeb50d4d648411cfa8764">lineOrientation</a>().<a class="code" href="structosgEarth_1_1optional.html#aa094207bf2b22a4848989cd017dc4365">isSet</a>() ? symbol-&gt;<a class="code" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#a2ee8bcca128aeb50d4d648411cfa8764">lineOrientation</a>().<a class="code" href="structosgEarth_1_1optional.html#ac10ed828e5fb151d8cabf856e1fc3d3e">get</a>() : <a class="code" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#aaf4650788090cc2f3a29d1671ea6d14ea6dd09303df5cab42091af29ed0cd9bfe">TextSymbol::LINEORIENTATION_HORIZONTAL</a>;

                    position = (end + start) / 2.0;
                    <span class="comment">//We don&#39;t want to orient the text at all if we are rotating to the screen</span>
                    <span class="keywordflow">if</span> (!rotateToScreen &amp;&amp; lineOrientation != <a class="code" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#aaf4650788090cc2f3a29d1671ea6d14ea6dd09303df5cab42091af29ed0cd9bfe">TextSymbol::LINEORIENTATION_HORIZONTAL</a>)
                    {
                        osg::Vec3d dir = (end-start);
                        dir.normalize();

                        <span class="keywordflow">if</span> (lineOrientation == <a class="code" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#aaf4650788090cc2f3a29d1671ea6d14ea78dff7d500a7ac623b1c9776fee3ddf1">TextSymbol::LINEORIENTATION_PERPENDICULAR</a>)
                        {
                            osg::Vec3d up(0,0,1);
                            <span class="keyword">const</span> <a class="code" href="classosgEarth_1_1SpatialReference.html">SpatialReference</a>* srs = context.<a class="code" href="classosgEarth_1_1Features_1_1FilterContext.html#a6fdc74d6944a655fd8fe8e5ff298af57">profile</a>()-&gt;<a class="code" href="classosgEarth_1_1Features_1_1FeatureProfile.html#a7f2cf88a25569de112c7c929555e3943">getSRS</a>();
                            <span class="keywordflow">if</span> (srs &amp;&amp; context.<a class="code" href="classosgEarth_1_1Features_1_1FilterContext.html#acf61fdd826797b4b08c2cc074accd0fa">isGeocentric</a>() &amp;&amp; srs-&gt;<a class="code" href="classosgEarth_1_1SpatialReference.html#ad7d6ef0605664b77e8348df5324ea32f">getEllipsoid</a>())
                            {
                                osg::Vec3d w = context.<a class="code" href="classosgEarth_1_1Features_1_1FilterContext.html#a62aa3e76a35b38551d293e4660bb7559">toWorld</a>( position );
                                up = srs-&gt;<a class="code" href="classosgEarth_1_1SpatialReference.html#ad7d6ef0605664b77e8348df5324ea32f">getEllipsoid</a>()-&gt;computeLocalUpVector(w.x(), w.y(), w.z());
                            }
                            dir = up ^ dir;
                        }
                        orientation.makeRotate(osg::Vec3d(1,0,0), dir);
                    }                
                }
                <span class="keywordflow">else</span>
                {
                    <span class="comment">//Fall back on using the center</span>
                    position = lineString-&gt;<a class="code" href="classosgEarth_1_1Symbology_1_1Geometry.html#ae7e387b3f435029c00799c969ed6b390">getBounds</a>().center();
                }
            }
            <span class="keywordflow">else</span>
            {
                position = geom-&gt;<a class="code" href="classosgEarth_1_1Symbology_1_1Geometry.html#ae7e387b3f435029c00799c969ed6b390">getBounds</a>().center();
            }
        }

        osgText::Text* t = <span class="keyword">new</span> osgText::Text();
        t-&gt;setText( text );

        std::string font = <span class="stringliteral">&quot;fonts/arial.ttf&quot;</span>;
        <span class="keywordflow">if</span> (symbol-&gt;<a class="code" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#adb937da4c5ef13b013b7d7f86546a75d">font</a>().<a class="code" href="structosgEarth_1_1optional.html#aa094207bf2b22a4848989cd017dc4365">isSet</a>() &amp;&amp; !symbol-&gt;<a class="code" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#adb937da4c5ef13b013b7d7f86546a75d">font</a>().<a class="code" href="structosgEarth_1_1optional.html#ac10ed828e5fb151d8cabf856e1fc3d3e">get</a>().empty())
        {
            font = symbol-&gt;<a class="code" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#adb937da4c5ef13b013b7d7f86546a75d">font</a>().<a class="code" href="structosgEarth_1_1optional.html#a9e71f677728602dc521d7102c9be7820">value</a>();
        }

        t-&gt;setFont( font );
        t-&gt;setAutoRotateToScreen( rotateToScreen );

        <a class="code" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#aabc96da48c4a1d3c5844bac86bde854a">TextSymbol::SizeMode</a> sizeMode = symbol-&gt;<a class="code" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#a41fe2ca10e0be988838d9d7355be3f4d">sizeMode</a>().<a class="code" href="structosgEarth_1_1optional.html#aa094207bf2b22a4848989cd017dc4365">isSet</a>() ? symbol-&gt;<a class="code" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#a41fe2ca10e0be988838d9d7355be3f4d">sizeMode</a>().<a class="code" href="structosgEarth_1_1optional.html#ac10ed828e5fb151d8cabf856e1fc3d3e">get</a>() : <a class="code" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#aabc96da48c4a1d3c5844bac86bde854aa8e5ded48edf1eb73b2a2a37b3f1cf29a">TextSymbol::SIZEMODE_SCREEN</a>;
        <span class="keywordflow">if</span> (sizeMode == <a class="code" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#aabc96da48c4a1d3c5844bac86bde854aa8e5ded48edf1eb73b2a2a37b3f1cf29a">TextSymbol::SIZEMODE_SCREEN</a>) {
            t-&gt;setCharacterSizeMode( osgText::TextBase::SCREEN_COORDS );
        }
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sizeMode == <a class="code" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#aabc96da48c4a1d3c5844bac86bde854aa72ab29e3d9678d01d8b6aaad073e6b8e">TextSymbol::SIZEMODE_OBJECT</a>) {
            t-&gt;setCharacterSizeMode( osgText::TextBase::OBJECT_COORDS );
        }
        <span class="keywordtype">float</span> size = symbol-&gt;<a class="code" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#a3e7ab832c2c56a2094ffe5c97e89937f">size</a>().<a class="code" href="structosgEarth_1_1optional.html#aa094207bf2b22a4848989cd017dc4365">isSet</a>() ? symbol-&gt;<a class="code" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#a3e7ab832c2c56a2094ffe5c97e89937f">size</a>().<a class="code" href="structosgEarth_1_1optional.html#ac10ed828e5fb151d8cabf856e1fc3d3e">get</a>() : 32.0f;
        t-&gt;setCharacterSize( size );
        <span class="comment">/*</span>
<span class="comment">        //TODO:  We need to do something to account for autotransformed text that is under a LOD.  Setting the initial bound works sometimes but not all the time.</span>
<span class="comment">        if (rotateToScreen)</span>
<span class="comment">        {</span>
<span class="comment">        //Set the initial bound so that OSG will traverse the text even if it&#39;s under an LOD.</span>
<span class="comment">        osg::BoundingBox bb;</span>
<span class="comment">        bb.expandBy( osg::BoundingSphere(position, size));</span>
<span class="comment">        t-&gt;setInitialBound( bb);</span>
<span class="comment">        }*/</span>
        <span class="comment">//t-&gt;setCharacterSizeMode( osgText::TextBase::OBJECT_COORDS_WITH_MAXIMUM_SCREEN_SIZE_CAPPED_BY_FONT_HEIGHT );</span>
        <span class="comment">//t-&gt;setCharacterSize( 300000.0f );</span>
        t-&gt;setPosition( position );
        t-&gt;setRotation( orientation);
        t-&gt;setAlignment( osgText::TextBase::CENTER_CENTER );
        t-&gt;getOrCreateStateSet()-&gt;setAttributeAndModes( <span class="keyword">new</span> osg::Depth(osg::Depth::ALWAYS), osg::StateAttribute::ON );
        t-&gt;getOrCreateStateSet()-&gt;setRenderBinDetails( 99999, <span class="stringliteral">&quot;RenderBin&quot;</span>, osg::StateSet::OVERRIDE_RENDERBIN_DETAILS );

        <span class="comment">// apply styling as appropriate:</span>
        osg::Vec4f textColor = symbol-&gt;<a class="code" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#a8b3ab4ee20a8cc790e45138c44f602b1">fill</a>()-&gt;color();
        osg::Vec4f haloColor = symbol-&gt;<a class="code" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#a253d33a89e58f5cbb49ebf3ecc815e65">halo</a>()-&gt;color();

        t-&gt;setColor( textColor );
        t-&gt;setBackdropColor( haloColor );
        t-&gt;setBackdropType( osgText::Text::OUTLINE );

        <span class="keywordflow">if</span> ( context.<a class="code" href="classosgEarth_1_1Features_1_1FilterContext.html#acf61fdd826797b4b08c2cc074accd0fa">isGeocentric</a>() )
        {
            <span class="comment">// install a cluster culler</span>
            t-&gt;setCullCallback( <span class="keyword">new</span> <a class="code" href="structosgEarth_1_1CullDrawableByNormal.html">CullDrawableByNormal</a>(position * context.<a class="code" href="classosgEarth_1_1Features_1_1FilterContext.html#a9e82cf1e5599687e0e4fa96b11632bb2">inverseReferenceFrame</a>()) );
        }

        <span class="keywordflow">if</span> (<a class="code" href="classosgEarth_1_1Features_1_1BuildTextOperator.html#ae0bb62311f08eadf2915e042ab1ab741">_hideClutter</a>)
        {
            osg::BoundingBox tBound = t-&gt;getBound();
            osg::ref_ptr&lt;osgUtil::PolytopeIntersector&gt; intersector = <span class="keyword">new</span> osgUtil::PolytopeIntersector(osgUtil::Intersector::MODEL, tBound.xMin(), tBound.yMin(), tBound.xMax(), tBound.yMax());
            osgUtil::IntersectionVisitor intersectVisitor(intersector.get());
            result-&gt;accept(intersectVisitor);

            <span class="keywordflow">if</span> (!intersector-&gt;containsIntersections())
            {
                result-&gt;addDrawable( t );
                <span class="keywordflow">if</span> (removeDuplicateLabels) labelNames.insert(text);
            }
        }
        <span class="keywordflow">else</span>
        {
            result-&gt;addDrawable( t );
            <span class="keywordflow">if</span> (removeDuplicateLabels) labelNames.insert(text);
        }
    }
    <span class="keywordflow">return</span> result;
}
</pre></div>
<p><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png"/> Here is the call graph for this function:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classosgEarth_1_1Features_1_1BuildTextOperator_aa6e12cb28a335505aee7c07598e5e847_cgraph.png" border="0" usemap="#classosgEarth_1_1Features_1_1BuildTextOperator_aa6e12cb28a335505aee7c07598e5e847_cgraph" alt=""/></div>
<map name="classosgEarth_1_1Features_1_1BuildTextOperator_aa6e12cb28a335505aee7c07598e5e847_cgraph" id="classosgEarth_1_1Features_1_1BuildTextOperator_aa6e12cb28a335505aee7c07598e5e847_cgraph">
<area shape="rect" id="node3" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#af4dc10f833fbccf33f138ae9d9ee4ac3" title="osgEarth::Symbology::TextSymbol::content" alt="" coords="411,45,685,75"/><area shape="rect" id="node5" href="classosgEarth_1_1Features_1_1Feature.html#a7e45df02c1660959d070d7f4603d4dcd" title="osgEarth::Features::Feature::eval" alt="" coords="440,99,656,128"/><area shape="rect" id="node17" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#a8b3ab4ee20a8cc790e45138c44f602b1" title="osgEarth::Symbology::TextSymbol::fill" alt="" coords="425,152,671,181"/><area shape="rect" id="node19" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#adb937da4c5ef13b013b7d7f86546a75d" title="osgEarth::Symbology::TextSymbol::font" alt="" coords="421,205,675,235"/><area shape="rect" id="node21" href="structosgEarth_1_1optional.html#ac10ed828e5fb151d8cabf856e1fc3d3e" title="osgEarth::optional::get" alt="" coords="472,259,624,288"/><area shape="rect" id="node23" href="classosgEarth_1_1Symbology_1_1Geometry.html#ae7e387b3f435029c00799c969ed6b390" title="osgEarth::Symbology::Geometry::getBounds" alt="" coords="407,312,689,341"/><area shape="rect" id="node31" href="classosgEarth_1_1SpatialReference.html#ad7d6ef0605664b77e8348df5324ea32f" title="osgEarth::SpatialReference::getEllipsoid" alt="" coords="420,365,676,395"/><area shape="rect" id="node39" href="classosgEarth_1_1Features_1_1Feature.html#a2027c4708491dc48da4091b0ab7e8c57" title="osgEarth::Features::Feature::getGeometry" alt="" coords="415,419,681,448"/><area shape="rect" id="node41" href="classosgEarth_1_1Symbology_1_1LineString.html#a9b5b6e9b331071d46fbf1a76eca84c7b" title="osgEarth::Symbology::LineString::getLength" alt="" coords="409,472,687,501"/><area shape="rect" id="node45" href="classosgEarth_1_1Symbology_1_1LineString.html#a15aaca980d8f483426582978d9c41561" title="osgEarth::Symbology::LineString::getSegment" alt="" coords="403,525,693,555"/><area shape="rect" id="node48" href="classosgEarth_1_1Features_1_1FeatureProfile.html#a7f2cf88a25569de112c7c929555e3943" title="osgEarth::Features::FeatureProfile::getSRS" alt="" coords="411,579,685,608"/><area shape="rect" id="node50" href="classosgEarth_1_1Symbology_1_1Geometry.html#a12044f75418af11e87a616a78967e5b1" title="osgEarth::Symbology::Geometry::getType" alt="" coords="415,632,681,661"/><area shape="rect" id="node52" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#a253d33a89e58f5cbb49ebf3ecc815e65" title="osgEarth::Symbology::TextSymbol::halo" alt="" coords="420,685,676,715"/><area shape="rect" id="node54" href="classosgEarth_1_1Features_1_1FilterContext.html#a9e82cf1e5599687e0e4fa96b11632bb2" title="osgEarth::Features::FilterContext::inverseReferenceFrame" alt="" coords="367,739,729,768"/><area shape="rect" id="node56" href="classosgEarth_1_1Features_1_1FilterContext.html#acf61fdd826797b4b08c2cc074accd0fa" title="osgEarth::Features::FilterContext::isGeocentric" alt="" coords="400,792,696,821"/><area shape="rect" id="node58" href="structosgEarth_1_1optional.html#aa094207bf2b22a4848989cd017dc4365" title="osgEarth::optional::isSet" alt="" coords="465,845,631,875"/><area shape="rect" id="node60" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#a2ee8bcca128aeb50d4d648411cfa8764" title="osgEarth::Symbology::TextSymbol::lineOrientation" alt="" coords="391,899,705,928"/><area shape="rect" id="node62" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#a31b00e981203367ea406df231ab456e7" title="osgEarth::Symbology::TextSymbol::linePlacement" alt="" coords="391,952,705,981"/><area shape="rect" id="node64" href="classosgEarth_1_1Features_1_1FilterContext.html#a6fdc74d6944a655fd8fe8e5ff298af57" title="osgEarth::Features::FilterContext::profile" alt="" coords="419,1005,677,1035"/><area shape="rect" id="node66" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#a2ebaddf98769da5c384657b9f982e152" title="osgEarth::Symbology::TextSymbol::removeDuplicateLabels" alt="" coords="364,1059,732,1088"/><area shape="rect" id="node68" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#a09d72da7c5ddb48bec7f5419ff7d898d" title="osgEarth::Symbology::TextSymbol::rotateToScreen" alt="" coords="387,1112,709,1141"/><area shape="rect" id="node70" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#a3e7ab832c2c56a2094ffe5c97e89937f" title="osgEarth::Symbology::TextSymbol::size" alt="" coords="420,1165,676,1195"/><area shape="rect" id="node72" href="classosgEarth_1_1Symbology_1_1TextSymbol.html#a41fe2ca10e0be988838d9d7355be3f4d" title="osgEarth::Symbology::TextSymbol::sizeMode" alt="" coords="404,1219,692,1248"/><area shape="rect" id="node74" href="classosgEarth_1_1Features_1_1FilterContext.html#a62aa3e76a35b38551d293e4660bb7559" title="osgEarth::Features::FilterContext::toWorld" alt="" coords="413,1272,683,1301"/><area shape="rect" id="node76" href="structosgEarth_1_1optional.html#a9e71f677728602dc521d7102c9be7820" title="osgEarth::optional::value" alt="" coords="465,1325,631,1355"/><area shape="rect" id="node7" href="classosgEarth_1_1Symbology_1_1NumericExpression.html#ae9486f987f30f98584fa2b554518ac72" title="osgEarth::Symbology::NumericExpression::eval" alt="" coords="823,5,1124,35"/><area shape="rect" id="node9" href="classosgEarth_1_1Features_1_1Feature.html#ac783fc569e3cd918592c3f10c0060b97" title="osgEarth::Features::Feature::getDouble" alt="" coords="848,59,1099,88"/><area shape="rect" id="node13" href="classosgEarth_1_1Symbology_1_1NumericExpression.html#a22bc3d49dae8cde7b472c2d9cba7689c" title="osgEarth::Symbology::NumericExpression::set" alt="" coords="827,112,1120,141"/><area shape="rect" id="node15" href="classosgEarth_1_1Symbology_1_1NumericExpression.html#afa7d3a785487f743ce392268d92ef327" title="osgEarth::Symbology::NumericExpression::variables" alt="" coords="809,165,1137,195"/><area shape="rect" id="node11" href="namespaceosgEarth.html#a2c3b7223f6314c9d36e643c231f9123f" title="osgEarth::toLower" alt="" coords="1257,59,1385,88"/><area shape="rect" id="node25" href="classosgEarth_1_1MixinVector.html#a09e839d601931f13776d30648ecd97f0" title="osgEarth::MixinVector\&lt; osg::Vec3d, osg::Referenced \&gt;::begin" alt="" coords="781,245,1165,275"/><area shape="rect" id="node27" href="classosgEarth_1_1MixinVector.html#ad40d751f91c9b8637fc5a274e75cd8a7" title="osgEarth::MixinVector\&lt; osg::Vec3d, osg::Referenced \&gt;::end" alt="" coords="787,299,1160,328"/><area shape="rect" id="node29" href="classosgEarth_1_1Bounds.html#a1fb3d4370745d4a4ad420eaa1b64dae3" title="osgEarth::Bounds::expandBy" alt="" coords="877,352,1069,381"/><area shape="rect" id="node33" href="classosgEarth_1_1SpatialReference.html#ad4674227fe46613b3f5821109a509714" title="osgEarth::SpatialReference::init" alt="" coords="871,405,1076,435"/><area shape="rect" id="node35" href="classosgEarth_1_1SpatialReference.html#ae8cda9f2cf24a92d09c58462c5fbd5e8" title="osgEarth::SpatialReference::_init" alt="" coords="1215,405,1428,435"/><area shape="rect" id="node37" href="namespaceanonymous__namespace_02SpatialReference_8cpp_03.html#a2d59d21c23228cfce0a56b2174727ee9" title="anonymous_namespace\{SpatialReference::cpp\}::getOGRAttrValue" alt="" coords="1477,405,1888,435"/><area shape="rect" id="node43" href="classosgEarth_1_1MixinVector.html#a29d1318457f75e1e0841d7e20f61dadb" title="osgEarth::MixinVector\&lt; osg::Vec3d, osg::Referenced \&gt;::size" alt="" coords="785,499,1161,528"/></map>
</div>
</p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="ae0bb62311f08eadf2915e042ab1ab741"></a><!-- doxytag: member="osgEarth::Features::BuildTextOperator::_hideClutter" ref="ae0bb62311f08eadf2915e042ab1ab741" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classosgEarth_1_1Features_1_1BuildTextOperator.html#ae0bb62311f08eadf2915e042ab1ab741">osgEarth::Features::BuildTextOperator::_hideClutter</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="BuildTextOperator_source.html#l00045">45</a> of file <a class="el" href="BuildTextOperator_source.html">BuildTextOperator</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/cube/sources/osgearth/src/osgEarthFeatures/<a class="el" href="BuildTextOperator_source.html">BuildTextOperator</a></li>
<li>/home/cube/sources/osgearth/src/osgEarthFeatures/<a class="el" href="BuildTextOperator_8cpp_source.html">BuildTextOperator.cpp</a></li>
</ul>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Wed Jan 18 2012 15:02:55 for osgEarth by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
