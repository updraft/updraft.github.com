<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>osgEarth: GDALTileSource Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = 'open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = 'closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">osgEarth&#160;<span id="projectnumber">2.1.1</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a>  </div>
  <div class="headertitle">
<h1>GDALTileSource Class Reference</h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="GDALTileSource" --><!-- doxytag: inherits="osgEarth::TileSource" --><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png"/> Inheritance diagram for GDALTileSource:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classGDALTileSource__inherit__graph.png" border="0" usemap="#GDALTileSource_inherit__map" alt="Inheritance graph"/></div>
<map name="GDALTileSource_inherit__map" id="GDALTileSource_inherit__map">
<area shape="rect" id="node2" href="classosgEarth_1_1TileSource.html" title="osgEarth::TileSource" alt="" coords="5,83,149,112"/><area shape="rect" id="node4" href="classosg_1_1Object.html" title="Object" alt="" coords="48,5,107,35"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png"/> Collaboration diagram for GDALTileSource:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classGDALTileSource__coll__graph.png" border="0" usemap="#GDALTileSource_coll__map" alt="Collaboration graph"/></div>
<map name="GDALTileSource_coll__map" id="GDALTileSource_coll__map">
<area shape="rect" id="node2" href="classosgEarth_1_1TileSource.html" title="osgEarth::TileSource" alt="" coords="2245,268,2389,297"/><area shape="rect" id="node4" href="classosg_1_1Object.html" title="Object" alt="" coords="1880,214,1939,244"/><area shape="rect" id="node6" href="classosgEarth_1_1TileSourceOptions.html" title="osgEarth::TileSourceOptions" alt="" coords="1815,268,2004,297"/><area shape="rect" id="node35" href="classosgEarth_1_1Drivers_1_1GDALOptions.html" title="osgEarth::Drivers::GDALOptions" alt="" coords="2211,436,2424,465"/><area shape="rect" id="node8" href="classosgEarth_1_1DriverConfigOptions.html" title="osgEarth::DriverConfigOptions" alt="" coords="1155,32,1355,61"/><area shape="rect" id="node10" href="classosgEarth_1_1ConfigOptions.html" title="osgEarth::ConfigOptions" alt="" coords="553,120,719,149"/><area shape="rect" id="node24" href="classosgEarth_1_1ProfileOptions.html" title="osgEarth::ProfileOptions" alt="" coords="967,224,1129,253"/><area shape="rect" id="node12" href="classosgEarth_1_1Config.html" title="osgEarth::Config" alt="" coords="279,157,399,186"/><area shape="rect" id="node14" href="structosgEarth_1_1Properties.html" title="osgEarth::Properties" alt="" coords="11,157,152,186"/><area shape="rect" id="node16" href="classosgEarth_1_1URIContext.html" title="osgEarth::URIContext" alt="" coords="5,257,157,286"/><area shape="rect" id="node40" href="classosgEarth_1_1URI.html" title="osgEarth::URI" alt="" coords="285,353,392,382"/><area shape="rect" id="node18" href="structosgEarth_1_1optional.html" title="osgEarth::optional\&lt; float \&gt;" alt="" coords="1408,328,1584,357"/><area shape="rect" id="node20" href="structosgEarth_1_1optional.html" title="osgEarth::optional\&lt; std::string \&gt;" alt="" coords="532,350,740,380"/><area shape="rect" id="node22" href="structosgEarth_1_1optional.html" title="osgEarth::optional\&lt; ProfileOptions \&gt;" alt="" coords="1380,224,1612,253"/><area shape="rect" id="node28" href="structosgEarth_1_1optional.html" title="osgEarth::optional\&lt; Bounds \&gt;" alt="" coords="539,226,733,256"/><area shape="rect" id="node30" href="classosgEarth_1_1Bounds.html" title="osgEarth::Bounds" alt="" coords="276,226,401,256"/><area shape="rect" id="node32" href="structosgEarth_1_1optional.html" title="osgEarth::optional\&lt; int \&gt;" alt="" coords="553,173,719,202"/><area shape="rect" id="node38" href="structosgEarth_1_1optional.html" title="osgEarth::optional\&lt; URI \&gt;" alt="" coords="767,453,940,482"/><area shape="rect" id="node43" href="structosgEarth_1_1optional.html" title="osgEarth::optional\&lt; bool \&gt;" alt="" coords="1823,540,1996,569"/><area shape="rect" id="node46" href="structosgEarth_1_1optional.html" title="osgEarth::optional\&lt; ElevationInterpolation \&gt;" alt="" coords="1772,436,2047,465"/><area shape="rect" id="node48" href="structosgEarth_1_1optional.html" title="osgEarth::optional\&lt; unsigned \&gt;" alt="" coords="1808,593,2011,622"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>

<p><a href="classGDALTileSource-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGDALTileSource.html#ab34d3080c64818f998d0ee07edf89fbf">GDALTileSource</a> (const <a class="el" href="classosgEarth_1_1TileSourceOptions.html">TileSourceOptions</a> &amp;options)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGDALTileSource.html#ac2ae29b97c68ca67cb53b04596067af4">~GDALTileSource</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGDALTileSource.html#a9fb5b232e7c2158f53938fe08d55d3a6">initialize</a> (const std::string &amp;referenceURI, const <a class="el" href="classosgEarth_1_1Profile.html">Profile</a> *overrideProfile)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGDALTileSource.html#aabb4f66070b4a3b69dc394f9a1340fa7">pixelToGeo</a> (double x, double y, double &amp;geoX, double &amp;geoY)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">osg::Image *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGDALTileSource.html#aca624e7c34a146952c54d95d4aa57936">createImage</a> (const <a class="el" href="classosgEarth_1_1TileKey.html">TileKey</a> &amp;key, <a class="el" href="classosgEarth_1_1ProgressCallback.html">ProgressCallback</a> *progress)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGDALTileSource.html#a2abc52e749f774e0b99e228b5b41d43f">isValidValue</a> (float v, GDALRasterBand *band)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGDALTileSource.html#a7f47b54c813159bc40c88ce759aa9309">getInterpolatedValue</a> (GDALRasterBand *band, double x, double y, bool applyOffset=true)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">osg::HeightField *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGDALTileSource.html#afb873b0464972b9aed0f8bc36b3db86c">createHeightField</a> (const <a class="el" href="classosgEarth_1_1TileKey.html">TileKey</a> &amp;key, <a class="el" href="classosgEarth_1_1ProgressCallback.html">ProgressCallback</a> *progress)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGDALTileSource.html#a9321c8275bee220769f928dbaeded77a">intersects</a> (const <a class="el" href="classosgEarth_1_1TileKey.html">TileKey</a> &amp;key)</td></tr>
<tr><td colspan="2"><h2><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static GDALRasterBand *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGDALTileSource.html#a1f7d0525a2823d44e78711dee7c4bd26">findBand</a> (GDALDataset *ds, GDALColorInterp colorInterp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGDALTileSource.html#ac94e72a3459c0f65ac1867f184a7091c">getPalleteIndexColor</a> (GDALRasterBand *band, int index, osg::Vec4ub &amp;color)</td></tr>
<tr><td colspan="2"><h2><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">GDALDataset *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGDALTileSource.html#a9276a2e82ded000bf0a6a660b7690d0b">_srcDS</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">GDALDataset *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGDALTileSource.html#a4d2872304a01d5f7ec59ae2301e80582">_geotransform</a> [6]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGDALTileSource.html#adec1aa793d326aba6b542e29e25f63d2">_invtransform</a> [6]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">osg::Vec2d&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGDALTileSource.html#ac3d93f74337fa4e76bd23a156e435a35">_extentsMin</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">osg::Vec2d&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGDALTileSource.html#a75b40bcb84baf3b142225102ccee38ef">_extentsMax</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classosgEarth_1_1Drivers_1_1GDALOptions.html">GDALOptions</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGDALTileSource.html#a1468ec932630f7f8ad705415a674322b">_options</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGDALTileSource.html#aa62292c4680be31c6b53327b2cb2adba">_maxDataLevel</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="ReaderWriterGDAL_8cpp_source.html#l00611">611</a> of file <a class="el" href="ReaderWriterGDAL_8cpp_source.html">ReaderWriterGDAL.cpp</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ab34d3080c64818f998d0ee07edf89fbf"></a><!-- doxytag: member="GDALTileSource::GDALTileSource" ref="ab34d3080c64818f998d0ee07edf89fbf" args="(const TileSourceOptions &amp;options)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GDALTileSource::GDALTileSource </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classosgEarth_1_1TileSourceOptions.html">TileSourceOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ReaderWriterGDAL_8cpp_source.html#l00614">614</a> of file <a class="el" href="ReaderWriterGDAL_8cpp_source.html">ReaderWriterGDAL.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                                                       :
      <a class="code" href="classosgEarth_1_1TileSource.html#a26f4aa3a0ce98d906a14b507cf31f449">TileSource</a>( options ),
      <a class="code" href="classGDALTileSource.html#a9276a2e82ded000bf0a6a660b7690d0b">_srcDS</a>(<a class="code" href="Export.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>),
      <a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>(<a class="code" href="Export.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>),
      <a class="code" href="classGDALTileSource.html#a1468ec932630f7f8ad705415a674322b">_options</a>(options),
      <a class="code" href="classGDALTileSource.html#aa62292c4680be31c6b53327b2cb2adba">_maxDataLevel</a>(30)
    {    
    }
</pre></div>
</div>
</div>
<a class="anchor" id="ac2ae29b97c68ca67cb53b04596067af4"></a><!-- doxytag: member="GDALTileSource::~GDALTileSource" ref="ac2ae29b97c68ca67cb53b04596067af4" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual GDALTileSource::~GDALTileSource </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ReaderWriterGDAL_8cpp_source.html#l00623">623</a> of file <a class="el" href="ReaderWriterGDAL_8cpp_source.html">ReaderWriterGDAL.cpp</a>.</p>
<div class="fragment"><pre class="fragment">    {             
        <a class="code" href="Registry.html#af57173fda5dd7d12d263f1adfbc69d52">GDAL_SCOPED_LOCK</a>;

        <span class="keywordflow">if</span> (<a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a> != <a class="code" href="classGDALTileSource.html#a9276a2e82ded000bf0a6a660b7690d0b">_srcDS</a>)
        {
            GDALClose( <a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a> );
        }

        <span class="comment">//Close the datasets if it exists</span>
        <span class="keywordflow">if</span> (<a class="code" href="classGDALTileSource.html#a9276a2e82ded000bf0a6a660b7690d0b">_srcDS</a>)
        {     
            GDALClose(<a class="code" href="classGDALTileSource.html#a9276a2e82ded000bf0a6a660b7690d0b">_srcDS</a>);
        }
    }
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="afb873b0464972b9aed0f8bc36b3db86c"></a><!-- doxytag: member="GDALTileSource::createHeightField" ref="afb873b0464972b9aed0f8bc36b3db86c" args="(const TileKey &amp;key, ProgressCallback *progress)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">osg::HeightField* GDALTileSource::createHeightField </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classosgEarth_1_1TileKey.html">TileKey</a> &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classosgEarth_1_1ProgressCallback.html">ProgressCallback</a> *&#160;</td>
          <td class="paramname"><em>progress</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Creates a heightfield for the given TileKey The returned object is new and is the responsibility of the caller. </p>

<p>Reimplemented from <a class="el" href="classosgEarth_1_1TileSource.html#a7dd9e1ceea9c83055f1fd15acfcbcc7f">osgEarth::TileSource</a>.</p>

<p>Definition at line <a class="el" href="ReaderWriterGDAL_8cpp_source.html#l01459">1459</a> of file <a class="el" href="ReaderWriterGDAL_8cpp_source.html">ReaderWriterGDAL.cpp</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <span class="keywordflow">if</span> (key.<a class="code" href="classosgEarth_1_1TileKey.html#a0ee6b25bbae560dda11987ac1e9dc69d">getLevelOfDetail</a>() &gt; <a class="code" href="classGDALTileSource.html#aa62292c4680be31c6b53327b2cb2adba">_maxDataLevel</a>)
        {
            <span class="comment">//OE_NOTICE &lt;&lt; &quot;Reached maximum data resolution key=&quot; &lt;&lt; key.getLevelOfDetail() &lt;&lt; &quot; max=&quot; &lt;&lt; _maxDataLevel &lt;&lt;  std::endl;</span>
            <span class="keywordflow">return</span> <a class="code" href="Export.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
        }

        <a class="code" href="Registry.html#af57173fda5dd7d12d263f1adfbc69d52">GDAL_SCOPED_LOCK</a>;

        <span class="keywordtype">int</span> tileSize = <a class="code" href="classGDALTileSource.html#a1468ec932630f7f8ad705415a674322b">_options</a>.<a class="code" href="classosgEarth_1_1TileSourceOptions.html#a408fb6362b758888204763465a986346">tileSize</a>().<a class="code" href="structosgEarth_1_1optional.html#a9e71f677728602dc521d7102c9be7820">value</a>();

        <span class="comment">//Allocate the heightfield</span>
        osg::ref_ptr&lt;osg::HeightField&gt; hf = <span class="keyword">new</span> osg::HeightField;
        hf-&gt;allocate(tileSize, tileSize);

        <span class="keywordflow">if</span> (<a class="code" href="classGDALTileSource.html#a9321c8275bee220769f928dbaeded77a">intersects</a>(key))
        {
            <span class="comment">//Get the meter extents of the tile</span>
            <span class="keywordtype">double</span> xmin, ymin, xmax, ymax;
            key.<a class="code" href="classosgEarth_1_1TileKey.html#a44441e91bc4f46b997456786a0b749a4">getExtent</a>().<a class="code" href="classosgEarth_1_1GeoExtent.html#afa0bd831daf0541cbbb161763ed9291f">getBounds</a>(xmin, ymin, xmax, ymax);

            <span class="comment">//Just read from the first band</span>
            GDALRasterBand* band = <a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>-&gt;GetRasterBand(1);

            <span class="keywordtype">double</span> dx = (xmax - xmin) / (tileSize-1);
            <span class="keywordtype">double</span> dy = (ymax - ymin) / (tileSize-1);

            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0; c &lt; tileSize; ++c)
            {
                <span class="keywordtype">double</span> geoX = xmin + (dx * (double)c);
                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; r &lt; tileSize; ++r)
                {
                    <span class="keywordtype">double</span> geoY = ymin + (dy * (double)r);
                    <span class="keywordtype">float</span> h = <a class="code" href="classGDALTileSource.html#a7f47b54c813159bc40c88ce759aa9309">getInterpolatedValue</a>(band, geoX, geoY);
                    hf-&gt;setHeight(c, r, h);
                }
            }
        }
        <span class="keywordflow">else</span>
        {
            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; hf-&gt;getHeightList().size(); ++i) hf-&gt;getHeightList()[i] = <a class="code" href="HeightFieldUtils.html#a5157d7023a55f3e15a9515b68c38fe5d">NO_DATA_VALUE</a>;
        }
        <span class="keywordflow">return</span> hf.release();
    }
</pre></div>
<p><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classGDALTileSource_afb873b0464972b9aed0f8bc36b3db86c_cgraph.png" border="0" usemap="#classGDALTileSource_afb873b0464972b9aed0f8bc36b3db86c_cgraph" alt=""/></div>
<map name="classGDALTileSource_afb873b0464972b9aed0f8bc36b3db86c_cgraph" id="classGDALTileSource_afb873b0464972b9aed0f8bc36b3db86c_cgraph">
<area shape="rect" id="node3" href="classosgEarth_1_1GeoExtent.html#afa0bd831daf0541cbbb161763ed9291f" title="osgEarth::GeoExtent::getBounds" alt="" coords="295,5,508,35"/><area shape="rect" id="node5" href="classosgEarth_1_1TileKey.html#a44441e91bc4f46b997456786a0b749a4" title="osgEarth::TileKey::getExtent" alt="" coords="307,59,496,88"/><area shape="rect" id="node7" href="classosgEarth_1_1TileKey.html#a0ee6b25bbae560dda11987ac1e9dc69d" title="osgEarth::TileKey::getLevelOfDetail" alt="" coords="287,112,516,141"/><area shape="rect" id="node9" href="TMS_8cpp.html#a4f0efe4500be14d29289f7698a1ecc26" title="intersects" alt="" coords="363,165,440,195"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aca624e7c34a146952c54d95d4aa57936"></a><!-- doxytag: member="GDALTileSource::createImage" ref="aca624e7c34a146952c54d95d4aa57936" args="(const TileKey &amp;key, ProgressCallback *progress)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">osg::Image* GDALTileSource::createImage </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classosgEarth_1_1TileKey.html">TileKey</a> &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classosgEarth_1_1ProgressCallback.html">ProgressCallback</a> *&#160;</td>
          <td class="paramname"><em>progress</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Creates an image for the given TileKey. The returned object is new and is the responsibility of the caller. </p>

<p>Implements <a class="el" href="classosgEarth_1_1TileSource.html#ad48b425d13420f5d0c125529523cf194">osgEarth::TileSource</a>.</p>

<p>Definition at line <a class="el" href="ReaderWriterGDAL_8cpp_source.html#l01019">1019</a> of file <a class="el" href="ReaderWriterGDAL_8cpp_source.html">ReaderWriterGDAL.cpp</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <span class="keywordflow">if</span> (key.<a class="code" href="classosgEarth_1_1TileKey.html#a0ee6b25bbae560dda11987ac1e9dc69d">getLevelOfDetail</a>() &gt; <a class="code" href="classGDALTileSource.html#aa62292c4680be31c6b53327b2cb2adba">_maxDataLevel</a>)
        {
            <a class="code" href="HTTPClient_8cpp.html#ac6600c2662696d8b43a4deb6877c8591">OE_DEBUG</a> &lt;&lt; <a class="code" href="ReaderWriterGDAL_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;&quot;</span> &lt;&lt; getName() &lt;&lt; <span class="stringliteral">&quot;: Reached maximum data resolution key=&quot;</span> 
                &lt;&lt; key.<a class="code" href="classosgEarth_1_1TileKey.html#a0ee6b25bbae560dda11987ac1e9dc69d">getLevelOfDetail</a>() &lt;&lt; <span class="stringliteral">&quot; max=&quot;</span> &lt;&lt; <a class="code" href="classGDALTileSource.html#aa62292c4680be31c6b53327b2cb2adba">_maxDataLevel</a> &lt;&lt;  std::endl;
            <span class="keywordflow">return</span> <a class="code" href="Export.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
        }

        <a class="code" href="Registry.html#af57173fda5dd7d12d263f1adfbc69d52">GDAL_SCOPED_LOCK</a>;

        <span class="keywordtype">int</span> tileSize = <a class="code" href="classGDALTileSource.html#a1468ec932630f7f8ad705415a674322b">_options</a>.<a class="code" href="classosgEarth_1_1TileSourceOptions.html#a408fb6362b758888204763465a986346">tileSize</a>().<a class="code" href="structosgEarth_1_1optional.html#a9e71f677728602dc521d7102c9be7820">value</a>();

        osg::ref_ptr&lt;osg::Image&gt; image;
        <span class="keywordflow">if</span> (<a class="code" href="classGDALTileSource.html#a9321c8275bee220769f928dbaeded77a">intersects</a>(key)) <span class="comment">//TODO: I think this test is OBE -gw</span>
        {
            <span class="comment">//Get the extents of the tile</span>
            <span class="keywordtype">double</span> xmin, ymin, xmax, ymax;
            key.<a class="code" href="classosgEarth_1_1TileKey.html#a44441e91bc4f46b997456786a0b749a4">getExtent</a>().<a class="code" href="classosgEarth_1_1GeoExtent.html#afa0bd831daf0541cbbb161763ed9291f">getBounds</a>(xmin, ymin, xmax, ymax);

            <span class="keywordtype">double</span> dx       = (xmax - xmin) / (tileSize-1); 
            <span class="keywordtype">double</span> dy       = (ymax - ymin) / (tileSize-1); 


            <span class="keywordtype">int</span> target_width = tileSize;
            <span class="keywordtype">int</span> target_height = tileSize;
            <span class="keywordtype">int</span> tile_offset_left = 0;
            <span class="keywordtype">int</span> tile_offset_top = 0;

            <span class="keywordtype">int</span> off_x = int((xmin - <a class="code" href="classGDALTileSource.html#a4d2872304a01d5f7ec59ae2301e80582">_geotransform</a>[0]) / <a class="code" href="classGDALTileSource.html#a4d2872304a01d5f7ec59ae2301e80582">_geotransform</a>[1]);
            <span class="keywordtype">int</span> off_y = int((ymax - <a class="code" href="classGDALTileSource.html#a4d2872304a01d5f7ec59ae2301e80582">_geotransform</a>[3]) / <a class="code" href="classGDALTileSource.html#a4d2872304a01d5f7ec59ae2301e80582">_geotransform</a>[5]);
            <span class="keywordtype">int</span> width = int(((xmax - <a class="code" href="classGDALTileSource.html#a4d2872304a01d5f7ec59ae2301e80582">_geotransform</a>[0]) / <a class="code" href="classGDALTileSource.html#a4d2872304a01d5f7ec59ae2301e80582">_geotransform</a>[1]) - off_x);
            <span class="keywordtype">int</span> height = int(((ymin - <a class="code" href="classGDALTileSource.html#a4d2872304a01d5f7ec59ae2301e80582">_geotransform</a>[3]) / <a class="code" href="classGDALTileSource.html#a4d2872304a01d5f7ec59ae2301e80582">_geotransform</a>[5]) - off_y);

            <span class="keywordflow">if</span> (off_x + width &gt; <a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>-&gt;GetRasterXSize())
            {
                <span class="keywordtype">int</span> oversize_right = off_x + width - <a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>-&gt;GetRasterXSize();
                target_width = target_width - int(<span class="keywordtype">float</span>(oversize_right) / width * target_width);
                width = <a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>-&gt;GetRasterXSize() - off_x;
            }

            <span class="keywordflow">if</span> (off_x &lt; 0)
            {
                <span class="keywordtype">int</span> oversize_left = -off_x;
                tile_offset_left = int(<span class="keywordtype">float</span>(oversize_left) / width * target_width);
                target_width = target_width - int(<span class="keywordtype">float</span>(oversize_left) / width * target_width);
                width = width + off_x;
                off_x = 0;
            }

            <span class="keywordflow">if</span> (off_y + height &gt; <a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>-&gt;GetRasterYSize())
            {
                <span class="keywordtype">int</span> oversize_bottom = off_y + height - <a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>-&gt;GetRasterYSize();
                target_height = target_height - (int)osg::round(<span class="keywordtype">float</span>(oversize_bottom) / height * target_height);
                height = <a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>-&gt;GetRasterYSize() - off_y;
            }


            <span class="keywordflow">if</span> (off_y &lt; 0)
            {
                <span class="keywordtype">int</span> oversize_top = -off_y;
                tile_offset_top = int(<span class="keywordtype">float</span>(oversize_top) / height * target_height);
                target_height = target_height - int(<span class="keywordtype">float</span>(oversize_top) / height * target_height);
                height = height + off_y;
                off_y = 0;
            }

            <a class="code" href="HTTPClient_8cpp.html#ac6600c2662696d8b43a4deb6877c8591">OE_DEBUG</a> &lt;&lt; <a class="code" href="ReaderWriterGDAL_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;ReadWindow &quot;</span> &lt;&lt; width &lt;&lt; <span class="stringliteral">&quot;x&quot;</span> &lt;&lt; height &lt;&lt; <span class="stringliteral">&quot; DestWindow &quot;</span> &lt;&lt; target_width &lt;&lt; <span class="stringliteral">&quot;x&quot;</span> &lt;&lt; target_height &lt;&lt; std::endl;

            <span class="comment">//Return if parameters are out of range.</span>
            <span class="keywordflow">if</span> (width &lt;= 0 || height &lt;= 0 || target_width &lt;= 0 || target_height &lt;= 0)
            {
                <span class="keywordflow">return</span> 0;
            }



            GDALRasterBand* bandRed = <a class="code" href="classGDALTileSource.html#a1f7d0525a2823d44e78711dee7c4bd26">findBand</a>(<a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>, GCI_RedBand);
            GDALRasterBand* bandGreen = <a class="code" href="classGDALTileSource.html#a1f7d0525a2823d44e78711dee7c4bd26">findBand</a>(<a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>, GCI_GreenBand);
            GDALRasterBand* bandBlue = <a class="code" href="classGDALTileSource.html#a1f7d0525a2823d44e78711dee7c4bd26">findBand</a>(<a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>, GCI_BlueBand);
            GDALRasterBand* bandAlpha = <a class="code" href="classGDALTileSource.html#a1f7d0525a2823d44e78711dee7c4bd26">findBand</a>(<a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>, GCI_AlphaBand);

            GDALRasterBand* bandGray = <a class="code" href="classGDALTileSource.html#a1f7d0525a2823d44e78711dee7c4bd26">findBand</a>(<a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>, GCI_GrayIndex);

                        GDALRasterBand* bandPalette = <a class="code" href="classGDALTileSource.html#a1f7d0525a2823d44e78711dee7c4bd26">findBand</a>(<a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>, GCI_PaletteIndex);

            <span class="comment">//The pixel format is always RGBA to support transparency</span>
            GLenum pixelFormat = GL_RGBA;


            <span class="keywordflow">if</span> (bandRed &amp;&amp; bandGreen &amp;&amp; bandBlue)
            {
                <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *red = <span class="keyword">new</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>[target_width * target_height];
                <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *green = <span class="keyword">new</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>[target_width * target_height];
                <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *blue = <span class="keyword">new</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>[target_width * target_height];
                <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *alpha = <span class="keyword">new</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>[target_width * target_height];

                <span class="comment">//Initialize the alpha values to 255.</span>
                memset(alpha, 255, target_width * target_height);

                image = <span class="keyword">new</span> osg::Image;
                image-&gt;allocateImage(tileSize, tileSize, 1, pixelFormat, GL_UNSIGNED_BYTE);
                memset(image-&gt;data(), 0, image-&gt;getImageSizeInBytes());

                <span class="comment">//Nearest interpolation just uses RasterIO to sample the imagery and should be very fast.</span>
                <span class="keywordflow">if</span> (!*<a class="code" href="classGDALTileSource.html#a1468ec932630f7f8ad705415a674322b">_options</a>.<a class="code" href="classosgEarth_1_1Drivers_1_1GDALOptions.html#ade9b5d7c11e5824fe0fe23638a8ae441">interpolateImagery</a>() || <a class="code" href="classGDALTileSource.html#a1468ec932630f7f8ad705415a674322b">_options</a>.<a class="code" href="classosgEarth_1_1Drivers_1_1GDALOptions.html#a00bf6d5632135c87be249d505e1ed2ab">interpolation</a>() == <a class="code" href="HeightFieldUtils.html#ad323164a50c546323b4b95407df3f780">INTERP_NEAREST</a>)
                {
                    bandRed-&gt;RasterIO(GF_Read, off_x, off_y, width, height, red, target_width, target_height, GDT_Byte, 0, 0);
                    bandGreen-&gt;RasterIO(GF_Read, off_x, off_y, width, height, green, target_width, target_height, GDT_Byte, 0, 0);
                    bandBlue-&gt;RasterIO(GF_Read, off_x, off_y, width, height, blue, target_width, target_height, GDT_Byte, 0, 0);

                    <span class="keywordflow">if</span> (bandAlpha)
                    {
                        bandAlpha-&gt;RasterIO(GF_Read, off_x, off_y, width, height, alpha, target_width, target_height, GDT_Byte, 0, 0);
                    }

                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> src_row = 0, dst_row = tile_offset_top;
                        src_row &lt; target_height;
                        src_row++, dst_row++)
                    {
                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> src_col = 0, dst_col = tile_offset_left;
                            src_col &lt; target_width;
                            ++src_col, ++dst_col)
                        {
                            *(image-&gt;data(dst_col, dst_row) + 0) = red[src_col + src_row * target_width];
                            *(image-&gt;data(dst_col, dst_row) + 1) = green[src_col + src_row * target_width];
                            *(image-&gt;data(dst_col, dst_row) + 2) = blue[src_col + src_row * target_width];
                            *(image-&gt;data(dst_col, dst_row) + 3) = alpha[src_col + src_row * target_width];
                        }
                    }

                    image-&gt;flipVertical();
                }
                <span class="keywordflow">else</span>
                {
                    <span class="comment">//Sample each point exactly</span>
                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> c = 0; c &lt; tileSize; ++c)
                    {
                        <span class="keywordtype">double</span> geoX = xmin + (dx * (double)c); 
                        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> r = 0; r &lt; tileSize; ++r)
                        {
                            <span class="keywordtype">double</span> geoY = ymin + (dy * (double)r); 
                            *(image-&gt;data(c,r) + 0) = <a class="code" href="classGDALTileSource.html#a7f47b54c813159bc40c88ce759aa9309">getInterpolatedValue</a>(bandRed,  geoX,geoY,<span class="keyword">false</span>); 
                            *(image-&gt;data(c,r) + 1) = <a class="code" href="classGDALTileSource.html#a7f47b54c813159bc40c88ce759aa9309">getInterpolatedValue</a>(bandGreen,geoX,geoY,<span class="keyword">false</span>); 
                            *(image-&gt;data(c,r) + 2) = <a class="code" href="classGDALTileSource.html#a7f47b54c813159bc40c88ce759aa9309">getInterpolatedValue</a>(bandBlue, geoX,geoY,<span class="keyword">false</span>); 
                            <span class="keywordflow">if</span> (bandAlpha != <a class="code" href="Export.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) 
                                *(image-&gt;data(c,r) + 3) = <a class="code" href="classGDALTileSource.html#a7f47b54c813159bc40c88ce759aa9309">getInterpolatedValue</a>(bandAlpha,geoX, geoY, <span class="keyword">false</span>); 
                            <span class="keywordflow">else</span> 
                                *(image-&gt;data(c,r) + 3) = 255; 
                        }
                    }
                }

                <span class="keyword">delete</span> []red;
                <span class="keyword">delete</span> []green;
                <span class="keyword">delete</span> []blue;
                <span class="keyword">delete</span> []alpha;
            }
            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bandGray)
            {
                <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *gray = <span class="keyword">new</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>[target_width * target_height];
                <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *alpha = <span class="keyword">new</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>[target_width * target_height];

                <span class="comment">//Initialize the alpha values to 255.</span>
                memset(alpha, 255, target_width * target_height);

                image = <span class="keyword">new</span> osg::Image;
                image-&gt;allocateImage(tileSize, tileSize, 1, pixelFormat, GL_UNSIGNED_BYTE);
                memset(image-&gt;data(), 0, image-&gt;getImageSizeInBytes());


                <span class="keywordflow">if</span> (!*<a class="code" href="classGDALTileSource.html#a1468ec932630f7f8ad705415a674322b">_options</a>.<a class="code" href="classosgEarth_1_1Drivers_1_1GDALOptions.html#ade9b5d7c11e5824fe0fe23638a8ae441">interpolateImagery</a>() || <a class="code" href="classGDALTileSource.html#a1468ec932630f7f8ad705415a674322b">_options</a>.<a class="code" href="classosgEarth_1_1Drivers_1_1GDALOptions.html#a00bf6d5632135c87be249d505e1ed2ab">interpolation</a>() == <a class="code" href="HeightFieldUtils.html#ad323164a50c546323b4b95407df3f780">INTERP_NEAREST</a>)
                {
                    bandGray-&gt;RasterIO(GF_Read, off_x, off_y, width, height, gray, target_width, target_height, GDT_Byte, 0, 0);

                    <span class="keywordflow">if</span> (bandAlpha)
                    {
                        bandAlpha-&gt;RasterIO(GF_Read, off_x, off_y, width, height, alpha, target_width, target_height, GDT_Byte, 0, 0);
                    }

                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> src_row = 0, dst_row = tile_offset_top;
                        src_row &lt; target_height;
                        src_row++, dst_row++)
                    {
                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> src_col = 0, dst_col = tile_offset_left;
                            src_col &lt; target_width;
                            ++src_col, ++dst_col)
                        {
                            *(image-&gt;data(dst_col, dst_row) + 0) = gray[src_col + src_row * target_width];
                            *(image-&gt;data(dst_col, dst_row) + 1) = gray[src_col + src_row * target_width];
                            *(image-&gt;data(dst_col, dst_row) + 2) = gray[src_col + src_row * target_width];
                            *(image-&gt;data(dst_col, dst_row) + 3) = alpha[src_col + src_row * target_width];
                        }
                    }

                    image-&gt;flipVertical();
                }
                <span class="keywordflow">else</span>
                {
                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0; c &lt; tileSize; ++c) 
                    { 
                        <span class="keywordtype">double</span> geoX = xmin + (dx * (double)c); 

                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; r &lt; tileSize; ++r) 
                        { 
                            <span class="keywordtype">double</span> geoY   = ymin + (dy * (double)r); 
                            <span class="keywordtype">float</span>  color = <a class="code" href="classGDALTileSource.html#a7f47b54c813159bc40c88ce759aa9309">getInterpolatedValue</a>(bandGray,geoX,geoY,<span class="keyword">false</span>); 

                            *(image-&gt;data(c,r) + 0) = color; 
                            *(image-&gt;data(c,r) + 1) = color; 
                            *(image-&gt;data(c,r) + 2) = color; 
                            <span class="keywordflow">if</span> (bandAlpha != <a class="code" href="Export.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) 
                                *(image-&gt;data(c,r) + 3) = <a class="code" href="classGDALTileSource.html#a7f47b54c813159bc40c88ce759aa9309">getInterpolatedValue</a>(bandAlpha,geoX,geoY,<span class="keyword">false</span>); 
                            <span class="keywordflow">else</span> 
                                *(image-&gt;data(c,r) + 3) = 255; 
                        }
                    }
                }

                <span class="keyword">delete</span> []gray;
                <span class="keyword">delete</span> []alpha;

            }
                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bandPalette)
            {
                <span class="comment">//Pallete indexed imagery doesn&#39;t support interpolation currently and only uses nearest</span>
                <span class="comment">//b/c interpolating pallete indexes doesn&#39;t make sense.</span>
                                <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *palette = <span class="keyword">new</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>[target_width * target_height];

                image = <span class="keyword">new</span> osg::Image;
                image-&gt;allocateImage(tileSize, tileSize, 1, pixelFormat, GL_UNSIGNED_BYTE);
                memset(image-&gt;data(), 0, image-&gt;getImageSizeInBytes());

                                bandPalette-&gt;RasterIO(GF_Read, off_x, off_y, width, height, palette, target_width, target_height, GDT_Byte, 0, 0);

                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> src_row = 0, dst_row = tile_offset_top;
                                        src_row &lt; target_height;
                                        src_row++, dst_row++)
                                {
                                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> src_col = 0, dst_col = tile_offset_left;
                                                src_col &lt; target_width;
                                                ++src_col, ++dst_col)
                                        {
                        osg::Vec4ub color;
                        <a class="code" href="classGDALTileSource.html#ac94e72a3459c0f65ac1867f184a7091c">getPalleteIndexColor</a>( bandPalette, palette[src_col + src_row * target_width], color );                                          

                        *(image-&gt;data(dst_col, dst_row) + 0) = color.r();
                        *(image-&gt;data(dst_col, dst_row) + 1) = color.g();
                        *(image-&gt;data(dst_col, dst_row) + 2) = color.b();
                        *(image-&gt;data(dst_col, dst_row) + 3) = color.a();
                                        }
                                }

                                image-&gt;flipVertical();

                                <span class="keyword">delete</span> [] palette;

            }
            <span class="keywordflow">else</span>
            {
                <a class="code" href="Notify.html#a13b79c6470fc74594070bd2098afc9de">OE_WARN</a> 
                    &lt;&lt; <a class="code" href="ReaderWriterGDAL_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;Could not find red, green and blue bands or gray bands in &quot;</span>
                    &lt;&lt; <a class="code" href="classGDALTileSource.html#a1468ec932630f7f8ad705415a674322b">_options</a>.<a class="code" href="classosgEarth_1_1Drivers_1_1GDALOptions.html#aecef554e8c2f89222ee960e636f77e95">url</a>()-&gt;full()
                    &lt;&lt; <span class="stringliteral">&quot;.  Cannot create image. &quot;</span> &lt;&lt; std::endl;

                <span class="keywordflow">return</span> <a class="code" href="Export.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
            }
        }

        <span class="comment">// Moved this logic up into ImageLayer::createImageWrapper.</span>
<span class="comment"></span>        <span class="comment">//if (!image.valid())</span>
        <span class="comment">//{</span>
        <span class="comment">//    //OE_WARN &lt;&lt; LC &lt;&lt; &quot;Illegal state-- should not get here&quot; &lt;&lt; std::endl;</span>
        <span class="comment">//    return ImageUtils::createEmptyImage();</span>
        <span class="comment">//}</span>
        <span class="keywordflow">return</span> image.release();
    }
</pre></div>
<p><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classGDALTileSource_aca624e7c34a146952c54d95d4aa57936_cgraph.png" border="0" usemap="#classGDALTileSource_aca624e7c34a146952c54d95d4aa57936_cgraph" alt=""/></div>
<map name="classGDALTileSource_aca624e7c34a146952c54d95d4aa57936_cgraph" id="classGDALTileSource_aca624e7c34a146952c54d95d4aa57936_cgraph">
<area shape="rect" id="node3" href="classosgEarth_1_1GeoExtent.html#afa0bd831daf0541cbbb161763ed9291f" title="osgEarth::GeoExtent::getBounds" alt="" coords="263,5,476,35"/><area shape="rect" id="node5" href="classosgEarth_1_1TileKey.html#a44441e91bc4f46b997456786a0b749a4" title="osgEarth::TileKey::getExtent" alt="" coords="275,59,464,88"/><area shape="rect" id="node7" href="classosgEarth_1_1TileKey.html#a0ee6b25bbae560dda11987ac1e9dc69d" title="osgEarth::TileKey::getLevelOfDetail" alt="" coords="255,112,484,141"/><area shape="rect" id="node9" href="TMS_8cpp.html#a4f0efe4500be14d29289f7698a1ecc26" title="intersects" alt="" coords="331,165,408,195"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1f7d0525a2823d44e78711dee7c4bd26"></a><!-- doxytag: member="GDALTileSource::findBand" ref="a1f7d0525a2823d44e78711dee7c4bd26" args="(GDALDataset *ds, GDALColorInterp colorInterp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static GDALRasterBand* GDALTileSource::findBand </td>
          <td>(</td>
          <td class="paramtype">GDALDataset *&#160;</td>
          <td class="paramname"><em>ds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GDALColorInterp&#160;</td>
          <td class="paramname"><em>colorInterp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Finds a raster band based on color interpretation </p>

<p>Definition at line <a class="el" href="ReaderWriterGDAL_8cpp_source.html#l00924">924</a> of file <a class="el" href="ReaderWriterGDAL_8cpp_source.html">ReaderWriterGDAL.cpp</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <a class="code" href="Registry.html#af57173fda5dd7d12d263f1adfbc69d52">GDAL_SCOPED_LOCK</a>;

        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= ds-&gt;GetRasterCount(); ++i)
        {
            <span class="keywordflow">if</span> (ds-&gt;GetRasterBand(i)-&gt;GetColorInterpretation() == colorInterp) <span class="keywordflow">return</span> ds-&gt;GetRasterBand(i);
        }
        <span class="keywordflow">return</span> 0;
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a7f47b54c813159bc40c88ce759aa9309"></a><!-- doxytag: member="GDALTileSource::getInterpolatedValue" ref="a7f47b54c813159bc40c88ce759aa9309" args="(GDALRasterBand *band, double x, double y, bool applyOffset=true)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float GDALTileSource::getInterpolatedValue </td>
          <td>(</td>
          <td class="paramtype">GDALRasterBand *&#160;</td>
          <td class="paramname"><em>band</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>applyOffset</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ReaderWriterGDAL_8cpp_source.html#l01328">1328</a> of file <a class="el" href="ReaderWriterGDAL_8cpp_source.html">ReaderWriterGDAL.cpp</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <span class="keywordtype">double</span> r, c;
        GDALApplyGeoTransform(<a class="code" href="classGDALTileSource.html#adec1aa793d326aba6b542e29e25f63d2">_invtransform</a>, x, y, &amp;c, &amp;r);

        <span class="comment">//Account for slight rounding errors.  If we are right on the edge of the dataset, clamp to the edge</span>
        <span class="keywordtype">double</span> eps = 0.0001;
        <span class="keywordflow">if</span> (osg::equivalent(c, 0, eps)) c = 0;
        <span class="keywordflow">if</span> (osg::equivalent(r, 0, eps)) r = 0;
        <span class="keywordflow">if</span> (osg::equivalent(c, (<span class="keywordtype">double</span>)<a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>-&gt;GetRasterXSize(), eps)) c = <a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>-&gt;GetRasterXSize();
        <span class="keywordflow">if</span> (osg::equivalent(r, (<span class="keywordtype">double</span>)<a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>-&gt;GetRasterYSize(), eps)) r = <a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>-&gt;GetRasterYSize();

        <span class="keywordflow">if</span> (applyOffset)
        {
            <span class="comment">//Apply half pixel offset</span>
            r-= 0.5;
            c-= 0.5;

            <span class="comment">//Account for the half pixel offset in the geotransform.  If the pixel value is -0.5 we are still technically in the dataset</span>
            <span class="comment">//since 0,0 is now the center of the pixel.  So, if are within a half pixel above or a half pixel below the dataset just use</span>
            <span class="comment">//the edge values</span>
            <span class="keywordflow">if</span> (c &lt; 0 &amp;&amp; c &gt;= -0.5)
            {
                c = 0;
            }
            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c &gt; <a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>-&gt;GetRasterXSize()-1 &amp;&amp; c &lt;= <a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>-&gt;GetRasterXSize()-0.5)
            {
                c = <a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>-&gt;GetRasterXSize()-1;
            }

            <span class="keywordflow">if</span> (r &lt; 0 &amp;&amp; r &gt;= -0.5)
            {
                r = 0;
            }
            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (r &gt; <a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>-&gt;GetRasterYSize()-1 &amp;&amp; r &lt;= <a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>-&gt;GetRasterYSize()-0.5)
            {
                r = <a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>-&gt;GetRasterYSize()-1;
            }
        }

        <span class="keywordtype">float</span> result = 0.0f;

        <span class="comment">//If the location is outside of the pixel values of the dataset, just return 0</span>
        <span class="keywordflow">if</span> (c &lt; 0 || r &lt; 0 || c &gt; <a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>-&gt;GetRasterXSize()-1 || r &gt; <a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>-&gt;GetRasterYSize()-1)
            <span class="keywordflow">return</span> <a class="code" href="HeightFieldUtils.html#a5157d7023a55f3e15a9515b68c38fe5d">NO_DATA_VALUE</a>;

        <span class="keywordflow">if</span> ( <a class="code" href="classGDALTileSource.html#a1468ec932630f7f8ad705415a674322b">_options</a>.<a class="code" href="classosgEarth_1_1Drivers_1_1GDALOptions.html#a00bf6d5632135c87be249d505e1ed2ab">interpolation</a>() == <a class="code" href="HeightFieldUtils.html#ad323164a50c546323b4b95407df3f780">INTERP_NEAREST</a> )
        {
            band-&gt;RasterIO(GF_Read, (<span class="keywordtype">int</span>)osg::round(c), (<span class="keywordtype">int</span>)osg::round(r), 1, 1, &amp;result, 1, 1, GDT_Float32, 0, 0);
            <span class="keywordflow">if</span> (!<a class="code" href="classGDALTileSource.html#a2abc52e749f774e0b99e228b5b41d43f">isValidValue</a>( result, band))
            {
                <span class="keywordflow">return</span> <a class="code" href="HeightFieldUtils.html#a5157d7023a55f3e15a9515b68c38fe5d">NO_DATA_VALUE</a>;
            }
        }
        <span class="keywordflow">else</span>
        {
            <span class="keywordtype">int</span> rowMin = osg::maximum((<span class="keywordtype">int</span>)floor(r), 0);
            <span class="keywordtype">int</span> rowMax = osg::maximum(osg::minimum((<span class="keywordtype">int</span>)ceil(r), (<span class="keywordtype">int</span>)(<a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>-&gt;GetRasterYSize()-1)), 0);
            <span class="keywordtype">int</span> colMin = osg::maximum((<span class="keywordtype">int</span>)floor(c), 0);
            <span class="keywordtype">int</span> colMax = osg::maximum(osg::minimum((<span class="keywordtype">int</span>)ceil(c), (<span class="keywordtype">int</span>)(<a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>-&gt;GetRasterXSize()-1)), 0);

            <span class="keywordflow">if</span> (rowMin &gt; rowMax) rowMin = rowMax;
            <span class="keywordflow">if</span> (colMin &gt; colMax) colMin = colMax;

            <span class="keywordtype">float</span> urHeight, llHeight, ulHeight, lrHeight;

            band-&gt;RasterIO(GF_Read, colMin, rowMin, 1, 1, &amp;llHeight, 1, 1, GDT_Float32, 0, 0);
            band-&gt;RasterIO(GF_Read, colMin, rowMax, 1, 1, &amp;ulHeight, 1, 1, GDT_Float32, 0, 0);
            band-&gt;RasterIO(GF_Read, colMax, rowMin, 1, 1, &amp;lrHeight, 1, 1, GDT_Float32, 0, 0);
            band-&gt;RasterIO(GF_Read, colMax, rowMax, 1, 1, &amp;urHeight, 1, 1, GDT_Float32, 0, 0);

            <span class="comment">/*</span>
<span class="comment">            if (!isValidValue(urHeight, band)) urHeight = 0.0f;</span>
<span class="comment">            if (!isValidValue(llHeight, band)) llHeight = 0.0f;</span>
<span class="comment">            if (!isValidValue(ulHeight, band)) ulHeight = 0.0f;</span>
<span class="comment">            if (!isValidValue(lrHeight, band)) lrHeight = 0.0f;</span>
<span class="comment">            */</span>
            <span class="keywordflow">if</span> (!<a class="code" href="classGDALTileSource.html#a2abc52e749f774e0b99e228b5b41d43f">isValidValue</a>(urHeight, band) || (!<a class="code" href="classGDALTileSource.html#a2abc52e749f774e0b99e228b5b41d43f">isValidValue</a>(llHeight, band)) ||(!<a class="code" href="classGDALTileSource.html#a2abc52e749f774e0b99e228b5b41d43f">isValidValue</a>(ulHeight, band)) || (!<a class="code" href="classGDALTileSource.html#a2abc52e749f774e0b99e228b5b41d43f">isValidValue</a>(lrHeight, band)))
            {
                <span class="keywordflow">return</span> <a class="code" href="HeightFieldUtils.html#a5157d7023a55f3e15a9515b68c38fe5d">NO_DATA_VALUE</a>;
            }

            <span class="keywordflow">if</span> ( <a class="code" href="classGDALTileSource.html#a1468ec932630f7f8ad705415a674322b">_options</a>.<a class="code" href="classosgEarth_1_1Drivers_1_1GDALOptions.html#a00bf6d5632135c87be249d505e1ed2ab">interpolation</a>() == <a class="code" href="HeightFieldUtils.html#a8680962596afe586cceeb725c5397bad">INTERP_AVERAGE</a> )
            {
                <span class="keywordtype">double</span> x_rem = c - (int)c;
                <span class="keywordtype">double</span> y_rem = r - (int)r;

                <span class="keywordtype">double</span> w00 = (1.0 - y_rem) * (1.0 - x_rem) * (double)llHeight;
                <span class="keywordtype">double</span> w01 = (1.0 - y_rem) * x_rem * (<span class="keywordtype">double</span>)lrHeight;
                <span class="keywordtype">double</span> w10 = y_rem * (1.0 - x_rem) * (<span class="keywordtype">double</span>)ulHeight;
                <span class="keywordtype">double</span> w11 = y_rem * x_rem * (<span class="keywordtype">double</span>)urHeight;

                result = (<span class="keywordtype">float</span>)(w00 + w01 + w10 + w11);
            }
            else if ( <a class="code" href="classGDALTileSource.html#a1468ec932630f7f8ad705415a674322b">_options</a>.interpolation() == <a class="code" href="HeightFieldUtils.html#aa9ed60725e4c7bb403b0d985f9d3bf37">INTERP_BILINEAR</a> )
            {
                <span class="comment">//Check for exact value</span>
                <span class="keywordflow">if</span> ((colMax == colMin) &amp;&amp; (rowMax == rowMin))
                {
                    <span class="comment">//OE_NOTICE &lt;&lt; &quot;Exact value&quot; &lt;&lt; std::endl;</span>
                    result = llHeight;
                }
                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (colMax == colMin)
                {
                    <span class="comment">//OE_NOTICE &lt;&lt; &quot;Vertically&quot; &lt;&lt; std::endl;</span>
                    <span class="comment">//Linear interpolate vertically</span>
                    result = ((float)rowMax - r) * llHeight + (r - (float)rowMin) * ulHeight;
                }
                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rowMax == rowMin)
                {
                    <span class="comment">//OE_NOTICE &lt;&lt; &quot;Horizontally&quot; &lt;&lt; std::endl;</span>
                    <span class="comment">//Linear interpolate horizontally</span>
                    result = ((float)colMax - c) * llHeight + (c - (float)colMin) * lrHeight;
                }
                <span class="keywordflow">else</span>
                {
                    <span class="comment">//OE_NOTICE &lt;&lt; &quot;Bilinear&quot; &lt;&lt; std::endl;</span>
                    <span class="comment">//Bilinear interpolate</span>
                    <span class="keywordtype">float</span> r1 = ((float)colMax - c) * llHeight + (c - (float)colMin) * lrHeight;
                    <span class="keywordtype">float</span> <a class="code" href="namespaceanonymous__namespace_02ImageUtils_8cpp_03.html#a5caa4b40191551ab3efb0d3feb4ba60e">r2</a> = ((float)colMax - c) * ulHeight + (c - (float)colMin) * urHeight;

                    <span class="comment">//OE_INFO &lt;&lt; &quot;r1, r2 = &quot; &lt;&lt; r1 &lt;&lt; &quot; , &quot; &lt;&lt; r2 &lt;&lt; std::endl;</span>
                    result = ((float)rowMax - r) * r1 + (r - (float)rowMin) * <a class="code" href="namespaceanonymous__namespace_02ImageUtils_8cpp_03.html#a5caa4b40191551ab3efb0d3feb4ba60e">r2</a>;
                }
            }
        }

        <span class="keywordflow">return</span> result;
    }
</pre></div>
</div>
</div>
<a class="anchor" id="ac94e72a3459c0f65ac1867f184a7091c"></a><!-- doxytag: member="GDALTileSource::getPalleteIndexColor" ref="ac94e72a3459c0f65ac1867f184a7091c" args="(GDALRasterBand *band, int index, osg::Vec4ub &amp;color)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void GDALTileSource::getPalleteIndexColor </td>
          <td>(</td>
          <td class="paramtype">GDALRasterBand *&#160;</td>
          <td class="paramname"><em>band</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">osg::Vec4ub &amp;&#160;</td>
          <td class="paramname"><em>color</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ReaderWriterGDAL_8cpp_source.html#l00935">935</a> of file <a class="el" href="ReaderWriterGDAL_8cpp_source.html">ReaderWriterGDAL.cpp</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <span class="keyword">const</span> GDALColorEntry *colorEntry = band-&gt;GetColorTable()-&gt;GetColorEntry( index );
        GDALPaletteInterp interp = band-&gt;GetColorTable()-&gt;GetPaletteInterpretation();
        <span class="keywordflow">if</span> (!colorEntry)
        {
            <span class="comment">//FIXME: What to do here?</span>

            <span class="comment">//OE_INFO &lt;&lt; &quot;NO COLOR ENTRY FOR COLOR &quot; &lt;&lt; rawImageData[i] &lt;&lt; std::endl;</span>
            color.r() = 255;
            color.g() = 0;
            color.b() = 0;
            color.a() = 1;

        }
        <span class="keywordflow">else</span>
        {
            <span class="keywordflow">if</span> (interp == GPI_RGB)
            {
                color.r() = colorEntry-&gt;c1;
                color.g() = colorEntry-&gt;c2;
                color.b() = colorEntry-&gt;c3;
                color.a() = colorEntry-&gt;c4;
            }
            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (interp == GPI_CMYK)
            {
                <span class="comment">// from wikipedia.org</span>
                <span class="keywordtype">short</span> C = colorEntry-&gt;c1;
                <span class="keywordtype">short</span> M = colorEntry-&gt;c2;
                <span class="keywordtype">short</span> Y = colorEntry-&gt;c3;
                <span class="keywordtype">short</span> K = colorEntry-&gt;c4;
                color.r() = 255 - C*(255 - K) - K;
                color.g() = 255 - M*(255 - K) - K;
                color.b() = 255 - Y*(255 - K) - K;
                color.a() = 255;
            }
            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (interp == GPI_HLS)
            {
                <span class="comment">// from easyrgb.com</span>
                <span class="keywordtype">float</span> H = colorEntry-&gt;c1;
                <span class="keywordtype">float</span> S = colorEntry-&gt;c3;
                <span class="keywordtype">float</span> L = colorEntry-&gt;c2;
                <span class="keywordtype">float</span> R, G, B;
                <span class="keywordflow">if</span> ( S == 0 )                       <span class="comment">//HSL values = 0 - 1</span>
                {
                    R = L;                      <span class="comment">//RGB results = 0 - 1 </span>
                    G = L;
                    B = L;
                }
                <span class="keywordflow">else</span>
                {
                    <span class="keywordtype">float</span> var_2, var_1;
                    <span class="keywordflow">if</span> ( L &lt; 0.5 )
                        var_2 = L * ( 1 + S );
                    <span class="keywordflow">else</span>
                        var_2 = ( L + S ) - ( S * L );

                    var_1 = 2 * L - var_2;

                    R = <a class="code" href="ReaderWriterGDAL_8cpp.html#a21f8643014eee62c9b06233460c886ee">Hue_2_RGB</a>( var_1, var_2, H + ( 1 / 3 ) );
                    G = <a class="code" href="ReaderWriterGDAL_8cpp.html#a21f8643014eee62c9b06233460c886ee">Hue_2_RGB</a>( var_1, var_2, H );
                    B = <a class="code" href="ReaderWriterGDAL_8cpp.html#a21f8643014eee62c9b06233460c886ee">Hue_2_RGB</a>( var_1, var_2, H - ( 1 / 3 ) );                                
                } 
                color.r() = <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span><span class="keyword">&gt;</span>(R*255.0f);
                color.g() = <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span><span class="keyword">&gt;</span>(G*255.0f);
                color.b() = <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span><span class="keyword">&gt;</span>(B*255.0f);
                color.a() = <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span><span class="keyword">&gt;</span>(255.0f);
            }
            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (interp == GPI_Gray)
            {
                color.r() = <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span><span class="keyword">&gt;</span>(colorEntry-&gt;c1*255.0f);
                color.g() = <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span><span class="keyword">&gt;</span>(colorEntry-&gt;c1*255.0f);
                color.b() = <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span><span class="keyword">&gt;</span>(colorEntry-&gt;c1*255.0f);
                color.a() = <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span><span class="keyword">&gt;</span>(255.0f);
            }
        }
    }
</pre></div>
<p><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classGDALTileSource_ac94e72a3459c0f65ac1867f184a7091c_cgraph.png" border="0" usemap="#classGDALTileSource_ac94e72a3459c0f65ac1867f184a7091c_cgraph" alt=""/></div>
<map name="classGDALTileSource_ac94e72a3459c0f65ac1867f184a7091c_cgraph" id="classGDALTileSource_ac94e72a3459c0f65ac1867f184a7091c_cgraph">
<area shape="rect" id="node3" href="ReaderWriterGDAL_8cpp.html#a21f8643014eee62c9b06233460c886ee" title="Hue_2_RGB" alt="" coords="304,5,400,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9fb5b232e7c2158f53938fe08d55d3a6"></a><!-- doxytag: member="GDALTileSource::initialize" ref="a9fb5b232e7c2158f53938fe08d55d3a6" args="(const std::string &amp;referenceURI, const Profile *overrideProfile)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GDALTileSource::initialize </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>referenceURI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classosgEarth_1_1Profile.html">Profile</a> *&#160;</td>
          <td class="paramname"><em>overrideProfile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Initialize the TileSource. The profile should be computed and set here using <a class="el" href="classosgEarth_1_1TileSource.html#acb961d2391ffbfec1ce0157c78537968">setProfile()</a> </p>

<p>Implements <a class="el" href="classosgEarth_1_1TileSource.html#a8392cb74f825d2321aea26b913f1f95e">osgEarth::TileSource</a>.</p>

<p>Definition at line <a class="el" href="ReaderWriterGDAL_8cpp_source.html#l00640">640</a> of file <a class="el" href="ReaderWriterGDAL_8cpp_source.html">ReaderWriterGDAL.cpp</a>.</p>
<div class="fragment"><pre class="fragment">    {   
        <a class="code" href="Registry.html#af57173fda5dd7d12d263f1adfbc69d52">GDAL_SCOPED_LOCK</a>;

        <span class="keywordflow">if</span> ( !<a class="code" href="classGDALTileSource.html#a1468ec932630f7f8ad705415a674322b">_options</a>.<a class="code" href="classosgEarth_1_1Drivers_1_1GDALOptions.html#aecef554e8c2f89222ee960e636f77e95">url</a>().<a class="code" href="structosgEarth_1_1optional.html#aa094207bf2b22a4848989cd017dc4365">isSet</a>() || <a class="code" href="classGDALTileSource.html#a1468ec932630f7f8ad705415a674322b">_options</a>.<a class="code" href="classosgEarth_1_1Drivers_1_1GDALOptions.html#aecef554e8c2f89222ee960e636f77e95">url</a>()-&gt;empty() )
        {
            <a class="code" href="Notify.html#a13b79c6470fc74594070bd2098afc9de">OE_WARN</a> &lt;&lt; <a class="code" href="ReaderWriterGDAL_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;No URL or directory specified &quot;</span> &lt;&lt; std::endl;
            <span class="keywordflow">return</span>;
        }

        <a class="code" href="classosgEarth_1_1URI.html">URI</a> uri = <a class="code" href="classGDALTileSource.html#a1468ec932630f7f8ad705415a674322b">_options</a>.<a class="code" href="classosgEarth_1_1Drivers_1_1GDALOptions.html#aecef554e8c2f89222ee960e636f77e95">url</a>().<a class="code" href="structosgEarth_1_1optional.html#a9e71f677728602dc521d7102c9be7820">value</a>();

        <span class="comment">//Find the full path to the URL</span>
        <span class="comment">//If we have a relative path and the map file contains a server address, just concat the server path and the _url together</span>

        <span class="keywordflow">if</span> (<a class="code" href="namespaceosgEarth.html#acc0e85b18ae98a28ccbc86d545e19a41">osgEarth::isRelativePath</a>(uri.<a class="code" href="classosgEarth_1_1URI.html#a68a86c3aca88042994c9f744e14dacab">full</a>()) &amp;&amp; osgDB::containsServerAddress(referenceURI))
        {
            uri = <a class="code" href="classosgEarth_1_1URI.html">URI</a>(osgDB::getFilePath(referenceURI) + std::string(<span class="stringliteral">&quot;/&quot;</span>) + uri.<a class="code" href="classosgEarth_1_1URI.html#a68a86c3aca88042994c9f744e14dacab">full</a>());
        }

        <span class="comment">//If the path doesn&#39;t contain a server address, get the full path to the file.</span>
        <span class="keywordflow">if</span> (!osgDB::containsServerAddress(uri.<a class="code" href="classosgEarth_1_1URI.html#a68a86c3aca88042994c9f744e14dacab">full</a>()))
        {
            uri = <a class="code" href="classosgEarth_1_1URI.html">URI</a>(uri.<a class="code" href="classosgEarth_1_1URI.html#a68a86c3aca88042994c9f744e14dacab">full</a>(), referenceURI);
        }

        <a class="code" href="classosgEarth_1_1StringTokenizer.html">StringTokenizer</a> izer( <span class="stringliteral">&quot;;&quot;</span> );
        <a class="code" href="namespaceosgEarth.html#a7e9e231014b3ed43b5b6c10b1deccf02">StringVector</a> exts;
        izer.tokenize( *<a class="code" href="classGDALTileSource.html#a1468ec932630f7f8ad705415a674322b">_options</a>.<a class="code" href="classosgEarth_1_1Drivers_1_1GDALOptions.html#a00a9d20874f2e3ff65f20884f97ddbaa">extensions</a>(), exts );

        <span class="comment">//std::vector&lt;std::string&gt; exts;</span>

        <span class="comment">//tokenize( _options.extensions().value(), exts, &quot;;&quot;);</span>
        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; exts.size(); ++i)
        {
            <a class="code" href="HTTPClient_8cpp.html#ac6600c2662696d8b43a4deb6877c8591">OE_DEBUG</a> &lt;&lt; <a class="code" href="ReaderWriterGDAL_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;Using Extension: &quot;</span> &lt;&lt; exts[i] &lt;&lt; std::endl;
        }
        std::vector&lt;std::string&gt; files;
        <a class="code" href="ReaderWriterGDAL_8cpp.html#ac62e0f57b436e675c3e0abfa6cf70bcd">getFiles</a>(uri.<a class="code" href="classosgEarth_1_1URI.html#a68a86c3aca88042994c9f744e14dacab">full</a>(), exts, files);

        <a class="code" href="Notify.html#a47e8673ea1af7af40d431820bf3856fa">OE_INFO</a> &lt;&lt; <a class="code" href="ReaderWriterGDAL_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;Driver found &quot;</span> &lt;&lt; files.size() &lt;&lt; <span class="stringliteral">&quot; files:&quot;</span> &lt;&lt; std::endl;
        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; files.size(); ++i)
        {
            <a class="code" href="Notify.html#a47e8673ea1af7af40d431820bf3856fa">OE_INFO</a> &lt;&lt; <a class="code" href="ReaderWriterGDAL_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;&quot;</span> &lt;&lt; files[i] &lt;&lt; std::endl;
        }

        <span class="keywordflow">if</span> (files.empty())
        {
            <a class="code" href="Notify.html#a13b79c6470fc74594070bd2098afc9de">OE_WARN</a> &lt;&lt; <a class="code" href="ReaderWriterGDAL_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;Could not find any valid files &quot;</span> &lt;&lt; std::endl;
            <span class="keywordflow">return</span>;
        }

        <span class="comment">//If we found more than one file, try to combine them into a single logical dataset</span>
        <span class="keywordflow">if</span> (files.size() &gt; 1)
        {
            <a class="code" href="classGDALTileSource.html#a9276a2e82ded000bf0a6a660b7690d0b">_srcDS</a> = (GDALDataset*)<a class="code" href="ReaderWriterGDAL_8cpp.html#aebb5d9c0c9beb918a5023662c07036a7">build_vrt</a>(files, <a class="code" href="ReaderWriterGDAL_8cpp.html#a0b3277d059f15626dce74d70e03e9b3ca0b18dd0a90d3271b1acd9a8a273b1f8b">HIGHEST_RESOLUTION</a>);
            <span class="keywordflow">if</span> (!<a class="code" href="classGDALTileSource.html#a9276a2e82ded000bf0a6a660b7690d0b">_srcDS</a>)
            {
                <a class="code" href="Notify.html#a13b79c6470fc74594070bd2098afc9de">OE_WARN</a> &lt;&lt; <span class="stringliteral">&quot;[osgEarth::GDAL] Failed to build VRT from input datasets&quot;</span> &lt;&lt; std::endl;
                <span class="keywordflow">return</span>;
            }
        }
        <span class="keywordflow">else</span>
        {
            <span class="comment">//If we couldn&#39;t build a VRT, just try opening the file directly</span>
            <span class="comment">//Open the dataset</span>
            <a class="code" href="classGDALTileSource.html#a9276a2e82ded000bf0a6a660b7690d0b">_srcDS</a> = (GDALDataset*)GDALOpen( files[0].c_str(), GA_ReadOnly );
            <span class="keywordflow">if</span> ( !<a class="code" href="classGDALTileSource.html#a9276a2e82ded000bf0a6a660b7690d0b">_srcDS</a> )
            {
                <a class="code" href="Notify.html#a13b79c6470fc74594070bd2098afc9de">OE_WARN</a> &lt;&lt; <a class="code" href="ReaderWriterGDAL_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;Failed to open dataset &quot;</span> &lt;&lt; files[0] &lt;&lt; std::endl;
                <span class="keywordflow">return</span>;
            }
        }

        <span class="comment">//Create a spatial reference for the source.</span>
        <span class="keyword">const</span> <span class="keywordtype">char</span>* srcProj = <a class="code" href="classGDALTileSource.html#a9276a2e82ded000bf0a6a660b7690d0b">_srcDS</a>-&gt;GetProjectionRef();
        <span class="keywordflow">if</span> ( srcProj != 0L &amp;&amp; overrideProfile != 0L )
        {
            <a class="code" href="Notify.html#a13b79c6470fc74594070bd2098afc9de">OE_WARN</a> &lt;&lt; <a class="code" href="ReaderWriterGDAL_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;WARNING, overriding profile of a source that already defines its own SRS (&quot;</span> 
                &lt;&lt; this-&gt;getName() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;
        }

        osg::ref_ptr&lt;const SpatialReference&gt; src_srs;
        <span class="keywordflow">if</span> ( overrideProfile )
        {
            src_srs = overrideProfile-&gt;<a class="code" href="classosgEarth_1_1Profile.html#a74622647d0d05b6823225a752ed7652b">getSRS</a>();
        }
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( srcProj )
        {
            src_srs = SpatialReference::create( srcProj );
        }
        
        <span class="comment">// assert SRS is present</span>
        <span class="keywordflow">if</span> ( !src_srs.valid() )
        {
            <span class="comment">// not found in the dataset; try loading a .prj file</span>
            std::string prjLocation = osgDB::getNameLessExtension( uri.<a class="code" href="classosgEarth_1_1URI.html#a68a86c3aca88042994c9f744e14dacab">full</a>() ) + std::string(<span class="stringliteral">&quot;.prj&quot;</span>);
            std::string wkt;
            <span class="keywordflow">if</span> ( HTTPClient::readString( prjLocation, wkt ) == HTTPClient::RESULT_OK )
            {
                src_srs = SpatialReference::create( wkt );
            }

            <span class="keywordflow">if</span> ( !src_srs.valid() )
            {
                <a class="code" href="Notify.html#a13b79c6470fc74594070bd2098afc9de">OE_WARN</a> &lt;&lt; <a class="code" href="ReaderWriterGDAL_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;Dataset has no spatial reference information: &quot;</span> &lt;&lt; uri.<a class="code" href="classosgEarth_1_1URI.html#a68a86c3aca88042994c9f744e14dacab">full</a>() &lt;&lt; std::endl;
                <span class="keywordflow">return</span>;
            }
        }

        <span class="keyword">const</span> <a class="code" href="classosgEarth_1_1Profile.html">Profile</a>* profile = <a class="code" href="Export.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;

        <span class="keywordflow">if</span> ( overrideProfile )
        {
            profile = overrideProfile;
        }

        <span class="keywordflow">if</span> ( !profile &amp;&amp; src_srs-&gt;isGeographic() )
        {
            profile = <a class="code" href="classosgEarth_1_1Registry.html#a92d21da82224d40008d7218eac280c09">osgEarth::Registry::instance</a>()-&gt;<a class="code" href="classosgEarth_1_1Registry.html#aa347b00b8aa5b7db6cd4c52ee5d63d5e">getGlobalGeodeticProfile</a>();
        }

        <span class="comment">//Note:  Can cause odd rendering artifacts if we have a dataset that is mercator that doesn&#39;t encompass the whole globe</span>
        <span class="comment">//       if we take on the global profile.</span>
        <span class="comment">/*</span>
<span class="comment">        if ( !profile &amp;&amp; src_srs-&gt;isMercator() )</span>
<span class="comment">        {</span>
<span class="comment">            profile = osgEarth::Registry::instance()-&gt;getGlobalMercatorProfile();</span>
<span class="comment">        }*/</span>

        std::string warpedSRSWKT;

        <span class="keywordflow">if</span> ( profile &amp;&amp; !profile-&gt;<a class="code" href="classosgEarth_1_1Profile.html#a74622647d0d05b6823225a752ed7652b">getSRS</a>()-&gt;<a class="code" href="classosgEarth_1_1SpatialReference.html#a398407559e7c170fc44cde6842511548">isEquivalentTo</a>( src_srs.get() ) )
        {
            <span class="keywordflow">if</span> ( profile-&gt;<a class="code" href="classosgEarth_1_1Profile.html#a74622647d0d05b6823225a752ed7652b">getSRS</a>()-&gt;<a class="code" href="classosgEarth_1_1SpatialReference.html#adfb00834f8d96146b119add7ec2c93a3">isGeographic</a>() &amp;&amp; (src_srs-&gt;isNorthPolar() || src_srs-&gt;isSouthPolar()) )
            {
                <a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a> = (GDALDataset*)<a class="code" href="ReaderWriterGDAL_8cpp.html#ae7b8646874765a8119e1ba247c9c6664">GDALAutoCreateWarpedVRTforPolarStereographic</a>(
                    <a class="code" href="classGDALTileSource.html#a9276a2e82ded000bf0a6a660b7690d0b">_srcDS</a>,
                    src_srs-&gt;getWKT().c_str(),
                    profile-&gt;<a class="code" href="classosgEarth_1_1Profile.html#a74622647d0d05b6823225a752ed7652b">getSRS</a>()-&gt;<a class="code" href="classosgEarth_1_1SpatialReference.html#a62d6dc2c358aaeeba591954de0475333">getWKT</a>().c_str(),
                    GRA_NearestNeighbour,
                    5.0,
                    <a class="code" href="Export.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
            }
            <span class="keywordflow">else</span>
            {
                <a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a> = (GDALDataset*)GDALAutoCreateWarpedVRT(
                    <a class="code" href="classGDALTileSource.html#a9276a2e82ded000bf0a6a660b7690d0b">_srcDS</a>,
                    src_srs-&gt;getWKT().c_str(),
                    profile-&gt;<a class="code" href="classosgEarth_1_1Profile.html#a74622647d0d05b6823225a752ed7652b">getSRS</a>()-&gt;<a class="code" href="classosgEarth_1_1SpatialReference.html#a62d6dc2c358aaeeba591954de0475333">getWKT</a>().c_str(),
                    GRA_NearestNeighbour,
                    5.0,
                    <a class="code" href="Export.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
            }

            <span class="keywordflow">if</span> ( <a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a> )
            {
                warpedSRSWKT = <a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>-&gt;GetProjectionRef();
            }

            <span class="comment">//GDALAutoCreateWarpedVRT(srcDS, src_wkt.c_str(), t_srs.c_str(), GRA_NearestNeighbour, 5.0, NULL);</span>
        }
        <span class="keywordflow">else</span>
        {
            <a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a> = <a class="code" href="classGDALTileSource.html#a9276a2e82ded000bf0a6a660b7690d0b">_srcDS</a>;            
            warpedSRSWKT = src_srs-&gt;getWKT();
        }

        <span class="comment">//Get the _geotransform</span>
        <span class="keywordflow">if</span> (overrideProfile)
        {        
            <a class="code" href="classGDALTileSource.html#a4d2872304a01d5f7ec59ae2301e80582">_geotransform</a>[0] = overrideProfile-&gt;<a class="code" href="classosgEarth_1_1Profile.html#af8ce182ba0e6f0e362046e593068955e">getExtent</a>().<a class="code" href="classosgEarth_1_1GeoExtent.html#ac421fa06a19aac8423f81ca35c4f507b">xMin</a>(); <span class="comment">//Top left x</span>
            <a class="code" href="classGDALTileSource.html#a4d2872304a01d5f7ec59ae2301e80582">_geotransform</a>[1] = overrideProfile-&gt;<a class="code" href="classosgEarth_1_1Profile.html#af8ce182ba0e6f0e362046e593068955e">getExtent</a>().<a class="code" href="classosgEarth_1_1GeoExtent.html#a1161940ef6756ba732ff7fc7da21db2d">width</a>() / (double)<a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>-&gt;GetRasterXSize();<span class="comment">//pixel width</span>
            <a class="code" href="classGDALTileSource.html#a4d2872304a01d5f7ec59ae2301e80582">_geotransform</a>[2] = 0;

            <a class="code" href="classGDALTileSource.html#a4d2872304a01d5f7ec59ae2301e80582">_geotransform</a>[3] = overrideProfile-&gt;<a class="code" href="classosgEarth_1_1Profile.html#af8ce182ba0e6f0e362046e593068955e">getExtent</a>().<a class="code" href="classosgEarth_1_1GeoExtent.html#aa64e915bc55e7390c60f99962ff1cccc">yMax</a>(); <span class="comment">//Top left y</span>
            <a class="code" href="classGDALTileSource.html#a4d2872304a01d5f7ec59ae2301e80582">_geotransform</a>[4] = 0;
            <a class="code" href="classGDALTileSource.html#a4d2872304a01d5f7ec59ae2301e80582">_geotransform</a>[5] = -overrideProfile-&gt;<a class="code" href="classosgEarth_1_1Profile.html#af8ce182ba0e6f0e362046e593068955e">getExtent</a>().<a class="code" href="classosgEarth_1_1GeoExtent.html#a9ed09180cbcdd15321ced7b24f4c4c9d">height</a>() / (double)<a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>-&gt;GetRasterYSize();<span class="comment">//pixel height</span>

        }
        <span class="keywordflow">else</span>
        {
            <a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>-&gt;GetGeoTransform(<a class="code" href="classGDALTileSource.html#a4d2872304a01d5f7ec59ae2301e80582">_geotransform</a>);
        }

        GDALInvGeoTransform(<a class="code" href="classGDALTileSource.html#a4d2872304a01d5f7ec59ae2301e80582">_geotransform</a>, <a class="code" href="classGDALTileSource.html#adec1aa793d326aba6b542e29e25f63d2">_invtransform</a>);


        <span class="comment">//Compute the extents</span>
        <span class="comment">// polar needs a special case when combined with geographic</span>
        <span class="keywordflow">if</span> ( profile &amp;&amp; profile-&gt;<a class="code" href="classosgEarth_1_1Profile.html#a74622647d0d05b6823225a752ed7652b">getSRS</a>()-&gt;<a class="code" href="classosgEarth_1_1SpatialReference.html#adfb00834f8d96146b119add7ec2c93a3">isGeographic</a>() &amp;&amp; (src_srs-&gt;isNorthPolar() || src_srs-&gt;isSouthPolar()) )
        {
            <span class="keywordtype">double</span> ll_lon, ll_lat, ul_lon, ul_lat, ur_lon, ur_lat, lr_lon, lr_lat;

            <a class="code" href="classGDALTileSource.html#aabb4f66070b4a3b69dc394f9a1340fa7">pixelToGeo</a>(0.0, 0.0, ul_lon, ul_lat );
            <a class="code" href="classGDALTileSource.html#aabb4f66070b4a3b69dc394f9a1340fa7">pixelToGeo</a>(0.0, <a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>-&gt;GetRasterYSize(), ll_lon, ll_lat);
            <a class="code" href="classGDALTileSource.html#aabb4f66070b4a3b69dc394f9a1340fa7">pixelToGeo</a>(<a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>-&gt;GetRasterXSize(), <a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>-&gt;GetRasterYSize(), lr_lon, lr_lat);
            <a class="code" href="classGDALTileSource.html#aabb4f66070b4a3b69dc394f9a1340fa7">pixelToGeo</a>(<a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>-&gt;GetRasterXSize(), 0.0, ur_lon, ur_lat);

            <a class="code" href="classGDALTileSource.html#ac3d93f74337fa4e76bd23a156e435a35">_extentsMin</a>.x() = osg::minimum( ll_lon, osg::minimum( ul_lon, osg::minimum( ur_lon, lr_lon ) ) );
            <a class="code" href="classGDALTileSource.html#a75b40bcb84baf3b142225102ccee38ef">_extentsMax</a>.x() = osg::maximum( ll_lon, osg::maximum( ul_lon, osg::maximum( ur_lon, lr_lon ) ) );
            
            <span class="keywordflow">if</span> ( src_srs-&gt;isNorthPolar() )
            {
                <a class="code" href="classGDALTileSource.html#ac3d93f74337fa4e76bd23a156e435a35">_extentsMin</a>.y() = osg::minimum( ll_lat, osg::minimum( ul_lat, osg::minimum( ur_lat, lr_lat ) ) );
                <a class="code" href="classGDALTileSource.html#a75b40bcb84baf3b142225102ccee38ef">_extentsMax</a>.y() = 90.0;
            }
            <span class="keywordflow">else</span>
            {
                <a class="code" href="classGDALTileSource.html#ac3d93f74337fa4e76bd23a156e435a35">_extentsMin</a>.y() = -90.0;
                <a class="code" href="classGDALTileSource.html#a75b40bcb84baf3b142225102ccee38ef">_extentsMax</a>.y() = osg::maximum( ll_lat, osg::maximum( ul_lat, osg::maximum( ur_lat, lr_lat ) ) );
            }
        }
        <span class="keywordflow">else</span>
        {
            <a class="code" href="classGDALTileSource.html#aabb4f66070b4a3b69dc394f9a1340fa7">pixelToGeo</a>(0.0, <a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>-&gt;GetRasterYSize(), <a class="code" href="classGDALTileSource.html#ac3d93f74337fa4e76bd23a156e435a35">_extentsMin</a>.x(), <a class="code" href="classGDALTileSource.html#ac3d93f74337fa4e76bd23a156e435a35">_extentsMin</a>.y());
            <a class="code" href="classGDALTileSource.html#aabb4f66070b4a3b69dc394f9a1340fa7">pixelToGeo</a>(<a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>-&gt;GetRasterXSize(), 0.0, <a class="code" href="classGDALTileSource.html#a75b40bcb84baf3b142225102ccee38ef">_extentsMax</a>.x(), <a class="code" href="classGDALTileSource.html#a75b40bcb84baf3b142225102ccee38ef">_extentsMax</a>.y());
        }

        <a class="code" href="Notify.html#a47e8673ea1af7af40d431820bf3856fa">OE_INFO</a> &lt;&lt; <a class="code" href="ReaderWriterGDAL_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;Geo extents: &quot;</span> &lt;&lt; <a class="code" href="classGDALTileSource.html#ac3d93f74337fa4e76bd23a156e435a35">_extentsMin</a>.x() &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code" href="classGDALTileSource.html#ac3d93f74337fa4e76bd23a156e435a35">_extentsMin</a>.y() &lt;&lt; <span class="stringliteral">&quot; =&gt; &quot;</span> &lt;&lt; <a class="code" href="classGDALTileSource.html#a75b40bcb84baf3b142225102ccee38ef">_extentsMax</a>.x() &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code" href="classGDALTileSource.html#a75b40bcb84baf3b142225102ccee38ef">_extentsMax</a>.y() &lt;&lt; std::endl;

        <span class="keywordflow">if</span> ( !profile )
        {
            profile = Profile::create( 
                warpedSRSWKT,
                <span class="comment">//_warpedDS-&gt;GetProjectionRef(),</span>
                <a class="code" href="classGDALTileSource.html#ac3d93f74337fa4e76bd23a156e435a35">_extentsMin</a>.x(), <a class="code" href="classGDALTileSource.html#ac3d93f74337fa4e76bd23a156e435a35">_extentsMin</a>.y(), <a class="code" href="classGDALTileSource.html#a75b40bcb84baf3b142225102ccee38ef">_extentsMax</a>.x(), <a class="code" href="classGDALTileSource.html#a75b40bcb84baf3b142225102ccee38ef">_extentsMax</a>.y() );

            <a class="code" href="Notify.html#a47e8673ea1af7af40d431820bf3856fa">OE_INFO</a> &lt;&lt; <a class="code" href="ReaderWriterGDAL_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;&quot;</span> &lt;&lt; uri.<a class="code" href="classosgEarth_1_1URI.html#a68a86c3aca88042994c9f744e14dacab">full</a>() &lt;&lt; <span class="stringliteral">&quot; is projected, SRS = &quot;</span> 
                &lt;&lt; warpedSRSWKT &lt;&lt; std::endl;
                <span class="comment">//&lt;&lt; _warpedDS-&gt;GetProjectionRef() &lt;&lt; std::endl;</span>
        }

        <span class="comment">//Compute the min and max data levels</span>
        <span class="keywordtype">double</span> resolutionX = (<a class="code" href="classGDALTileSource.html#a75b40bcb84baf3b142225102ccee38ef">_extentsMax</a>.x() - <a class="code" href="classGDALTileSource.html#ac3d93f74337fa4e76bd23a156e435a35">_extentsMin</a>.x()) / (<span class="keywordtype">double</span>)<a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>-&gt;GetRasterXSize();
        <span class="keywordtype">double</span> resolutionY = (<a class="code" href="classGDALTileSource.html#a75b40bcb84baf3b142225102ccee38ef">_extentsMax</a>.y() - <a class="code" href="classGDALTileSource.html#ac3d93f74337fa4e76bd23a156e435a35">_extentsMin</a>.y()) / (<span class="keywordtype">double</span>)<a class="code" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">_warpedDS</a>-&gt;GetRasterYSize();

                <span class="keywordtype">double</span> maxResolution = osg::minimum(resolutionX, resolutionY);

        <a class="code" href="Notify.html#a47e8673ea1af7af40d431820bf3856fa">OE_INFO</a> &lt;&lt; <a class="code" href="ReaderWriterGDAL_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;Resolution= &quot;</span> &lt;&lt; resolutionX &lt;&lt; <span class="stringliteral">&quot;x&quot;</span> &lt;&lt; resolutionY &lt;&lt; <span class="stringliteral">&quot; max=&quot;</span> &lt;&lt; maxResolution &lt;&lt; std::endl;

        <span class="keywordflow">if</span> (<a class="code" href="classGDALTileSource.html#a1468ec932630f7f8ad705415a674322b">_options</a>.<a class="code" href="classosgEarth_1_1Drivers_1_1GDALOptions.html#af40492a6200fbcf3d8e253742022d905">maxDataLevel</a>().<a class="code" href="structosgEarth_1_1optional.html#aa094207bf2b22a4848989cd017dc4365">isSet</a>())
        {
            <a class="code" href="classGDALTileSource.html#aa62292c4680be31c6b53327b2cb2adba">_maxDataLevel</a> = <a class="code" href="classGDALTileSource.html#a1468ec932630f7f8ad705415a674322b">_options</a>.<a class="code" href="classosgEarth_1_1Drivers_1_1GDALOptions.html#af40492a6200fbcf3d8e253742022d905">maxDataLevel</a>().<a class="code" href="structosgEarth_1_1optional.html#a9e71f677728602dc521d7102c9be7820">value</a>();
            <a class="code" href="Notify.html#a47e8673ea1af7af40d431820bf3856fa">OE_INFO</a> &lt;&lt; <span class="stringliteral">&quot;Using override max data level &quot;</span> &lt;&lt; <a class="code" href="classGDALTileSource.html#aa62292c4680be31c6b53327b2cb2adba">_maxDataLevel</a> &lt;&lt; std::endl;
        }
        <span class="keywordflow">else</span>
        {
            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> max_level = 30;
            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; max_level; ++i)
            {
                <a class="code" href="classGDALTileSource.html#aa62292c4680be31c6b53327b2cb2adba">_maxDataLevel</a> = i;
                <span class="keywordtype">double</span> w, h;
                profile-&gt;<a class="code" href="classosgEarth_1_1Profile.html#a08d430026dd8db56e86000bedfb94e07">getTileDimensions</a>(i, w, h);
                <span class="keywordtype">double</span> resX = (w / (double)<a class="code" href="classGDALTileSource.html#a1468ec932630f7f8ad705415a674322b">_options</a>.<a class="code" href="classosgEarth_1_1TileSourceOptions.html#a408fb6362b758888204763465a986346">tileSize</a>().<a class="code" href="structosgEarth_1_1optional.html#a9e71f677728602dc521d7102c9be7820">value</a>() );
                <span class="keywordtype">double</span> resY = (h / (double)<a class="code" href="classGDALTileSource.html#a1468ec932630f7f8ad705415a674322b">_options</a>.<a class="code" href="classosgEarth_1_1TileSourceOptions.html#a408fb6362b758888204763465a986346">tileSize</a>().<a class="code" href="structosgEarth_1_1optional.html#a9e71f677728602dc521d7102c9be7820">value</a>() );

                <span class="keywordflow">if</span> (resX &lt; maxResolution || resY &lt; maxResolution)
                {
                    <span class="keywordflow">break</span>;
                }
            }

            <a class="code" href="Notify.html#a47e8673ea1af7af40d431820bf3856fa">OE_INFO</a> &lt;&lt; <a class="code" href="ReaderWriterGDAL_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;Max Data Level: &quot;</span> &lt;&lt; <a class="code" href="classGDALTileSource.html#aa62292c4680be31c6b53327b2cb2adba">_maxDataLevel</a> &lt;&lt; std::endl;
        }

        <span class="comment">// record the data extent in profile space:</span>
        <a class="code" href="classosgEarth_1_1GeoExtent.html">GeoExtent</a> local_extent(
            SpatialReference::create( warpedSRSWKT ), <span class="comment">//_warpedDS-&gt;GetProjectionRef() ),</span>
            <a class="code" href="classGDALTileSource.html#ac3d93f74337fa4e76bd23a156e435a35">_extentsMin</a>.x(), <a class="code" href="classGDALTileSource.html#ac3d93f74337fa4e76bd23a156e435a35">_extentsMin</a>.y(), <a class="code" href="classGDALTileSource.html#a75b40bcb84baf3b142225102ccee38ef">_extentsMax</a>.x(), <a class="code" href="classGDALTileSource.html#a75b40bcb84baf3b142225102ccee38ef">_extentsMax</a>.y() );
        <a class="code" href="classosgEarth_1_1GeoExtent.html">GeoExtent</a> profile_extent = local_extent.<a class="code" href="classosgEarth_1_1GeoExtent.html#a279160f409098609ad030cf7b3e7bf9d">transform</a>( profile-&gt;<a class="code" href="classosgEarth_1_1Profile.html#a74622647d0d05b6823225a752ed7652b">getSRS</a>() );

        <a class="code" href="classosgEarth_1_1TileSource.html#afd46f82db0a11f11b39c07ca93103f6e">getDataExtents</a>().push_back( <a class="code" href="classosgEarth_1_1DataExtent.html">DataExtent</a>(profile_extent, 0, <a class="code" href="classGDALTileSource.html#aa62292c4680be31c6b53327b2cb2adba">_maxDataLevel</a>) );
        
        <a class="code" href="Notify.html#a47e8673ea1af7af40d431820bf3856fa">OE_INFO</a> &lt;&lt; <a class="code" href="ReaderWriterGDAL_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;Data Extents: &quot;</span> &lt;&lt; profile_extent.toString() &lt;&lt; std::endl;

                <span class="comment">//Set the profile</span>
                <a class="code" href="classosgEarth_1_1TileSource.html#acb961d2391ffbfec1ce0157c78537968">setProfile</a>( profile );
    }
</pre></div>
<p><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classGDALTileSource_a9fb5b232e7c2158f53938fe08d55d3a6_cgraph.png" border="0" usemap="#classGDALTileSource_a9fb5b232e7c2158f53938fe08d55d3a6_cgraph" alt=""/></div>
<map name="classGDALTileSource_a9fb5b232e7c2158f53938fe08d55d3a6_cgraph" id="classGDALTileSource_a9fb5b232e7c2158f53938fe08d55d3a6_cgraph">
<area shape="rect" id="node3" href="ReaderWriterGDAL_8cpp.html#aebb5d9c0c9beb918a5023662c07036a7" title="build_vrt" alt="" coords="356,5,425,35"/><area shape="rect" id="node5" href="classosgEarth_1_1URI.html#a68a86c3aca88042994c9f744e14dacab" title="osgEarth::URI::full" alt="" coords="325,59,456,88"/><area shape="rect" id="node7" href="ReaderWriterGDAL_8cpp.html#ae7b8646874765a8119e1ba247c9c6664" title="GDALAutoCreateWarpedVRTforPolarStereographic" alt="" coords="231,112,551,141"/><area shape="rect" id="node9" href="classosgEarth_1_1Profile.html#af8ce182ba0e6f0e362046e593068955e" title="osgEarth::Profile::getExtent" alt="" coords="300,165,481,195"/><area shape="rect" id="node11" href="ReaderWriterGDAL_8cpp.html#ac62e0f57b436e675c3e0abfa6cf70bcd" title="getFiles" alt="" coords="357,219,424,248"/><area shape="rect" id="node13" href="classosgEarth_1_1Registry.html#aa347b00b8aa5b7db6cd4c52ee5d63d5e" title="osgEarth::Registry::getGlobalGeodeticProfile" alt="" coords="249,373,532,403"/><area shape="rect" id="node36" href="classosgEarth_1_1Registry.html#a92d21da82224d40008d7218eac280c09" title="osgEarth::Registry::instance" alt="" coords="1319,160,1505,189"/><area shape="rect" id="node49" href="classosgEarth_1_1SpatialReference.html#adfb00834f8d96146b119add7ec2c93a3" title="osgEarth::SpatialReference::isGeographic" alt="" coords="1279,528,1545,557"/><area shape="rect" id="node52" href="classosgEarth_1_1GeoExtent.html#a279160f409098609ad030cf7b3e7bf9d" title="osgEarth::GeoExtent::transform" alt="" coords="1309,424,1515,453"/><area shape="rect" id="node56" href="classosgEarth_1_1Profile.html#a74622647d0d05b6823225a752ed7652b" title="osgEarth::Profile::getSRS" alt="" coords="980,320,1153,349"/><area shape="rect" id="node59" href="classosgEarth_1_1Profile.html#a08d430026dd8db56e86000bedfb94e07" title="osgEarth::Profile::getTileDimensions" alt="" coords="273,733,508,763"/><area shape="rect" id="node63" href="classosgEarth_1_1GeoExtent.html#ac421fa06a19aac8423f81ca35c4f507b" title="osgEarth::GeoExtent::xMin" alt="" coords="649,685,828,715"/><area shape="rect" id="node65" href="classosgEarth_1_1GeoExtent.html#aa64e915bc55e7390c60f99962ff1cccc" title="osgEarth::GeoExtent::yMax" alt="" coords="647,845,831,875"/><area shape="rect" id="node69" href="classosgEarth_1_1SpatialReference.html#a62d6dc2c358aaeeba591954de0475333" title="osgEarth::SpatialReference::getWKT" alt="" coords="1293,581,1531,611"/><area shape="rect" id="node72" href="classosgEarth_1_1GeoExtent.html#a9ed09180cbcdd15321ced7b24f4c4c9d" title="osgEarth::GeoExtent::height" alt="" coords="297,837,484,867"/><area shape="rect" id="node75" href="classosgEarth_1_1SpatialReference.html#a398407559e7c170fc44cde6842511548" title="osgEarth::SpatialReference::isEquivalentTo" alt="" coords="601,632,876,661"/><area shape="rect" id="node106" href="namespaceosgEarth.html#acc0e85b18ae98a28ccbc86d545e19a41" title="osgEarth::isRelativePath" alt="" coords="308,891,473,920"/><area shape="rect" id="node108" href="classosgEarth_1_1StringTokenizer.html#ac20faef1c2f38d976a47ac81c85798d1" title="osgEarth::StringTokenizer::tokenize" alt="" coords="276,944,505,973"/><area shape="rect" id="node115" href="classosgEarth_1_1GeoExtent.html#a1161940ef6756ba732ff7fc7da21db2d" title="osgEarth::GeoExtent::width" alt="" coords="300,997,481,1027"/><area shape="rect" id="node15" href="classosgEarth_1_1Profile.html#a3d862455737d2b9f813a078f9ec22752" title="osgEarth::Profile::create" alt="" coords="657,373,820,403"/><area shape="rect" id="node17" href="classosgEarth_1_1VerticalSpatialReference.html#a9acfa96c19f41c37fe4ac55493440b44" title="osgEarth::VerticalSpatialReference::create" alt="" coords="932,267,1201,296"/><area shape="rect" id="node26" href="classosgEarth_1_1SpatialReference.html#a6f0818e362f23b50606b0e4f66773da1" title="osgEarth::SpatialReference::create" alt="" coords="953,477,1180,507"/><area shape="rect" id="node32" href="classosgEarth_1_1Profile.html#abd4572b378cfd1f2a671774e9650e5b1" title="osgEarth::Profile::Profile" alt="" coords="985,373,1148,403"/><area shape="rect" id="node19" href="classosgEarth_1_1Geoid.html#a416fbcb1c9daf8a9380a1f427ad4649c" title="osgEarth::Geoid::getName" alt="" coords="1636,265,1812,295"/><area shape="rect" id="node21" href="classosgEarth_1_1VerticalSpatialReference.html#a2bbc5770a11ffef3e170ade273b9e935" title="osgEarth::VerticalSpatialReference::registerGeoid" alt="" coords="1257,317,1567,347"/><area shape="rect" id="node24" href="namespaceosgEarth.html#a4c5320dc9ca7ee620ce2262d72fff769" title="osgEarth::startsWith" alt="" coords="1341,264,1483,293"/><area shape="rect" id="node28" href="classosgEarth_1_1SpatialReference.html#ad4674227fe46613b3f5821109a509714" title="osgEarth::SpatialReference::init" alt="" coords="1621,741,1827,771"/><area shape="rect" id="node30" href="classosgEarth_1_1SpatialReference.html#ae8cda9f2cf24a92d09c58462c5fbd5e8" title="osgEarth::SpatialReference::_init" alt="" coords="1937,741,2151,771"/><area shape="rect" id="node34" href="classosgEarth_1_1GeoExtent.html#a77766059cde5244c2bc309cfa50800c3" title="osgEarth::GeoExtent::getSRS" alt="" coords="1313,371,1511,400"/><area shape="rect" id="node38" href="classosgEarth_1_1Registry.html#acb15d8aa051bf36ea92a86ee6c00bc3c" title="osgEarth::Registry::Registry" alt="" coords="1631,160,1817,189"/><area shape="rect" id="node40" href="classosgEarth_1_1Registry.html#a5a56910fe4fcb016cbae8e7728e8bf47" title="osgEarth::Registry::addMimeTypeExtensionMapping" alt="" coords="1880,187,2208,216"/><area shape="rect" id="node43" href="classosgEarth_1_1DiskCacheOptions.html#a89cba75c20b7201cebec071d7e68883c" title="osgEarth::DiskCacheOptions::path" alt="" coords="1932,240,2156,269"/><area shape="rect" id="node45" href="classosgEarth_1_1Registry.html#a958fd3968bf858d536d8468a330c66da" title="osgEarth::Registry::setCacheOverride" alt="" coords="1923,80,2165,109"/><area shape="rect" id="node47" href="classosgEarth_1_1DiskCacheOptions.html#af3b83ff8d6fb16c2f8688b51cbeceea2" title="osgEarth::DiskCacheOptions::setPath" alt="" coords="1921,133,2167,163"/><area shape="rect" id="node54" href="classosgEarth_1_1GeoExtent.html#a11d477896ee28030e4641760c737aab7" title="osgEarth::GeoExtent::GeoExtent" alt="" coords="1617,424,1831,453"/><area shape="rect" id="node61" href="classosgEarth_1_1GeoExtent.html#a91457972e7827ea655db19203e63db00" title="osgEarth::GeoExtent::xMax" alt="" coords="647,739,831,768"/><area shape="rect" id="node67" href="classosgEarth_1_1GeoExtent.html#a7d9c1d5fc6c411bb01964350dcb48a8c" title="osgEarth::GeoExtent::yMin" alt="" coords="649,792,828,821"/><area shape="rect" id="node77" href="classosgEarth_1_1SpatialReference.html#afe559cd555e232b45109fbce72742b02" title="osgEarth::SpatialReference::_isEquivalentTo" alt="" coords="925,741,1208,771"/><area shape="rect" id="node79" href="classosgEarth_1_1SpatialReference.html#ad7d6ef0605664b77e8348df5324ea32f" title="osgEarth::SpatialReference::getEllipsoid" alt="" coords="1284,955,1540,984"/><area shape="rect" id="node83" href="classosgEarth_1_1SpatialReference.html#a7e2212a07fe863d5680b73f1e76cdee2" title="osgEarth::SpatialReference::isContiguous" alt="" coords="1279,1008,1545,1037"/><area shape="rect" id="node86" href="classosgEarth_1_1SpatialReference.html#a56b924155ab1745c5c9592269c6c147b" title="osgEarth::SpatialReference::isCube" alt="" coords="1297,635,1527,664"/><area shape="rect" id="node90" href="classosgEarth_1_1SpatialReference.html#a8531e5c5cfc660c195ec9a569ba28cab" title="osgEarth::SpatialReference::isLTP" alt="" coords="1300,795,1524,824"/><area shape="rect" id="node92" href="classosgEarth_1_1SpatialReference.html#a7b198b8e4dc79a8c4e04cee6b73c85c4" title="osgEarth::SpatialReference::isMercator" alt="" coords="1287,688,1537,717"/><area shape="rect" id="node95" href="classosgEarth_1_1SpatialReference.html#a3ac570432fd7345ac3f1fa3c400a5553" title="osgEarth::SpatialReference::isNorthPolar" alt="" coords="1281,741,1543,771"/><area shape="rect" id="node98" href="classosgEarth_1_1SpatialReference.html#ae913b39821f50acf4662194ef5bcd3c3" title="osgEarth::SpatialReference::isSouthPolar" alt="" coords="1280,848,1544,877"/><area shape="rect" id="node101" href="classosgEarth_1_1SpatialReference.html#a1cb6bf576e355f9e32b226e43311e359" title="osgEarth::SpatialReference::isUserDefined" alt="" coords="1276,901,1548,931"/><area shape="rect" id="node110" href="namespaceosgEarth.html#a0bcf40dbfb8d914b6322a874eb021f50" title="osgEarth::trim" alt="" coords="687,944,791,973"/><area shape="rect" id="node112" href="namespaceosgEarth_1_1Json.html#ac78f55a4c4e91e3fd75de3ad98b50bef" title="osgEarth::Json::in" alt="" coords="1003,1112,1131,1141"/><area shape="rect" id="node117" href="classosgEarth_1_1GeoExtent.html#a744d26309f6eddfd74b72a01c159dc79" title="osgEarth::GeoExtent::crossesDateLine" alt="" coords="613,997,864,1027"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9321c8275bee220769f928dbaeded77a"></a><!-- doxytag: member="GDALTileSource::intersects" ref="a9321c8275bee220769f928dbaeded77a" args="(const TileKey &amp;key)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool GDALTileSource::intersects </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classosgEarth_1_1TileKey.html">TileKey</a> &amp;&#160;</td>
          <td class="paramname"><em>key</em></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ReaderWriterGDAL_8cpp_source.html#l01506">1506</a> of file <a class="el" href="ReaderWriterGDAL_8cpp_source.html">ReaderWriterGDAL.cpp</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <span class="comment">//Get the native extents of the tile</span>
        <span class="keywordtype">double</span> xmin, ymin, xmax, ymax;
        key.<a class="code" href="classosgEarth_1_1TileKey.html#a44441e91bc4f46b997456786a0b749a4">getExtent</a>().<a class="code" href="classosgEarth_1_1GeoExtent.html#afa0bd831daf0541cbbb161763ed9291f">getBounds</a>(xmin, ymin, xmax, ymax);

        <span class="keywordflow">return</span> ! ( xmin &gt;= <a class="code" href="classGDALTileSource.html#a75b40bcb84baf3b142225102ccee38ef">_extentsMax</a>.x() || xmax &lt;= <a class="code" href="classGDALTileSource.html#ac3d93f74337fa4e76bd23a156e435a35">_extentsMin</a>.x() || ymin &gt;= <a class="code" href="classGDALTileSource.html#a75b40bcb84baf3b142225102ccee38ef">_extentsMax</a>.y() || ymax &lt;= <a class="code" href="classGDALTileSource.html#ac3d93f74337fa4e76bd23a156e435a35">_extentsMin</a>.y() );        
    }
</pre></div>
<p><div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png"/> Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classGDALTileSource_a9321c8275bee220769f928dbaeded77a_cgraph.png" border="0" usemap="#classGDALTileSource_a9321c8275bee220769f928dbaeded77a_cgraph" alt=""/></div>
<map name="classGDALTileSource_a9321c8275bee220769f928dbaeded77a_cgraph" id="classGDALTileSource_a9321c8275bee220769f928dbaeded77a_cgraph">
<area shape="rect" id="node3" href="classosgEarth_1_1GeoExtent.html#afa0bd831daf0541cbbb161763ed9291f" title="osgEarth::GeoExtent::getBounds" alt="" coords="241,5,455,35"/><area shape="rect" id="node5" href="classosgEarth_1_1TileKey.html#a44441e91bc4f46b997456786a0b749a4" title="osgEarth::TileKey::getExtent" alt="" coords="253,59,443,88"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2abc52e749f774e0b99e228b5b41d43f"></a><!-- doxytag: member="GDALTileSource::isValidValue" ref="a2abc52e749f774e0b99e228b5b41d43f" args="(float v, GDALRasterBand *band)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool GDALTileSource::isValidValue </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GDALRasterBand *&#160;</td>
          <td class="paramname"><em>band</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ReaderWriterGDAL_8cpp_source.html#l01299">1299</a> of file <a class="el" href="ReaderWriterGDAL_8cpp_source.html">ReaderWriterGDAL.cpp</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <a class="code" href="Registry.html#af57173fda5dd7d12d263f1adfbc69d52">GDAL_SCOPED_LOCK</a>;

        <span class="keywordtype">float</span> bandNoData = -32767.0f;
        <span class="keywordtype">int</span> success;
        <span class="keywordtype">float</span> value = band-&gt;GetNoDataValue(&amp;success);
        <span class="keywordflow">if</span> (success)
        {
            bandNoData = value;
        }

        <span class="comment">//Check to see if the value is equal to the bands specified no data</span>
        <span class="keywordflow">if</span> (bandNoData == v) <span class="keywordflow">return</span> <span class="keyword">false</span>;
        <span class="comment">//Check to see if the value is equal to the user specified nodata value</span>
        <span class="keywordflow">if</span> (<a class="code" href="classosgEarth_1_1TileSource.html#a5f19da39ca5bec66816d81b0d67184bd">getNoDataValue</a>() == v) <span class="keywordflow">return</span> <span class="keyword">false</span>;        

        <span class="comment">//Check to see if the user specified a custom min/max</span>
        <span class="keywordflow">if</span> (v &lt; <a class="code" href="classosgEarth_1_1TileSource.html#afebfffa0fc25c4fbc23014ee50b6223c">getNoDataMinValue</a>()) <span class="keywordflow">return</span> <span class="keyword">false</span>;
        <span class="keywordflow">if</span> (v &gt; <a class="code" href="classosgEarth_1_1TileSource.html#aa80026c86c8091bc7816cea4d9348dd1">getNoDataMaxValue</a>()) <span class="keywordflow">return</span> <span class="keyword">false</span>;

        <span class="comment">//Check within a sensible range</span>
        <span class="keywordflow">if</span> (v &lt; -32000) <span class="keywordflow">return</span> <span class="keyword">false</span>;
        <span class="keywordflow">if</span> (v &gt; 32000) <span class="keywordflow">return</span> <span class="keyword">false</span>;

        <span class="keywordflow">return</span> <span class="keyword">true</span>;
    }
</pre></div>
</div>
</div>
<a class="anchor" id="aabb4f66070b4a3b69dc394f9a1340fa7"></a><!-- doxytag: member="GDALTileSource::pixelToGeo" ref="aabb4f66070b4a3b69dc394f9a1340fa7" args="(double x, double y, double &amp;geoX, double &amp;geoY)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GDALTileSource::pixelToGeo </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>geoX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>geoY</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ReaderWriterGDAL_8cpp_source.html#l01013">1013</a> of file <a class="el" href="ReaderWriterGDAL_8cpp_source.html">ReaderWriterGDAL.cpp</a>.</p>
<div class="fragment"><pre class="fragment">    {
        geoX = <a class="code" href="classGDALTileSource.html#a4d2872304a01d5f7ec59ae2301e80582">_geotransform</a>[0] + <a class="code" href="classGDALTileSource.html#a4d2872304a01d5f7ec59ae2301e80582">_geotransform</a>[1] * x + <a class="code" href="classGDALTileSource.html#a4d2872304a01d5f7ec59ae2301e80582">_geotransform</a>[2] * y;
        geoY = <a class="code" href="classGDALTileSource.html#a4d2872304a01d5f7ec59ae2301e80582">_geotransform</a>[3] + <a class="code" href="classGDALTileSource.html#a4d2872304a01d5f7ec59ae2301e80582">_geotransform</a>[4] * x + <a class="code" href="classGDALTileSource.html#a4d2872304a01d5f7ec59ae2301e80582">_geotransform</a>[5] * y;
    }
</pre></div>
</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a75b40bcb84baf3b142225102ccee38ef"></a><!-- doxytag: member="GDALTileSource::_extentsMax" ref="a75b40bcb84baf3b142225102ccee38ef" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">osg::Vec2d <a class="el" href="classGDALTileSource.html#a75b40bcb84baf3b142225102ccee38ef">GDALTileSource::_extentsMax</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ReaderWriterGDAL_8cpp_source.html#l01524">1524</a> of file <a class="el" href="ReaderWriterGDAL_8cpp_source.html">ReaderWriterGDAL.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ac3d93f74337fa4e76bd23a156e435a35"></a><!-- doxytag: member="GDALTileSource::_extentsMin" ref="ac3d93f74337fa4e76bd23a156e435a35" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">osg::Vec2d <a class="el" href="classGDALTileSource.html#ac3d93f74337fa4e76bd23a156e435a35">GDALTileSource::_extentsMin</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ReaderWriterGDAL_8cpp_source.html#l01523">1523</a> of file <a class="el" href="ReaderWriterGDAL_8cpp_source.html">ReaderWriterGDAL.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a4d2872304a01d5f7ec59ae2301e80582"></a><!-- doxytag: member="GDALTileSource::_geotransform" ref="a4d2872304a01d5f7ec59ae2301e80582" args="[6]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classGDALTileSource.html#a4d2872304a01d5f7ec59ae2301e80582">GDALTileSource::_geotransform</a>[6]<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ReaderWriterGDAL_8cpp_source.html#l01520">1520</a> of file <a class="el" href="ReaderWriterGDAL_8cpp_source.html">ReaderWriterGDAL.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="adec1aa793d326aba6b542e29e25f63d2"></a><!-- doxytag: member="GDALTileSource::_invtransform" ref="adec1aa793d326aba6b542e29e25f63d2" args="[6]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classGDALTileSource.html#adec1aa793d326aba6b542e29e25f63d2">GDALTileSource::_invtransform</a>[6]<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ReaderWriterGDAL_8cpp_source.html#l01521">1521</a> of file <a class="el" href="ReaderWriterGDAL_8cpp_source.html">ReaderWriterGDAL.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="aa62292c4680be31c6b53327b2cb2adba"></a><!-- doxytag: member="GDALTileSource::_maxDataLevel" ref="aa62292c4680be31c6b53327b2cb2adba" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="classGDALTileSource.html#aa62292c4680be31c6b53327b2cb2adba">GDALTileSource::_maxDataLevel</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ReaderWriterGDAL_8cpp_source.html#l01534">1534</a> of file <a class="el" href="ReaderWriterGDAL_8cpp_source.html">ReaderWriterGDAL.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a1468ec932630f7f8ad705415a674322b"></a><!-- doxytag: member="GDALTileSource::_options" ref="a1468ec932630f7f8ad705415a674322b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classosgEarth_1_1Drivers_1_1GDALOptions.html">GDALOptions</a> <a class="el" href="classGDALTileSource.html#a1468ec932630f7f8ad705415a674322b">GDALTileSource::_options</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="classosgEarth_1_1TileSource.html#a1be7fb5a5cc81824f5dc282b5e96e2d0">osgEarth::TileSource</a>.</p>

<p>Definition at line <a class="el" href="ReaderWriterGDAL_8cpp_source.html#l01531">1531</a> of file <a class="el" href="ReaderWriterGDAL_8cpp_source.html">ReaderWriterGDAL.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a9276a2e82ded000bf0a6a660b7690d0b"></a><!-- doxytag: member="GDALTileSource::_srcDS" ref="a9276a2e82ded000bf0a6a660b7690d0b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GDALDataset* <a class="el" href="classGDALTileSource.html#a9276a2e82ded000bf0a6a660b7690d0b">GDALTileSource::_srcDS</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ReaderWriterGDAL_8cpp_source.html#l01518">1518</a> of file <a class="el" href="ReaderWriterGDAL_8cpp_source.html">ReaderWriterGDAL.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a97a7888e73cbb309c27de54d912e417e"></a><!-- doxytag: member="GDALTileSource::_warpedDS" ref="a97a7888e73cbb309c27de54d912e417e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GDALDataset* <a class="el" href="classGDALTileSource.html#a97a7888e73cbb309c27de54d912e417e">GDALTileSource::_warpedDS</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="ReaderWriterGDAL_8cpp_source.html#l01519">1519</a> of file <a class="el" href="ReaderWriterGDAL_8cpp_source.html">ReaderWriterGDAL.cpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/home/cube/sources/osgearth/src/osgEarthDrivers/gdal/<a class="el" href="ReaderWriterGDAL_8cpp_source.html">ReaderWriterGDAL.cpp</a></li>
</ul>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Wed Jan 18 2012 15:02:45 for osgEarth by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
