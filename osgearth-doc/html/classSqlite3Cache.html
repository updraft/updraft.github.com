<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>osgEarth: Sqlite3Cache Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = 'open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = 'closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">osgEarth&#160;<span id="projectnumber">2.1.1</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a>  </div>
  <div class="headertitle">
<h1>Sqlite3Cache Class Reference</h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="Sqlite3Cache" --><!-- doxytag: inherits="AsyncCache" --><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png"/> Inheritance diagram for Sqlite3Cache:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classSqlite3Cache__inherit__graph.png" border="0" usemap="#Sqlite3Cache_inherit__map" alt="Inheritance graph"/></div>
<map name="Sqlite3Cache_inherit__map" id="Sqlite3Cache_inherit__map">
<area shape="rect" id="node2" href="structAsyncCache.html" title="AsyncCache" alt="" coords="17,160,113,189"/><area shape="rect" id="node4" href="classosgEarth_1_1Cache.html" title="osgEarth::Cache" alt="" coords="5,83,125,112"/><area shape="rect" id="node6" href="classosg_1_1Object.html" title="Object" alt="" coords="36,5,95,35"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png"/> Collaboration diagram for Sqlite3Cache:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classSqlite3Cache__coll__graph.png" border="0" usemap="#Sqlite3Cache_coll__map" alt="Collaboration graph"/></div>
<map name="Sqlite3Cache_coll__map" id="Sqlite3Cache_coll__map">
<area shape="rect" id="node2" href="structAsyncCache.html" title="AsyncCache" alt="" coords="1652,61,1748,91"/><area shape="rect" id="node4" href="classosgEarth_1_1Cache.html" title="osgEarth::Cache" alt="" coords="1407,43,1527,72"/><area shape="rect" id="node6" href="classosg_1_1Object.html" title="Object" alt="" coords="1092,5,1151,35"/><area shape="rect" id="node8" href="classosgEarth_1_1CacheOptions.html" title="osgEarth::CacheOptions" alt="" coords="1039,64,1204,93"/><area shape="rect" id="node24" href="classosgEarth_1_1Drivers_1_1Sqlite3CacheOptions.html" title="osgEarth::Drivers::Sqlite3CacheOptions" alt="" coords="1340,124,1593,153"/><area shape="rect" id="node10" href="classosgEarth_1_1DriverConfigOptions.html" title="osgEarth::DriverConfigOptions" alt="" coords="693,64,893,93"/><area shape="rect" id="node12" href="classosgEarth_1_1ConfigOptions.html" title="osgEarth::ConfigOptions" alt="" coords="477,64,643,93"/><area shape="rect" id="node14" href="classosgEarth_1_1Config.html" title="osgEarth::Config" alt="" coords="275,64,395,93"/><area shape="rect" id="node16" href="structosgEarth_1_1Properties.html" title="osgEarth::Properties" alt="" coords="11,37,152,67"/><area shape="rect" id="node18" href="classosgEarth_1_1URIContext.html" title="osgEarth::URIContext" alt="" coords="5,91,157,120"/><area shape="rect" id="node20" href="structosgEarth_1_1optional.html" title="osgEarth::optional\&lt; bool \&gt;" alt="" coords="707,153,880,183"/><area shape="rect" id="node22" href="structMetadataTable.html" title="MetadataTable" alt="" coords="1647,184,1753,213"/><area shape="rect" id="node28" href="structosgEarth_1_1optional.html" title="osgEarth::optional\&lt; std::string \&gt;" alt="" coords="1017,117,1225,147"/><area shape="rect" id="node30" href="structosgEarth_1_1optional.html" title="osgEarth::optional\&lt; unsigned int \&gt;" alt="" coords="1011,253,1232,283"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>

<p><a href="classSqlite3Cache-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSqlite3Cache.html#ab0d138ebb2efebfb38e8a8554d2a3040">Sqlite3Cache</a> (const <a class="el" href="classosgEarth_1_1CacheOptions.html">CacheOptions</a> &amp;options)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSqlite3Cache.html#aa70593dcb551e4dbf6d5d682a5438e65">Sqlite3Cache</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSqlite3Cache.html#a97810f15a99259e571e3314772d1e368">Sqlite3Cache</a> (const <a class="el" href="classSqlite3Cache.html">Sqlite3Cache</a> &amp;rhs, const osg::CopyOp &amp;op)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSqlite3Cache.html#a872792861e1326f16472fd4abed297aa">META_Object</a> (osgEarth, <a class="el" href="classSqlite3Cache.html">Sqlite3Cache</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSqlite3Cache.html#af3a9636dbeb5b7263396143de9cc05cb">isCached</a> (const <a class="el" href="classosgEarth_1_1TileKey.html">TileKey</a> &amp;key, const <a class="el" href="structosgEarth_1_1CacheSpec.html">CacheSpec</a> &amp;spec) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSqlite3Cache.html#af1aad64b7e862b7fcba9aa570e1b4c2b">storeProperties</a> (const <a class="el" href="structosgEarth_1_1CacheSpec.html">CacheSpec</a> &amp;spec, const <a class="el" href="classosgEarth_1_1Profile.html">Profile</a> *profile, unsigned int tileSize)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSqlite3Cache.html#a4f9ed895ff5b41c1d4662b3a106b1b9f">loadProperties</a> (const std::string &amp;cacheId, <a class="el" href="structosgEarth_1_1CacheSpec.html">CacheSpec</a> &amp;out_spec, osg::ref_ptr&lt; const <a class="el" href="classosgEarth_1_1Profile.html">Profile</a> &gt; &amp;out_profile, unsigned int &amp;out_tileSize)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSqlite3Cache.html#abf68640f2e170e7deb7b7622b089aeb9">getImage</a> (const <a class="el" href="classosgEarth_1_1TileKey.html">TileKey</a> &amp;key, const <a class="el" href="structosgEarth_1_1CacheSpec.html">CacheSpec</a> &amp;spec, osg::ref_ptr&lt; const osg::Image &gt; &amp;out_image)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSqlite3Cache.html#a2ebee3ea5c2f531b22f484f4fba55a1a">setImage</a> (const <a class="el" href="classosgEarth_1_1TileKey.html">TileKey</a> &amp;key, const <a class="el" href="structosgEarth_1_1CacheSpec.html">CacheSpec</a> &amp;spec, const osg::Image *image)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSqlite3Cache.html#aa929c5104c0260ec8e391457cd821b3b">purge</a> (const std::string &amp;layerName, int olderThanUTC, bool async)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSqlite3Cache.html#acbae38c85f41b2587cda83978aafa4d9">updateAccessTimeSync</a> (const std::string &amp;layerName, const <a class="el" href="classosgEarth_1_1TileKey.html">TileKey</a> &amp;key, int newTimestamp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSqlite3Cache.html#ab3f46e1a54e231c29c03ed4af9ee57c8">updateAccessTimeSyncPool</a> (const std::string &amp;layerName, const std::string &amp;keys, int newTimestamp)</td></tr>
<tr><td colspan="2"><h2><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSqlite3Cache.html#a8bc188aa3883fb8f1d2ee80bdf5ddbe6">displayPendingOperations</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSqlite3Cache.html#a90410529af647e1e89b7f538226bda8d">setImageSync</a> (const <a class="el" href="classosgEarth_1_1TileKey.html">TileKey</a> &amp;key, const <a class="el" href="structosgEarth_1_1CacheSpec.html">CacheSpec</a> &amp;spec, const osg::Image *image)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">sqlite3 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSqlite3Cache.html#a875e3791f949911bdd5e452b549bb103">getOrCreateDbForThread</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structThreadTable.html">ThreadTable</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSqlite3Cache.html#acdc5a4cb14ffd6d76c192cb9412ac31c">getTable</a> (const std::string &amp;tableName)</td></tr>
<tr><td colspan="2"><h2><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classosgEarth_1_1Drivers_1_1Sqlite3CacheOptions.html">Sqlite3CacheOptions</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSqlite3Cache.html#a95fec1d09d3bdbda312cfd056e21a9ea">_options</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">osg::ref_ptr&lt; osgDB::ReaderWriter &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSqlite3Cache.html#a9f4f99694b5bb6634591999defa5bfd8">_defaultRW</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Mutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSqlite3Cache.html#a2729caca9fb6969a35b0a2e8f861dca7">_tableListMutex</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structMetadataTable.html">MetadataTable</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSqlite3Cache.html#a55ff6bdc4a42f4c563d945b406471724">_metadata</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="Sqlite3Cache_8cpp.html#ab4c3e380718b3ebc1a7ed02d2abbf5d3">LayerTablesByName</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSqlite3Cache.html#aad44ce7e38dc0e8eee6f7b712075008b">_tables</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSqlite3Cache.html#a5ac4caa8770a04dd9b6158515a2560a2">_useAsyncWrites</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">osg::ref_ptr&lt; <a class="el" href="classosgEarth_1_1TaskService.html">TaskService</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSqlite3Cache.html#acd31204ead71966342e4de852baeb883">_writeService</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Mutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSqlite3Cache.html#a50cf270b267e5bbff37f969585d5651a">_pendingWritesMutex</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::map&lt; std::string, <br class="typebreak"/>
osg::ref_ptr&lt; <a class="el" href="structAsyncInsert.html">AsyncInsert</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSqlite3Cache.html#a0390ac812d20df6392e65895e9c24430">_pendingWrites</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Mutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSqlite3Cache.html#a9126ddc09412dbdfb3237b3facbe9493">_pendingUpdateMutex</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::map&lt; std::string, <br class="typebreak"/>
osg::ref_ptr<br class="typebreak"/>
&lt; <a class="el" href="structAsyncUpdateAccessTimePool.html">AsyncUpdateAccessTimePool</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSqlite3Cache.html#a8195ac45f0906d0590895ea26b0d3be2">_pendingUpdates</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Mutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSqlite3Cache.html#a8ef69036bd80afb27fa315dd0c9660f8">_pendingPurgeMutex</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::map&lt; std::string, <br class="typebreak"/>
osg::ref_ptr&lt; <a class="el" href="structAsyncPurge.html">AsyncPurge</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSqlite3Cache.html#ad64ad74d8e1a495fdfcc25ead9767835">_pendingPurges</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">sqlite3 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSqlite3Cache.html#acf00e6024c4c7f21134569cf04f6c585">_db</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::map&lt; Thread *, sqlite3 * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSqlite3Cache.html#a8f28b37b8b43a71d421c481be30bc7d6">_dbPerThread</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::map&lt; std::string, <br class="typebreak"/>
std::map&lt; Thread *, sqlite3 * &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSqlite3Cache.html#a407e2a2f31bb145ed9daf6dba3e932a5">_dbPerThreadLayers</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::map&lt; Thread *, sqlite3 * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSqlite3Cache.html#abd2ad981c0a805610eb9bb7e06a33db2">_dbPerThreadMeta</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">osg::ref_ptr&lt; <a class="el" href="classosgEarth_1_1MemCache.html">MemCache</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSqlite3Cache.html#a6e5fad1caa31adb898b019eabedfee2b">_L2cache</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSqlite3Cache.html#a90bd42341b20a084ffba919f05569899">_count</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSqlite3Cache.html#accbae673eaedf4e1e7ae360694667fbb">_nbRequest</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSqlite3Cache.html#a135dcd824468908900882de31c1c673d">_layersList</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSqlite3Cache.html#a77d8fc6cdeb8091cb5c48c9dca0e59cd">_databasePath</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="Sqlite3Cache_8cpp_source.html#l01009">1009</a> of file <a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ab0d138ebb2efebfb38e8a8554d2a3040"></a><!-- doxytag: member="Sqlite3Cache::Sqlite3Cache" ref="ab0d138ebb2efebfb38e8a8554d2a3040" args="(const CacheOptions &amp;options)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Sqlite3Cache::Sqlite3Cache </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classosgEarth_1_1CacheOptions.html">CacheOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Sqlite3Cache_8cpp_source.html#l01012">1012</a> of file <a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a>.</p>
<div class="fragment"><pre class="fragment">      : <a class="code" href="structAsyncCache.html#aa8026cf7a6784b147ed6c645fe9da163">AsyncCache</a>(options), <a class="code" href="classSqlite3Cache.html#a95fec1d09d3bdbda312cfd056e21a9ea">_options</a>(options),  <a class="code" href="classSqlite3Cache.html#acf00e6024c4c7f21134569cf04f6c585">_db</a>(0L)
    {                
        <span class="keywordflow">if</span> ( <a class="code" href="classSqlite3Cache.html#a95fec1d09d3bdbda312cfd056e21a9ea">_options</a>.<a class="code" href="classosgEarth_1_1Drivers_1_1Sqlite3CacheOptions.html#abf017af4fe50b6eb404717c766fe20e8">path</a>().<a class="code" href="structosgEarth_1_1optional.html#ac10ed828e5fb151d8cabf856e1fc3d3e">get</a>().empty() || options.<a class="code" href="classosgEarth_1_1CacheOptions.html#a247eec7536f68bcf032b31350908a3f1">getReferenceURI</a>().empty() )
            <a class="code" href="classSqlite3Cache.html#a77d8fc6cdeb8091cb5c48c9dca0e59cd">_databasePath</a> = <a class="code" href="classSqlite3Cache.html#a95fec1d09d3bdbda312cfd056e21a9ea">_options</a>.<a class="code" href="classosgEarth_1_1Drivers_1_1Sqlite3CacheOptions.html#abf017af4fe50b6eb404717c766fe20e8">path</a>().<a class="code" href="structosgEarth_1_1optional.html#ac10ed828e5fb151d8cabf856e1fc3d3e">get</a>();
        <span class="keywordflow">else</span>
        {
           <a class="code" href="classSqlite3Cache.html#a77d8fc6cdeb8091cb5c48c9dca0e59cd">_databasePath</a> = <a class="code" href="namespaceosgEarth.html#ac14af30464b9b0b3791566e99e4a02de">osgEarth::getFullPath</a>( options.<a class="code" href="classosgEarth_1_1CacheOptions.html#a247eec7536f68bcf032b31350908a3f1">getReferenceURI</a>(), <a class="code" href="classSqlite3Cache.html#a95fec1d09d3bdbda312cfd056e21a9ea">_options</a>.<a class="code" href="classosgEarth_1_1Drivers_1_1Sqlite3CacheOptions.html#abf017af4fe50b6eb404717c766fe20e8">path</a>().<a class="code" href="structosgEarth_1_1optional.html#ac10ed828e5fb151d8cabf856e1fc3d3e">get</a>() );
        }

        
        setName( <span class="stringliteral">&quot;sqlite3&quot;</span> );

        <a class="code" href="classSqlite3Cache.html#accbae673eaedf4e1e7ae360694667fbb">_nbRequest</a> = 0;

        <span class="comment">//_settings = dynamic_cast&lt;const Sqlite3CacheOptions*&gt;( options );</span>
        <span class="comment">//if ( !_settings.valid() )</span>
        <span class="comment">//    _settings = new Sqlite3CacheOptions( options );</span>

        <a class="code" href="Notify.html#a47e8673ea1af7af40d431820bf3856fa">OE_INFO</a> &lt;&lt; <a class="code" href="Sqlite3Cache_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;options: &quot;</span> &lt;&lt; <a class="code" href="classSqlite3Cache.html#a95fec1d09d3bdbda312cfd056e21a9ea">_options</a>.<a class="code" href="classosgEarth_1_1Drivers_1_1Sqlite3CacheOptions.html#a10a233fc57fb45551d8fa7f7416cb969">getConfig</a>().<a class="code" href="classosgEarth_1_1Config.html#a1406b682afed108f9c10ffd09f18b464">toString</a>() &lt;&lt; std::endl;

        <span class="keywordflow">if</span> ( sqlite3_threadsafe() == 0 )
        {
            <a class="code" href="Notify.html#a13b79c6470fc74594070bd2098afc9de">OE_WARN</a> &lt;&lt; <a class="code" href="Sqlite3Cache_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;SQLITE3 IS NOT COMPILED IN THREAD-SAFE MODE&quot;</span> &lt;&lt; std::endl;
            <span class="comment">// TODO: something in this unlikely condition</span>
        }

        <span class="comment">// enabled shared cache mode.</span>
        <span class="comment">//sqlite3_enable_shared_cache( 1 );</span>

<span class="preprocessor">#ifdef USE_L2_CACHE</span>
<span class="preprocessor"></span>        <a class="code" href="classSqlite3Cache.html#a6e5fad1caa31adb898b019eabedfee2b">_L2cache</a> = <span class="keyword">new</span> <a class="code" href="classosgEarth_1_1MemCache.html">MemCache</a>();
        <a class="code" href="classSqlite3Cache.html#a6e5fad1caa31adb898b019eabedfee2b">_L2cache</a>-&gt;setMaxNumTilesInCache( 64 );
        <a class="code" href="Notify.html#a47e8673ea1af7af40d431820bf3856fa">OE_INFO</a> &lt;&lt; <a class="code" href="Sqlite3Cache_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;Using L2 memory cache&quot;</span> &lt;&lt; std::endl;
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>        
        <a class="code" href="classSqlite3Cache.html#acf00e6024c4c7f21134569cf04f6c585">_db</a> = <a class="code" href="Sqlite3Cache_8cpp.html#afef17696c900f53cb7b0f93889d7b577">openDatabase</a>( <a class="code" href="classSqlite3Cache.html#a77d8fc6cdeb8091cb5c48c9dca0e59cd">_databasePath</a>, <a class="code" href="classSqlite3Cache.html#a95fec1d09d3bdbda312cfd056e21a9ea">_options</a>.<a class="code" href="classosgEarth_1_1Drivers_1_1Sqlite3CacheOptions.html#a7e83266e6cb2bbb9d84ab8120ec6a9ec">serialized</a>().<a class="code" href="structosgEarth_1_1optional.html#a9e71f677728602dc521d7102c9be7820">value</a>() );

        <span class="keywordflow">if</span> ( <a class="code" href="classSqlite3Cache.html#acf00e6024c4c7f21134569cf04f6c585">_db</a> )
        {
            <span class="keywordflow">if</span> ( ! <a class="code" href="classSqlite3Cache.html#a55ff6bdc4a42f4c563d945b406471724">_metadata</a>.<a class="code" href="structMetadataTable.html#a9c5323d38308f66b5046e06522da4a0a">initialize</a>( <a class="code" href="classSqlite3Cache.html#acf00e6024c4c7f21134569cf04f6c585">_db</a> ) )
                <a class="code" href="classSqlite3Cache.html#acf00e6024c4c7f21134569cf04f6c585">_db</a> = 0L;
        }

        <span class="keywordflow">if</span> ( <a class="code" href="classSqlite3Cache.html#acf00e6024c4c7f21134569cf04f6c585">_db</a> &amp;&amp; <a class="code" href="classSqlite3Cache.html#a95fec1d09d3bdbda312cfd056e21a9ea">_options</a>.<a class="code" href="classosgEarth_1_1Drivers_1_1Sqlite3CacheOptions.html#a1fab653a686ab5eb8c997c01c9400190">asyncWrites</a>() == true )
        {
            <a class="code" href="classSqlite3Cache.html#acd31204ead71966342e4de852baeb883">_writeService</a> = <span class="keyword">new</span> <a class="code" href="classosgEarth_1_1TaskService.html">osgEarth::TaskService</a>( <span class="stringliteral">&quot;Sqlite3Cache Write Service&quot;</span>, 1 );
        }

        
        <span class="keywordflow">if</span> (!<a class="code" href="classSqlite3Cache.html#a55ff6bdc4a42f4c563d945b406471724">_metadata</a>.<a class="code" href="structMetadataTable.html#a71643428df05c7da56ead42123133612">loadAllLayers</a>( <a class="code" href="classSqlite3Cache.html#acf00e6024c4c7f21134569cf04f6c585">_db</a>, <a class="code" href="classSqlite3Cache.html#a135dcd824468908900882de31c1c673d">_layersList</a> )) {
            <a class="code" href="Notify.html#a13b79c6470fc74594070bd2098afc9de">OE_WARN</a> &lt;&lt; <span class="stringliteral">&quot;can&#39;t read layers in meta data&quot;</span> &lt;&lt; std::endl;
        }

    }
</pre></div>
<p><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classSqlite3Cache_ab0d138ebb2efebfb38e8a8554d2a3040_cgraph.png" border="0" usemap="#classSqlite3Cache_ab0d138ebb2efebfb38e8a8554d2a3040_cgraph" alt=""/></div>
<map name="classSqlite3Cache_ab0d138ebb2efebfb38e8a8554d2a3040_cgraph" id="classSqlite3Cache_ab0d138ebb2efebfb38e8a8554d2a3040_cgraph">
<area shape="rect" id="node3" href="namespaceosgEarth.html#ac14af30464b9b0b3791566e99e4a02de" title="osgEarth::getFullPath" alt="" coords="304,5,451,35"/><area shape="rect" id="node7" href="classosgEarth_1_1CacheOptions.html#a247eec7536f68bcf032b31350908a3f1" title="osgEarth::CacheOptions::getReferenceURI" alt="" coords="240,59,515,88"/><area shape="rect" id="node9" href="Sqlite3Cache_8cpp.html#afef17696c900f53cb7b0f93889d7b577" title="openDatabase" alt="" coords="324,112,431,141"/><area shape="rect" id="node5" href="namespaceosgEarth.html#acc0e85b18ae98a28ccbc86d545e19a41" title="osgEarth::isRelativePath" alt="" coords="564,5,729,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa70593dcb551e4dbf6d5d682a5438e65"></a><!-- doxytag: member="Sqlite3Cache::Sqlite3Cache" ref="aa70593dcb551e4dbf6d5d682a5438e65" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Sqlite3Cache::Sqlite3Cache </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Sqlite3Cache_8cpp_source.html#l01069">1069</a> of file <a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{ }
</pre></div>
</div>
</div>
<a class="anchor" id="a97810f15a99259e571e3314772d1e368"></a><!-- doxytag: member="Sqlite3Cache::Sqlite3Cache" ref="a97810f15a99259e571e3314772d1e368" args="(const Sqlite3Cache &amp;rhs, const osg::CopyOp &amp;op)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Sqlite3Cache::Sqlite3Cache </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classSqlite3Cache.html">Sqlite3Cache</a> &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const osg::CopyOp &amp;&#160;</td>
          <td class="paramname"><em>op</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Sqlite3Cache_8cpp_source.html#l01070">1070</a> of file <a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{ }
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a8bc188aa3883fb8f1d2ee80bdf5ddbe6"></a><!-- doxytag: member="Sqlite3Cache::displayPendingOperations" ref="a8bc188aa3883fb8f1d2ee80bdf5ddbe6" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Sqlite3Cache::displayPendingOperations </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Sqlite3Cache_8cpp_source.html#l01466">1466</a> of file <a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                                    {
        <span class="keywordflow">if</span> (<a class="code" href="classSqlite3Cache.html#a0390ac812d20df6392e65895e9c24430">_pendingWrites</a>.size())
            <a class="code" href="HTTPClient_8cpp.html#ac6600c2662696d8b43a4deb6877c8591">OE_DEBUG</a>&lt;&lt; <a class="code" href="Sqlite3Cache_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;pending insert &quot;</span> &lt;&lt; <a class="code" href="classSqlite3Cache.html#a0390ac812d20df6392e65895e9c24430">_pendingWrites</a>.size() &lt;&lt; std::endl;
        <span class="keywordflow">if</span> (<a class="code" href="classSqlite3Cache.html#a8195ac45f0906d0590895ea26b0d3be2">_pendingUpdates</a>.size())
            <a class="code" href="HTTPClient_8cpp.html#ac6600c2662696d8b43a4deb6877c8591">OE_DEBUG</a> &lt;&lt; <a class="code" href="Sqlite3Cache_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;pending update &quot;</span> &lt;&lt; <a class="code" href="classSqlite3Cache.html#a8195ac45f0906d0590895ea26b0d3be2">_pendingUpdates</a>.size() &lt;&lt; std::endl;
        <span class="keywordflow">if</span> (<a class="code" href="classSqlite3Cache.html#ad64ad74d8e1a495fdfcc25ead9767835">_pendingPurges</a>.size())
            <a class="code" href="HTTPClient_8cpp.html#ac6600c2662696d8b43a4deb6877c8591">OE_DEBUG</a> &lt;&lt; <a class="code" href="Sqlite3Cache_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;pending purge &quot;</span> &lt;&lt; <a class="code" href="classSqlite3Cache.html#ad64ad74d8e1a495fdfcc25ead9767835">_pendingPurges</a>.size() &lt;&lt; std::endl;
        <span class="comment">//OE_INFO &lt;&lt; LC &lt;&lt; &quot;Pending writes: &quot; &lt;&lt; std::dec &lt;&lt; _writeService-&gt;getNumRequests() &lt;&lt; std::endl;</span>
    }
</pre></div>
</div>
</div>
<a class="anchor" id="abf68640f2e170e7deb7b7622b089aeb9"></a><!-- doxytag: member="Sqlite3Cache::getImage" ref="abf68640f2e170e7deb7b7622b089aeb9" args="(const TileKey &amp;key, const CacheSpec &amp;spec, osg::ref_ptr&lt; const osg::Image &gt; &amp;out_image)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Sqlite3Cache::getImage </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classosgEarth_1_1TileKey.html">TileKey</a> &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structosgEarth_1_1CacheSpec.html">CacheSpec</a> &amp;&#160;</td>
          <td class="paramname"><em>spec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">osg::ref_ptr&lt; const osg::Image &gt; &amp;&#160;</td>
          <td class="paramname"><em>out_image</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Gets the cached image for the given TileKey </p>

<p>Implements <a class="el" href="classosgEarth_1_1Cache.html#a37fa3584480f3cf850979ef6065945b7">osgEarth::Cache</a>.</p>

<p>Definition at line <a class="el" href="Sqlite3Cache_8cpp_source.html#l01162">1162</a> of file <a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <span class="keywordflow">if</span> ( !<a class="code" href="classSqlite3Cache.html#acf00e6024c4c7f21134569cf04f6c585">_db</a> ) <span class="keywordflow">return</span> <span class="keyword">false</span>;

        <span class="comment">// wait if we are purging the db</span>
        ScopedLock&lt;Mutex&gt; lock2( <a class="code" href="classSqlite3Cache.html#a8ef69036bd80afb27fa315dd0c9660f8">_pendingPurgeMutex</a> );

        <span class="comment">// first try the L2 cache.</span>
        <span class="keywordflow">if</span> ( <a class="code" href="classSqlite3Cache.html#a6e5fad1caa31adb898b019eabedfee2b">_L2cache</a>.valid() )
        {
            <span class="keywordflow">if</span> ( <a class="code" href="classSqlite3Cache.html#a6e5fad1caa31adb898b019eabedfee2b">_L2cache</a>-&gt;getImage( key, spec, out_image ) )
                <span class="keywordflow">return</span> <span class="keyword">true</span>;
        }

        <span class="comment">// next check the deferred-write queue.</span>
        <span class="keywordflow">if</span> ( <a class="code" href="classSqlite3Cache.html#a95fec1d09d3bdbda312cfd056e21a9ea">_options</a>.<a class="code" href="classosgEarth_1_1Drivers_1_1Sqlite3CacheOptions.html#a1fab653a686ab5eb8c997c01c9400190">asyncWrites</a>() == true )
        {
<span class="preprocessor">#ifdef INSERT_POOL</span>
<span class="preprocessor"></span>            ScopedLock&lt;Mutex&gt; lock( <a class="code" href="classSqlite3Cache.html#a50cf270b267e5bbff37f969585d5651a">_pendingWritesMutex</a> );
            std::string name = layerName;
            std::map&lt;std::string, osg::ref_ptr&lt;AsyncInsertPool&gt; &gt;::iterator it = <a class="code" href="classSqlite3Cache.html#a0390ac812d20df6392e65895e9c24430">_pendingWrites</a>.find(name);
            <span class="keywordflow">if</span> (it != <a class="code" href="classSqlite3Cache.html#a0390ac812d20df6392e65895e9c24430">_pendingWrites</a>.end()) {
                AsyncInsertPool* p = it-&gt;second.get();
                <span class="keywordflow">if</span> (p) {
                    osg::Image* img = p-&gt;findImage(key.<a class="code" href="classosgEarth_1_1TileKey.html#aff6a958d86c7ac9a6300e0d9fa8aa72c">str</a>());
                    <span class="keywordflow">if</span> (img) {
                        <span class="comment">// todo: update the access time, or let it slide?</span>
                        <a class="code" href="HTTPClient_8cpp.html#ac6600c2662696d8b43a4deb6877c8591">OE_DEBUG</a> &lt;&lt; <a class="code" href="Sqlite3Cache_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;Got key that is write-queued: &quot;</span> &lt;&lt; key.<a class="code" href="classosgEarth_1_1TileKey.html#aff6a958d86c7ac9a6300e0d9fa8aa72c">str</a>() &lt;&lt; std::endl;
                        <span class="keywordflow">return</span> img;
                    }
                }
            }
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>            ScopedLock&lt;Mutex&gt; lock( <a class="code" href="classSqlite3Cache.html#a50cf270b267e5bbff37f969585d5651a">_pendingWritesMutex</a> );
            std::string name = key.<a class="code" href="classosgEarth_1_1TileKey.html#aff6a958d86c7ac9a6300e0d9fa8aa72c">str</a>() + spec.<a class="code" href="structosgEarth_1_1CacheSpec.html#a74395f8d7912eab234ba66e7537d7ba6">cacheId</a>(); <span class="comment">//layerName;</span>
            std::map&lt;std::string,osg::ref_ptr&lt;AsyncInsert&gt; &gt;::iterator i = <a class="code" href="classSqlite3Cache.html#a0390ac812d20df6392e65895e9c24430">_pendingWrites</a>.find(name);
            <span class="keywordflow">if</span> ( i != <a class="code" href="classSqlite3Cache.html#a0390ac812d20df6392e65895e9c24430">_pendingWrites</a>.end() )
            {
                <span class="comment">// todo: update the access time, or let it slide?</span>
                <a class="code" href="HTTPClient_8cpp.html#ac6600c2662696d8b43a4deb6877c8591">OE_DEBUG</a> &lt;&lt; <a class="code" href="Sqlite3Cache_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;Got key that is write-queued: &quot;</span> &lt;&lt; key.<a class="code" href="classosgEarth_1_1TileKey.html#aff6a958d86c7ac9a6300e0d9fa8aa72c">str</a>() &lt;&lt; std::endl;
                out_image = i-&gt;second-&gt;_image.get();
                <span class="keywordflow">return</span> out_image.valid();
                <span class="comment">//return i-&gt;second-&gt;_image.get();</span>
            }
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>        }

        <span class="comment">// finally, try to query the database.</span>
        <a class="code" href="structThreadTable.html">ThreadTable</a> tt = <a class="code" href="classSqlite3Cache.html#acdc5a4cb14ffd6d76c192cb9412ac31c">getTable</a>( spec.<a class="code" href="structosgEarth_1_1CacheSpec.html#a74395f8d7912eab234ba66e7537d7ba6">cacheId</a>() ); <span class="comment">//layerName);</span>
        <span class="keywordflow">if</span> ( tt.<a class="code" href="structThreadTable.html#a7b8c77d6046b1f40bcddb0b2908de083">_table</a> )
        {
            <a class="code" href="structImageRecord.html">ImageRecord</a> rec( key );
            <span class="keywordflow">if</span> (!tt.<a class="code" href="structThreadTable.html#a7b8c77d6046b1f40bcddb0b2908de083">_table</a>-&gt;<a class="code" href="structLayerTable.html#a18414f4569f5fea37a586c352b7670a1">load</a>( key, rec, tt.<a class="code" href="structThreadTable.html#af8e72690b1236986171eb2c3a2c3184e">_db</a> ))
                <span class="keywordflow">return</span> <span class="keyword">false</span>;

            <span class="comment">// load it into the L2 cache</span>
            out_image = rec._image.release();

            <span class="keywordflow">if</span> ( out_image.valid() &amp;&amp; <a class="code" href="classSqlite3Cache.html#a6e5fad1caa31adb898b019eabedfee2b">_L2cache</a>.valid() )
                <a class="code" href="classSqlite3Cache.html#a6e5fad1caa31adb898b019eabedfee2b">_L2cache</a>-&gt;setImage( key, spec, out_image.get() );

<span class="preprocessor">#ifdef UPDATE_ACCESS_TIMES</span>
<span class="preprocessor"></span>
<span class="preprocessor">#ifdef UPDATE_ACCESS_TIMES_POOL</span>
<span class="preprocessor"></span>            <span class="comment">// update the last-access time</span>
            <span class="keywordtype">int</span> t = (int)::time(0L);
            {
                ScopedLock&lt;Mutex&gt; lock( <a class="code" href="classSqlite3Cache.html#a9126ddc09412dbdfb3237b3facbe9493">_pendingUpdateMutex</a> );
                osg::ref_ptr&lt;AsyncUpdateAccessTimePool&gt; pool;
                std::map&lt;std::string,osg::ref_ptr&lt;AsyncUpdateAccessTimePool&gt; &gt;::iterator i = <a class="code" href="classSqlite3Cache.html#a8195ac45f0906d0590895ea26b0d3be2">_pendingUpdates</a>.find( spec.<a class="code" href="structosgEarth_1_1CacheSpec.html#a74395f8d7912eab234ba66e7537d7ba6">cacheId</a>() ); <span class="comment">//layerName);</span>
                <span class="keywordflow">if</span> ( i != <a class="code" href="classSqlite3Cache.html#a8195ac45f0906d0590895ea26b0d3be2">_pendingUpdates</a>.end() )
                {
                    i-&gt;second-&gt;addEntry(key, t);
                    pool = i-&gt;second;
                    <a class="code" href="HTTPClient_8cpp.html#ac6600c2662696d8b43a4deb6877c8591">OE_DEBUG</a> &lt;&lt; <a class="code" href="Sqlite3Cache_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;Add key &quot;</span> &lt;&lt; key.<a class="code" href="classosgEarth_1_1TileKey.html#aff6a958d86c7ac9a6300e0d9fa8aa72c">str</a>() &lt;&lt; <span class="stringliteral">&quot; to existing layer batch &quot;</span> &lt;&lt; spec.<a class="code" href="structosgEarth_1_1CacheSpec.html#aa0aeef925682e234f4684a59f7454406">name</a>() &lt;&lt; std::endl;
                } <span class="keywordflow">else</span> {
                    pool = <span class="keyword">new</span> <a class="code" href="structAsyncUpdateAccessTimePool.html">AsyncUpdateAccessTimePool</a>(spec.<a class="code" href="structosgEarth_1_1CacheSpec.html#a74395f8d7912eab234ba66e7537d7ba6">cacheId</a>(), <span class="keyword">this</span>);
                    pool-&gt;<a class="code" href="structAsyncUpdateAccessTimePool.html#a0db54ba24091200db066d04b57d28473">addEntry</a>(key, t);
                    <a class="code" href="classSqlite3Cache.html#a8195ac45f0906d0590895ea26b0d3be2">_pendingUpdates</a>[spec.<a class="code" href="structosgEarth_1_1CacheSpec.html#a74395f8d7912eab234ba66e7537d7ba6">cacheId</a>()] = pool.get();
                    <a class="code" href="classSqlite3Cache.html#acd31204ead71966342e4de852baeb883">_writeService</a>-&gt;add(pool.get());
                }
            }
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>            <span class="comment">// update the last-access time</span>
            <span class="keywordtype">int</span> t = (int)::time(0L);
            <a class="code" href="classSqlite3Cache.html#acd31204ead71966342e4de852baeb883">_writeService</a>-&gt;add( <span class="keyword">new</span> <a class="code" href="structAsyncUpdateAccessTime.html">AsyncUpdateAccessTime</a>(  key, layerName, t, <span class="keyword">this</span> ) );
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
<span class="preprocessor">#endif // UPDATE_ACCESS_TIMES</span>
<span class="preprocessor"></span>
            <span class="keywordflow">return</span> out_image.valid();
        }
        <span class="keywordflow">else</span>
        {
            <a class="code" href="HTTPClient_8cpp.html#ac6600c2662696d8b43a4deb6877c8591">OE_DEBUG</a> &lt;&lt; <a class="code" href="Sqlite3Cache_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;What, no layer table?&quot;</span> &lt;&lt; std::endl;
        }
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }
</pre></div>
<p><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classSqlite3Cache_abf68640f2e170e7deb7b7622b089aeb9_cgraph.png" border="0" usemap="#classSqlite3Cache_abf68640f2e170e7deb7b7622b089aeb9_cgraph" alt=""/></div>
<map name="classSqlite3Cache_abf68640f2e170e7deb7b7622b089aeb9_cgraph" id="classSqlite3Cache_abf68640f2e170e7deb7b7622b089aeb9_cgraph">
<area shape="rect" id="node3" href="structAsyncUpdateAccessTimePool.html#a0db54ba24091200db066d04b57d28473" title="AsyncUpdateAccessTimePool::addEntry" alt="" coords="217,112,476,141"/><area shape="rect" id="node7" href="classosgEarth_1_1TileKey.html#aff6a958d86c7ac9a6300e0d9fa8aa72c" title="osgEarth::TileKey::str" alt="" coords="892,217,1041,247"/><area shape="rect" id="node17" href="structosgEarth_1_1CacheSpec.html#a74395f8d7912eab234ba66e7537d7ba6" title="osgEarth::CacheSpec::cacheId" alt="" coords="245,269,448,299"/><area shape="rect" id="node19" href="structLayerTable.html#a18414f4569f5fea37a586c352b7670a1" title="LayerTable::load" alt="" coords="288,323,405,352"/><area shape="rect" id="node22" href="structosgEarth_1_1CacheSpec.html#aa0aeef925682e234f4684a59f7454406" title="osgEarth::CacheSpec::name" alt="" coords="252,376,441,405"/><area shape="rect" id="node5" href="structAsyncUpdateAccessTimePool.html#ab2aafd7ca05bbe1481236484d75caa8a" title="AsyncUpdateAccessTimePool::addEntryInternal" alt="" coords="527,59,828,88"/><area shape="rect" id="node9" href="classosgEarth_1_1TileKey.html#a14c0d336dbe4b0d2fdd0ba693bc9699a" title="osgEarth::TileKey::createAncestorKey" alt="" coords="555,5,800,35"/><area shape="rect" id="node13" href="classosgEarth_1_1TileKey.html#a0ee6b25bbae560dda11987ac1e9dc69d" title="osgEarth::TileKey::getLevelOfDetail" alt="" coords="563,112,792,141"/><area shape="rect" id="node15" href="classosgEarth_1_1TileKey.html#a71ee8076e4558c15c9499b3b1993944f" title="osgEarth::TileKey::valid" alt="" coords="597,165,757,195"/><area shape="rect" id="node11" href="classosgEarth_1_1TileKey.html#a20ff137204ea7b91598b5a1b3ca21126" title="osgEarth::TileKey::TileKey" alt="" coords="877,5,1056,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a875e3791f949911bdd5e452b549bb103"></a><!-- doxytag: member="Sqlite3Cache::getOrCreateDbForThread" ref="a875e3791f949911bdd5e452b549bb103" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sqlite3* Sqlite3Cache::getOrCreateDbForThread </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Sqlite3Cache_8cpp_source.html#l01570">1570</a> of file <a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a>.</p>
<div class="fragment"><pre class="fragment">    {
        sqlite3* db = 0L;

        <span class="comment">// this method assumes the thread already holds a lock on _tableListMutex, which</span>
        <span class="comment">// doubles to protect _dbPerThread</span>

        <a class="code" href="namespaceosgEarth_1_1Threading.html#abc9ca1a5aeeb64be44d782a3c3347b7d">Thread</a>* thread = Thread::CurrentThread();
        std::map&lt;Thread*,sqlite3*&gt;::const_iterator k = <a class="code" href="classSqlite3Cache.html#a8f28b37b8b43a71d421c481be30bc7d6">_dbPerThread</a>.find(thread);
        <span class="keywordflow">if</span> ( k == <a class="code" href="classSqlite3Cache.html#a8f28b37b8b43a71d421c481be30bc7d6">_dbPerThread</a>.end() )
        {
            db = <a class="code" href="Sqlite3Cache_8cpp.html#afef17696c900f53cb7b0f93889d7b577">openDatabase</a>( <a class="code" href="classSqlite3Cache.html#a77d8fc6cdeb8091cb5c48c9dca0e59cd">_databasePath</a>, <a class="code" href="classSqlite3Cache.html#a95fec1d09d3bdbda312cfd056e21a9ea">_options</a>.<a class="code" href="classosgEarth_1_1Drivers_1_1Sqlite3CacheOptions.html#a7e83266e6cb2bbb9d84ab8120ec6a9ec">serialized</a>().<a class="code" href="structosgEarth_1_1optional.html#a9e71f677728602dc521d7102c9be7820">value</a>() );
            <span class="keywordflow">if</span> ( db )
            {
                <a class="code" href="classSqlite3Cache.html#a8f28b37b8b43a71d421c481be30bc7d6">_dbPerThread</a>[thread] = db;
                <a class="code" href="HTTPClient_8cpp.html#ac6600c2662696d8b43a4deb6877c8591">OE_DEBUG</a> &lt;&lt; <a class="code" href="Sqlite3Cache_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;Created DB handle &quot;</span> &lt;&lt; std::hex &lt;&lt; db &lt;&lt; <span class="stringliteral">&quot; for thread &quot;</span> &lt;&lt; thread &lt;&lt; std::endl;
            }
            <span class="keywordflow">else</span>
            {
                <a class="code" href="Notify.html#a13b79c6470fc74594070bd2098afc9de">OE_WARN</a> &lt;&lt; <a class="code" href="Sqlite3Cache_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;Failed to open DB on thread &quot;</span> &lt;&lt; thread &lt;&lt; std::endl;
            }
        }
        <span class="keywordflow">else</span>
        {
            db = k-&gt;second;
        }

        <span class="keywordflow">return</span> db;
    }
</pre></div>
<p><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classSqlite3Cache_a875e3791f949911bdd5e452b549bb103_cgraph.png" border="0" usemap="#classSqlite3Cache_a875e3791f949911bdd5e452b549bb103_cgraph" alt=""/></div>
<map name="classSqlite3Cache_a875e3791f949911bdd5e452b549bb103_cgraph" id="classSqlite3Cache_a875e3791f949911bdd5e452b549bb103_cgraph">
<area shape="rect" id="node3" href="Sqlite3Cache_8cpp.html#afef17696c900f53cb7b0f93889d7b577" title="openDatabase" alt="" coords="309,5,416,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="acdc5a4cb14ffd6d76c192cb9412ac31c"></a><!-- doxytag: member="Sqlite3Cache::getTable" ref="acdc5a4cb14ffd6d76c192cb9412ac31c" args="(const std::string &amp;tableName)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structThreadTable.html">ThreadTable</a> Sqlite3Cache::getTable </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>tableName</em></td><td>)</td>
          <td><code> [inline, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Sqlite3Cache_8cpp_source.html#l01603">1603</a> of file <a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a>.</p>
<div class="fragment"><pre class="fragment">    {
        ScopedLock&lt;Mutex&gt; lock( <a class="code" href="classSqlite3Cache.html#a2729caca9fb6969a35b0a2e8f861dca7">_tableListMutex</a> );

<span class="preprocessor">#ifdef SPLIT_LAYER_DB</span>
<span class="preprocessor"></span>        sqlite3* db = <a class="code" href="classSqlite3Cache.html#a875e3791f949911bdd5e452b549bb103">getOrCreateDbForThread</a>(tableName);
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>        sqlite3* db = <a class="code" href="classSqlite3Cache.html#a875e3791f949911bdd5e452b549bb103">getOrCreateDbForThread</a>();
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>        <span class="keywordflow">if</span> ( !db )
            <span class="keywordflow">return</span> <a class="code" href="structThreadTable.html">ThreadTable</a>( 0L, 0L );

        LayerTablesByName::iterator i = <a class="code" href="classSqlite3Cache.html#aad44ce7e38dc0e8eee6f7b712075008b">_tables</a>.find(tableName);
        <span class="keywordflow">if</span> ( i == <a class="code" href="classSqlite3Cache.html#aad44ce7e38dc0e8eee6f7b712075008b">_tables</a>.end() )
        {
            <a class="code" href="structMetadataRecord.html">MetadataRecord</a> meta;
<span class="preprocessor">#ifdef SPLIT_LAYER_DB</span>
<span class="preprocessor"></span>            sqlite3* metadb = getOrCreateMetaDbForThread();
            <span class="keywordflow">if</span> ( !<a class="code" href="classSqlite3Cache.html#a55ff6bdc4a42f4c563d945b406471724">_metadata</a>.<a class="code" href="structMetadataTable.html#a2809e4d8b687df502c133da99a720c50">load</a>( tableName, metadb, meta ) )
#<span class="keywordflow">else</span>
            <span class="keywordflow">if</span> ( !<a class="code" href="classSqlite3Cache.html#a55ff6bdc4a42f4c563d945b406471724">_metadata</a>.<a class="code" href="structMetadataTable.html#a2809e4d8b687df502c133da99a720c50">load</a>( tableName, db, meta ) )
#endif
            {
                <a class="code" href="Notify.html#a13b79c6470fc74594070bd2098afc9de">OE_WARN</a> &lt;&lt; <a class="code" href="Sqlite3Cache_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;Cannot operate on \&quot;&quot;</span> &lt;&lt; tableName &lt;&lt; <span class="stringliteral">&quot;\&quot; because metadata does not exist.&quot;</span>
                    &lt;&lt; std::endl;
                <span class="keywordflow">return</span> <a class="code" href="structThreadTable.html">ThreadTable</a>( 0L, 0L );
            }

            <a class="code" href="classSqlite3Cache.html#aad44ce7e38dc0e8eee6f7b712075008b">_tables</a>[tableName] = <span class="keyword">new</span> <a class="code" href="structLayerTable.html">LayerTable</a>( meta, db );
            <a class="code" href="HTTPClient_8cpp.html#ac6600c2662696d8b43a4deb6877c8591">OE_DEBUG</a> &lt;&lt; <a class="code" href="Sqlite3Cache_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;New LayerTable for &quot;</span> &lt;&lt; tableName &lt;&lt; std::endl;
        }
        <span class="keywordflow">return</span> <a class="code" href="structThreadTable.html">ThreadTable</a>( <a class="code" href="classSqlite3Cache.html#aad44ce7e38dc0e8eee6f7b712075008b">_tables</a>[tableName].<span class="keyword">get</span>(), db );
    }
</pre></div>
</div>
</div>
<a class="anchor" id="af3a9636dbeb5b7263396143de9cc05cb"></a><!-- doxytag: member="Sqlite3Cache::isCached" ref="af3a9636dbeb5b7263396143de9cc05cb" args="(const TileKey &amp;key, const CacheSpec &amp;spec) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Sqlite3Cache::isCached </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classosgEarth_1_1TileKey.html">TileKey</a> &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structosgEarth_1_1CacheSpec.html">CacheSpec</a> &amp;&#160;</td>
          <td class="paramname"><em>spec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Gets whether the given TileKey is cached or not </p>

<p>Reimplemented from <a class="el" href="classosgEarth_1_1Cache.html#a1d5af00f38e554e6b2da2255df83c0c0">osgEarth::Cache</a>.</p>

<p>Definition at line <a class="el" href="Sqlite3Cache_8cpp_source.html#l01078">1078</a> of file <a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <span class="comment">// this looks ineffecient, but usually when isCached() is called, getImage() will be</span>
        <span class="comment">// called soon thereafter. And this call will load it into the L2 cache so the subsequent</span>
        <span class="comment">// getImage call will not hit the DB again.</span>
        osg::ref_ptr&lt;const osg::Image&gt; temp;
        <span class="keywordflow">return</span> <span class="keyword">const_cast&lt;</span><a class="code" href="classSqlite3Cache.html">Sqlite3Cache</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)-&gt;<a class="code" href="classSqlite3Cache.html#abf68640f2e170e7deb7b7622b089aeb9">getImage</a>( key, spec, temp );
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a4f9ed895ff5b41c1d4662b3a106b1b9f"></a><!-- doxytag: member="Sqlite3Cache::loadProperties" ref="a4f9ed895ff5b41c1d4662b3a106b1b9f" args="(const std::string &amp;cacheId, CacheSpec &amp;out_spec, osg::ref_ptr&lt; const Profile &gt; &amp;out_profile, unsigned int &amp;out_tileSize)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool Sqlite3Cache::loadProperties </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>cacheId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structosgEarth_1_1CacheSpec.html">CacheSpec</a> &amp;&#160;</td>
          <td class="paramname"><em>out_spec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">osg::ref_ptr&lt; const <a class="el" href="classosgEarth_1_1Profile.html">Profile</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>out_profile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int &amp;&#160;</td>
          <td class="paramname"><em>out_tileSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Loads the cache profile for the given layer. </p>

<p>Reimplemented from <a class="el" href="classosgEarth_1_1Cache.html#af2f00d8318c4a26621cb25a5aab2775d">osgEarth::Cache</a>.</p>

<p>Definition at line <a class="el" href="Sqlite3Cache_8cpp_source.html#l01129">1129</a> of file <a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <span class="keywordflow">if</span> ( !<a class="code" href="classSqlite3Cache.html#acf00e6024c4c7f21134569cf04f6c585">_db</a> ) <span class="keywordflow">return</span> 0L;

        ScopedLock&lt;Mutex&gt; lock( <a class="code" href="classSqlite3Cache.html#a2729caca9fb6969a35b0a2e8f861dca7">_tableListMutex</a> ); <span class="comment">// b/c we&#39;re using the base db handle</span>

<span class="preprocessor">#ifdef SPLIT_LAYER_DB</span>
<span class="preprocessor"></span>        sqlite3* db = getOrCreateMetaDbForThread();
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>        sqlite3* db = <a class="code" href="classSqlite3Cache.html#a875e3791f949911bdd5e452b549bb103">getOrCreateDbForThread</a>();
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>        <span class="keywordflow">if</span> ( !db )
            <span class="keywordflow">return</span> 0L;

        <a class="code" href="HTTPClient_8cpp.html#ac6600c2662696d8b43a4deb6877c8591">OE_DEBUG</a> &lt;&lt; <a class="code" href="Sqlite3Cache_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;Loading metadata for layer \&quot;&quot;</span> &lt;&lt; cacheId &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span> &lt;&lt; std::endl;

        <a class="code" href="structMetadataRecord.html">MetadataRecord</a> rec;
        <span class="keywordflow">if</span> ( <a class="code" href="classSqlite3Cache.html#a55ff6bdc4a42f4c563d945b406471724">_metadata</a>.<a class="code" href="structMetadataTable.html#a2809e4d8b687df502c133da99a720c50">load</a>( cacheId, db, rec ) )
        {
            out_spec = <a class="code" href="structosgEarth_1_1CacheSpec.html">CacheSpec</a>( rec.<a class="code" href="structMetadataRecord.html#aed341cab8dd5e6ce2822e0691a6a52f7">_layerName</a>, rec.<a class="code" href="structMetadataRecord.html#a175a3bed6f6171dfaed5c7fc1dabeb69">_format</a> );
            out_tileSize = rec.<a class="code" href="structMetadataRecord.html#a86eeb7cbf8448e67ff00ef59f9616b48">_tileSize</a>;
            out_profile = rec.<a class="code" href="structMetadataRecord.html#a27ba2b9130de43928ecbc772e719fb2f">_profile</a>;
        }
        <span class="keywordflow">return</span> 0L;
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a872792861e1326f16472fd4abed297aa"></a><!-- doxytag: member="Sqlite3Cache::META_Object" ref="a872792861e1326f16472fd4abed297aa" args="(osgEarth, Sqlite3Cache)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Sqlite3Cache::META_Object </td>
          <td>(</td>
          <td class="paramtype">osgEarth&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSqlite3Cache.html">Sqlite3Cache</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aa929c5104c0260ec8e391457cd821b3b"></a><!-- doxytag: member="Sqlite3Cache::purge" ref="aa929c5104c0260ec8e391457cd821b3b" args="(const std::string &amp;layerName, int olderThanUTC, bool async)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Sqlite3Cache::purge </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>layerName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>olderThanUTC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>async</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Purges records from the database. </p>

<p>Reimplemented from <a class="el" href="classosgEarth_1_1Cache.html#a6ad642787454df9651991b725c3ab50b">osgEarth::Cache</a>.</p>

<p>Definition at line <a class="el" href="Sqlite3Cache_8cpp_source.html#l01312">1312</a> of file <a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <span class="keywordflow">if</span> ( !<a class="code" href="classSqlite3Cache.html#acf00e6024c4c7f21134569cf04f6c585">_db</a> ) <span class="keywordflow">return</span> <span class="keyword">false</span>;

        <span class="comment">// purge the L2 cache first:</span>
        <span class="keywordflow">if</span> ( async == <span class="keyword">true</span> &amp;&amp; <a class="code" href="classSqlite3Cache.html#a95fec1d09d3bdbda312cfd056e21a9ea">_options</a>.<a class="code" href="classosgEarth_1_1Drivers_1_1Sqlite3CacheOptions.html#a1fab653a686ab5eb8c997c01c9400190">asyncWrites</a>() == true )
        {
<span class="preprocessor">#ifdef PURGE_GENERAL</span>
<span class="preprocessor"></span>            <span class="keywordflow">if</span> (!<a class="code" href="classSqlite3Cache.html#ad64ad74d8e1a495fdfcc25ead9767835">_pendingPurges</a>.empty())
                <span class="keywordflow">return</span> <span class="keyword">false</span>;
            ScopedLock&lt;Mutex&gt; lock( <a class="code" href="classSqlite3Cache.html#a8ef69036bd80afb27fa315dd0c9660f8">_pendingPurgeMutex</a> );
            <a class="code" href="structAsyncPurge.html">AsyncPurge</a>* req = <span class="keyword">new</span> <a class="code" href="structAsyncPurge.html">AsyncPurge</a>(layerName, olderThanUTC, <span class="keyword">this</span>);
            <a class="code" href="classSqlite3Cache.html#acd31204ead71966342e4de852baeb883">_writeService</a>-&gt;add( req);
            <a class="code" href="classSqlite3Cache.html#ad64ad74d8e1a495fdfcc25ead9767835">_pendingPurges</a>[layerName] = req;
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>            <span class="keywordflow">if</span> (<a class="code" href="classSqlite3Cache.html#ad64ad74d8e1a495fdfcc25ead9767835">_pendingPurges</a>.find(layerName) != <a class="code" href="classSqlite3Cache.html#ad64ad74d8e1a495fdfcc25ead9767835">_pendingPurges</a>.end()) {
                <span class="keywordflow">return</span> <span class="keyword">false</span>;
            } <span class="keywordflow">else</span> {
                ScopedLock&lt;Mutex&gt; lock( <a class="code" href="classSqlite3Cache.html#a8ef69036bd80afb27fa315dd0c9660f8">_pendingPurgeMutex</a> );
                <a class="code" href="structAsyncPurge.html">AsyncPurge</a>* req = <span class="keyword">new</span> <a class="code" href="structAsyncPurge.html">AsyncPurge</a>(layerName, olderThanUTC, <span class="keyword">this</span>);
                <a class="code" href="classSqlite3Cache.html#acd31204ead71966342e4de852baeb883">_writeService</a>-&gt;add( req);
                <a class="code" href="classSqlite3Cache.html#ad64ad74d8e1a495fdfcc25ead9767835">_pendingPurges</a>[layerName] = req;
            }
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>        }
        <span class="keywordflow">else</span>
        {
<span class="preprocessor">#ifdef PURGE_GENERAL</span>
<span class="preprocessor"></span>            ScopedLock&lt;Mutex&gt; lock( <a class="code" href="classSqlite3Cache.html#a8ef69036bd80afb27fa315dd0c9660f8">_pendingPurgeMutex</a> );

            sqlite3_int64 limit = <a class="code" href="classSqlite3Cache.html#a95fec1d09d3bdbda312cfd056e21a9ea">_options</a>.<a class="code" href="classosgEarth_1_1Drivers_1_1Sqlite3CacheOptions.html#aa3554d945fe38baf0bb7f73b41818be6">maxSize</a>().<a class="code" href="structosgEarth_1_1optional.html#a9e71f677728602dc521d7102c9be7820">value</a>() * 1024 * 1024;
            std::map&lt;std::string, std::pair&lt;sqlite3_int64,int&gt; &gt; layers;
            sqlite3_int64 totalSize = 0;
            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classSqlite3Cache.html#a135dcd824468908900882de31c1c673d">_layersList</a>.size(); ++i) {
                <a class="code" href="structThreadTable.html">ThreadTable</a> tt = <a class="code" href="classSqlite3Cache.html#acdc5a4cb14ffd6d76c192cb9412ac31c">getTable</a>( <a class="code" href="classSqlite3Cache.html#a135dcd824468908900882de31c1c673d">_layersList</a>[i] );
                <span class="keywordflow">if</span> ( tt.<a class="code" href="structThreadTable.html#a7b8c77d6046b1f40bcddb0b2908de083">_table</a> ) {
                    sqlite3_int64 size = tt.<a class="code" href="structThreadTable.html#a7b8c77d6046b1f40bcddb0b2908de083">_table</a>-&gt;<a class="code" href="structLayerTable.html#ae99dc01f47cb77866c42738f6cdd0e59">getTableSize</a>(tt.<a class="code" href="structThreadTable.html#af8e72690b1236986171eb2c3a2c3184e">_db</a>);
                    layers[<a class="code" href="classSqlite3Cache.html#a135dcd824468908900882de31c1c673d">_layersList</a>[i] ].first = size;
                    layers[<a class="code" href="classSqlite3Cache.html#a135dcd824468908900882de31c1c673d">_layersList</a>[i] ].second = tt.<a class="code" href="structThreadTable.html#a7b8c77d6046b1f40bcddb0b2908de083">_table</a>-&gt;<a class="code" href="structLayerTable.html#a92164f4d8a533a70ab86988054d84d25">getNbEntry</a>(tt.<a class="code" href="structThreadTable.html#af8e72690b1236986171eb2c3a2c3184e">_db</a>);
                    totalSize += size;
                }
            }
            <a class="code" href="Notify.html#a47e8673ea1af7af40d431820bf3856fa">OE_INFO</a> &lt;&lt; <a class="code" href="Sqlite3Cache_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;SQlite cache size &quot;</span> &lt;&lt; totalSize/(1024*1024) &lt;&lt; <span class="stringliteral">&quot; MB&quot;</span> &lt;&lt; std::endl;
            <span class="keywordflow">if</span> (totalSize &gt; 1.2 * limit) {
                sqlite3_int64 diff = totalSize - limit;
                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classSqlite3Cache.html#a135dcd824468908900882de31c1c673d">_layersList</a>.size(); ++i) {
                    <span class="keywordtype">float</span> ratio = layers[<a class="code" href="classSqlite3Cache.html#a135dcd824468908900882de31c1c673d">_layersList</a>[i] ].first * 1.0 / (float)(totalSize);
                    <span class="keywordtype">int</span> sizeToRemove = (int)floor(ratio * diff);
                    <span class="keywordflow">if</span> (sizeToRemove &gt; 0) {
                        <span class="keywordflow">if</span> (sizeToRemove / 1024 &gt; 1024) {
                            <a class="code" href="HTTPClient_8cpp.html#ac6600c2662696d8b43a4deb6877c8591">OE_DEBUG</a> &lt;&lt; <span class="stringliteral">&quot;Try to remove &quot;</span> &lt;&lt; sizeToRemove/(1024*1024) &lt;&lt; <span class="stringliteral">&quot; MB in &quot;</span> &lt;&lt; <a class="code" href="classSqlite3Cache.html#a135dcd824468908900882de31c1c673d">_layersList</a>[i] &lt;&lt; std::endl;
                        } <span class="keywordflow">else</span> {
                            <a class="code" href="HTTPClient_8cpp.html#ac6600c2662696d8b43a4deb6877c8591">OE_DEBUG</a> &lt;&lt; <span class="stringliteral">&quot;Try to remove &quot;</span> &lt;&lt; sizeToRemove/1024 &lt;&lt; <span class="stringliteral">&quot; KB in &quot;</span> &lt;&lt; <a class="code" href="classSqlite3Cache.html#a135dcd824468908900882de31c1c673d">_layersList</a>[i] &lt;&lt; std::endl;
                        }

                        <span class="keywordflow">if</span> ( <a class="code" href="classSqlite3Cache.html#a6e5fad1caa31adb898b019eabedfee2b">_L2cache</a>.valid() )
                            <a class="code" href="classSqlite3Cache.html#a6e5fad1caa31adb898b019eabedfee2b">_L2cache</a>-&gt;purge( <a class="code" href="classSqlite3Cache.html#a135dcd824468908900882de31c1c673d">_layersList</a>[i], olderThanUTC, async );
                        <a class="code" href="structThreadTable.html">ThreadTable</a> tt = <a class="code" href="classSqlite3Cache.html#acdc5a4cb14ffd6d76c192cb9412ac31c">getTable</a>(<a class="code" href="classSqlite3Cache.html#a135dcd824468908900882de31c1c673d">_layersList</a>[i]);
                        <span class="keywordflow">if</span> ( tt.<a class="code" href="structThreadTable.html#a7b8c77d6046b1f40bcddb0b2908de083">_table</a> ) {
                            <span class="keywordtype">float</span> averageSizePerElement = layers[<a class="code" href="classSqlite3Cache.html#a135dcd824468908900882de31c1c673d">_layersList</a>[i] ].first * 1.0 /layers[<a class="code" href="classSqlite3Cache.html#a135dcd824468908900882de31c1c673d">_layersList</a>[i] ].second;
                            <span class="keywordtype">int</span> nb = (int)floor(sizeToRemove / averageSizePerElement);
                            <span class="keywordflow">if</span> (nb ) {
                                <a class="code" href="HTTPClient_8cpp.html#ac6600c2662696d8b43a4deb6877c8591">OE_DEBUG</a> &lt;&lt; <span class="stringliteral">&quot;remove &quot;</span> &lt;&lt; nb &lt;&lt; <span class="stringliteral">&quot; / &quot;</span> &lt;&lt; layers[<a class="code" href="classSqlite3Cache.html#a135dcd824468908900882de31c1c673d">_layersList</a>[i] ].second &lt;&lt; <span class="stringliteral">&quot; elements in &quot;</span> &lt;&lt; <a class="code" href="classSqlite3Cache.html#a135dcd824468908900882de31c1c673d">_layersList</a>[i] &lt;&lt; std::endl;
                                tt.<a class="code" href="structThreadTable.html#a7b8c77d6046b1f40bcddb0b2908de083">_table</a>-&gt;<a class="code" href="structLayerTable.html#a4bf3db12348df2b63f630a427a84e078">purge</a>(olderThanUTC, nb, tt.<a class="code" href="structThreadTable.html#af8e72690b1236986171eb2c3a2c3184e">_db</a>);
                            }
                        }
                    }
                }
            }
            <a class="code" href="classSqlite3Cache.html#ad64ad74d8e1a495fdfcc25ead9767835">_pendingPurges</a>.clear();
            <a class="code" href="classSqlite3Cache.html#a8bc188aa3883fb8f1d2ee80bdf5ddbe6">displayPendingOperations</a>();

<span class="preprocessor">#else</span>
<span class="preprocessor"></span>            ScopedLock&lt;Mutex&gt; lock( <a class="code" href="classSqlite3Cache.html#a8ef69036bd80afb27fa315dd0c9660f8">_pendingPurgeMutex</a> );
            <span class="keywordflow">if</span> ( <a class="code" href="classSqlite3Cache.html#a6e5fad1caa31adb898b019eabedfee2b">_L2cache</a>.valid() )
                <a class="code" href="classSqlite3Cache.html#a6e5fad1caa31adb898b019eabedfee2b">_L2cache</a>-&gt;purge( layerName, olderThanUTC, async );

            <a class="code" href="structThreadTable.html">ThreadTable</a> tt = <a class="code" href="classSqlite3Cache.html#acdc5a4cb14ffd6d76c192cb9412ac31c">getTable</a>( layerName );
            <span class="keywordflow">if</span> ( tt.<a class="code" href="structThreadTable.html#a7b8c77d6046b1f40bcddb0b2908de083">_table</a> )
            {
                <a class="code" href="classSqlite3Cache.html#ad64ad74d8e1a495fdfcc25ead9767835">_pendingPurges</a>.erase( layerName );

                <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxsize = <a class="code" href="classSqlite3Cache.html#a95fec1d09d3bdbda312cfd056e21a9ea">_options</a>.getSize(layerName);
                tt.<a class="code" href="structThreadTable.html#a7b8c77d6046b1f40bcddb0b2908de083">_table</a>-&gt;<a class="code" href="structLayerTable.html#ab73421eb54bab9384f8d086b5f3ed3dd">checkAndPurgeIfNeeded</a>(tt.<a class="code" href="structThreadTable.html#af8e72690b1236986171eb2c3a2c3184e">_db</a>, maxsize * 1024 * 1024);
                <a class="code" href="classSqlite3Cache.html#a8bc188aa3883fb8f1d2ee80bdf5ddbe6">displayPendingOperations</a>();
            }
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>        }
        <span class="keywordflow">return</span> <span class="keyword">true</span>;
    }
</pre></div>
<p><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classSqlite3Cache_aa929c5104c0260ec8e391457cd821b3b_cgraph.png" border="0" usemap="#classSqlite3Cache_aa929c5104c0260ec8e391457cd821b3b_cgraph" alt=""/></div>
<map name="classSqlite3Cache_aa929c5104c0260ec8e391457cd821b3b_cgraph" id="classSqlite3Cache_aa929c5104c0260ec8e391457cd821b3b_cgraph">
<area shape="rect" id="node3" href="structLayerTable.html#ab73421eb54bab9384f8d086b5f3ed3dd" title="LayerTable::checkAndPurgeIfNeeded" alt="" coords="196,139,433,168"/><area shape="rect" id="node48" href="structLayerTable.html#a92164f4d8a533a70ab86988054d84d25" title="LayerTable::getNbEntry" alt="" coords="235,192,395,221"/><area shape="rect" id="node50" href="structLayerTable.html#ae99dc01f47cb77866c42738f6cdd0e59" title="LayerTable::getTableSize" alt="" coords="229,245,400,275"/><area shape="rect" id="node52" href="structLayerTable.html#a4bf3db12348df2b63f630a427a84e078" title="LayerTable::purge" alt="" coords="252,299,377,328"/><area shape="rect" id="node5" href="osgearth__seed_8cpp.html#a5474eb5fe707f69df07bc3256c116324" title="purge" alt="" coords="484,219,537,248"/><area shape="rect" id="node7" href="classosgEarth_1_1MapNode.html#a2832313530afb8e8fd32b3d5f3e779e0" title="osgEarth::MapNode::findMapNode" alt="" coords="588,112,809,141"/><area shape="rect" id="node9" href="classosgEarth_1_1Map.html#a84a02a614b4b6ed8d2aceebb8a8593d9" title="osgEarth::Map::getCache" alt="" coords="613,165,784,195"/><area shape="rect" id="node42" href="classosgEarth_1_1MapNode.html#ad97119153966e1fc8029ebd5642d0444" title="osgEarth::MapNode::getMap" alt="" coords="604,219,793,248"/><area shape="rect" id="node44" href="osgearth__seed_8cpp.html#adfbe3c3520aedad87e99b1fa58e40f73" title="message" alt="" coords="661,272,736,301"/><area shape="rect" id="node46" href="osgearth__annotation_8cpp.html#a0c2ae8a349dcb4ee981a199a687bf549" title="usage" alt="" coords="671,325,727,355"/><area shape="rect" id="node11" href="classosgEarth_1_1MapOptions.html#ab85de1d6b56f3bc365e8137d5d36f0d0" title="osgEarth::MapOptions::cache" alt="" coords="884,5,1079,35"/><area shape="rect" id="node13" href="classosgEarth_1_1CacheFactory.html#a1bac5511c0d97cf20443a7a96ea6e324" title="osgEarth::CacheFactory::create" alt="" coords="877,59,1085,88"/><area shape="rect" id="node17" href="structosgEarth_1_1optional.html#ac10ed828e5fb151d8cabf856e1fc3d3e" title="osgEarth::optional::get" alt="" coords="905,112,1057,141"/><area shape="rect" id="node19" href="classosgEarth_1_1Registry.html#a061d3903e633b9abfafc38d6faa1590c" title="osgEarth::Registry::getCacheOverride" alt="" coords="860,165,1103,195"/><area shape="rect" id="node21" href="classosgEarth_1_1Registry.html#a92d21da82224d40008d7218eac280c09" title="osgEarth::Registry::instance" alt="" coords="888,219,1075,248"/><area shape="rect" id="node34" href="structosgEarth_1_1optional.html#aa094207bf2b22a4848989cd017dc4365" title="osgEarth::optional::isSet" alt="" coords="899,272,1064,301"/><area shape="rect" id="node36" href="classosgEarth_1_1Map.html#a2340eb04005ed0caf43a554959a88294" title="osgEarth::Map::setCache" alt="" coords="896,325,1067,355"/><area shape="rect" id="node15" href="classosgEarth_1_1DriverConfigOptions.html#ab989b270751800e8fca87b17fdc456bc" title="osgEarth::DriverConfigOptions::getDriver" alt="" coords="1152,59,1413,88"/><area shape="rect" id="node23" href="classosgEarth_1_1Registry.html#acb15d8aa051bf36ea92a86ee6c00bc3c" title="osgEarth::Registry::Registry" alt="" coords="1189,219,1376,248"/><area shape="rect" id="node25" href="classosgEarth_1_1Registry.html#a5a56910fe4fcb016cbae8e7728e8bf47" title="osgEarth::Registry::addMimeTypeExtensionMapping" alt="" coords="1461,139,1789,168"/><area shape="rect" id="node28" href="classosgEarth_1_1DiskCacheOptions.html#a89cba75c20b7201cebec071d7e68883c" title="osgEarth::DiskCacheOptions::path" alt="" coords="1513,192,1737,221"/><area shape="rect" id="node30" href="classosgEarth_1_1Registry.html#a958fd3968bf858d536d8468a330c66da" title="osgEarth::Registry::setCacheOverride" alt="" coords="1504,245,1747,275"/><area shape="rect" id="node32" href="classosgEarth_1_1DiskCacheOptions.html#af3b83ff8d6fb16c2f8688b51cbeceea2" title="osgEarth::DiskCacheOptions::setPath" alt="" coords="1503,299,1748,328"/><area shape="rect" id="node38" href="classosgEarth_1_1MapOptions.html#ab5f0670c447efcb8e24d01624eb8cd73" title="osgEarth::MapOptions::referenceURI" alt="" coords="1164,299,1401,328"/><area shape="rect" id="node40" href="structosgEarth_1_1optional.html#a9e71f677728602dc521d7102c9be7820" title="osgEarth::optional::value" alt="" coords="1200,352,1365,381"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2ebee3ea5c2f531b22f484f4fba55a1a"></a><!-- doxytag: member="Sqlite3Cache::setImage" ref="a2ebee3ea5c2f531b22f484f4fba55a1a" args="(const TileKey &amp;key, const CacheSpec &amp;spec, const osg::Image *image)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Sqlite3Cache::setImage </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classosgEarth_1_1TileKey.html">TileKey</a> &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structosgEarth_1_1CacheSpec.html">CacheSpec</a> &amp;&#160;</td>
          <td class="paramname"><em>spec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const osg::Image *&#160;</td>
          <td class="paramname"><em>image</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Sets the cached image for the given TileKey </p>

<p>Implements <a class="el" href="classosgEarth_1_1Cache.html#a4f62b3a2c941e7e67a584d0a81d2e2f5">osgEarth::Cache</a>.</p>

<p>Definition at line <a class="el" href="Sqlite3Cache_8cpp_source.html#l01264">1264</a> of file <a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a>.</p>
<div class="fragment"><pre class="fragment">    {        
        <span class="keywordflow">if</span> ( !<a class="code" href="classSqlite3Cache.html#acf00e6024c4c7f21134569cf04f6c585">_db</a> ) <span class="keywordflow">return</span>;

        <span class="keywordflow">if</span> ( <a class="code" href="classSqlite3Cache.html#a95fec1d09d3bdbda312cfd056e21a9ea">_options</a>.<a class="code" href="classosgEarth_1_1Drivers_1_1Sqlite3CacheOptions.html#a1fab653a686ab5eb8c997c01c9400190">asyncWrites</a>() == true )
        {
            <span class="comment">// the &quot;pending writes&quot; table is here so that we don&#39;t try to write data to</span>
            <span class="comment">// the cache more than once when using an asynchronous write service.</span>
            ScopedLock&lt;Mutex&gt; lock( <a class="code" href="classSqlite3Cache.html#a50cf270b267e5bbff37f969585d5651a">_pendingWritesMutex</a> );
<span class="preprocessor">#ifdef INSERT_POOL</span>
<span class="preprocessor"></span>            std::string name = layerName;
            std::map&lt;std::string, osg::ref_ptr&lt;AsyncInsertPool&gt; &gt;::iterator it = <a class="code" href="classSqlite3Cache.html#a0390ac812d20df6392e65895e9c24430">_pendingWrites</a>.find(name);
            <span class="keywordflow">if</span> ( it == <a class="code" href="classSqlite3Cache.html#a0390ac812d20df6392e65895e9c24430">_pendingWrites</a>.end() )
            {
                AsyncInsertPool* req = <span class="keyword">new</span> AsyncInsertPool(layerName, <span class="keyword">this</span>);
                req-&gt;addEntry(key, format, image);
                <a class="code" href="classSqlite3Cache.html#a0390ac812d20df6392e65895e9c24430">_pendingWrites</a>[name] = req;
                <a class="code" href="classSqlite3Cache.html#acd31204ead71966342e4de852baeb883">_writeService</a>-&gt;add( req );
            }
            <span class="keywordflow">else</span>
            {
                it-&gt;second-&gt;addEntry(key, format, image);
            }
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>            std::string name = key.<a class="code" href="classosgEarth_1_1TileKey.html#aff6a958d86c7ac9a6300e0d9fa8aa72c">str</a>() + spec.<a class="code" href="structosgEarth_1_1CacheSpec.html#a74395f8d7912eab234ba66e7537d7ba6">cacheId</a>();
            <span class="keywordflow">if</span> ( <a class="code" href="classSqlite3Cache.html#a0390ac812d20df6392e65895e9c24430">_pendingWrites</a>.find(name) == <a class="code" href="classSqlite3Cache.html#a0390ac812d20df6392e65895e9c24430">_pendingWrites</a>.end() )
            {
                <a class="code" href="structAsyncInsert.html">AsyncInsert</a>* req = <span class="keyword">new</span> <a class="code" href="structAsyncInsert.html">AsyncInsert</a>(key, spec, image, <span class="keyword">this</span>);
                <a class="code" href="classSqlite3Cache.html#a0390ac812d20df6392e65895e9c24430">_pendingWrites</a>[name] = req;
                <a class="code" href="classSqlite3Cache.html#acd31204ead71966342e4de852baeb883">_writeService</a>-&gt;add( req );
            }
            <span class="keywordflow">else</span>
            {
                <span class="comment">//NOTE: this should probably never happen.</span>
                <a class="code" href="Notify.html#a13b79c6470fc74594070bd2098afc9de">OE_WARN</a> &lt;&lt; <a class="code" href="Sqlite3Cache_8cpp.html#aa499bb75bb504909cd0a72baf48c4653">LC</a> &lt;&lt; <span class="stringliteral">&quot;Tried to setImage; already in queue: &quot;</span> &lt;&lt; key.<a class="code" href="classosgEarth_1_1TileKey.html#aff6a958d86c7ac9a6300e0d9fa8aa72c">str</a>() &lt;&lt; std::endl;
            }
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>        }
        <span class="keywordflow">else</span>
        {

            <a class="code" href="classSqlite3Cache.html#a90410529af647e1e89b7f538226bda8d">setImageSync</a>( key, spec, image );
        }
    }
</pre></div>
<p><div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png"/> Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classSqlite3Cache_a2ebee3ea5c2f531b22f484f4fba55a1a_cgraph.png" border="0" usemap="#classSqlite3Cache_a2ebee3ea5c2f531b22f484f4fba55a1a_cgraph" alt=""/></div>
<map name="classSqlite3Cache_a2ebee3ea5c2f531b22f484f4fba55a1a_cgraph" id="classSqlite3Cache_a2ebee3ea5c2f531b22f484f4fba55a1a_cgraph">
<area shape="rect" id="node3" href="structosgEarth_1_1CacheSpec.html#a74395f8d7912eab234ba66e7537d7ba6" title="osgEarth::CacheSpec::cacheId" alt="" coords="217,5,420,35"/><area shape="rect" id="node5" href="classosgEarth_1_1TileKey.html#aff6a958d86c7ac9a6300e0d9fa8aa72c" title="osgEarth::TileKey::str" alt="" coords="244,59,393,88"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a90410529af647e1e89b7f538226bda8d"></a><!-- doxytag: member="Sqlite3Cache::setImageSync" ref="a90410529af647e1e89b7f538226bda8d" args="(const TileKey &amp;key, const CacheSpec &amp;spec, const osg::Image *image)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Sqlite3Cache::setImageSync </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classosgEarth_1_1TileKey.html">TileKey</a> &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structosgEarth_1_1CacheSpec.html">CacheSpec</a> &amp;&#160;</td>
          <td class="paramname"><em>spec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const osg::Image *&#160;</td>
          <td class="paramname"><em>image</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline, private, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implements <a class="el" href="structAsyncCache.html#a017f61d0ff5280ff591c2c63fe7a83fb">AsyncCache</a>.</p>

<p>Definition at line <a class="el" href="Sqlite3Cache_8cpp_source.html#l01476">1476</a> of file <a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <span class="keywordflow">if</span> (<a class="code" href="classSqlite3Cache.html#a95fec1d09d3bdbda312cfd056e21a9ea">_options</a>.<a class="code" href="classosgEarth_1_1Drivers_1_1Sqlite3CacheOptions.html#aa3554d945fe38baf0bb7f73b41818be6">maxSize</a>().<a class="code" href="structosgEarth_1_1optional.html#a9e71f677728602dc521d7102c9be7820">value</a>() &gt; 0 &amp;&amp; <a class="code" href="classSqlite3Cache.html#accbae673eaedf4e1e7ae360694667fbb">_nbRequest</a> &gt; <a class="code" href="Sqlite3Cache_8cpp.html#a2d3ea31a02daa347d07b3bb351882fcc">MAX_REQUEST_TO_RUN_PURGE</a>) {
            <span class="keywordtype">int</span> t = (int)::time(0L);
            <a class="code" href="classSqlite3Cache.html#aa929c5104c0260ec8e391457cd821b3b">purge</a>(spec.<a class="code" href="structosgEarth_1_1CacheSpec.html#a74395f8d7912eab234ba66e7537d7ba6">cacheId</a>(), t, <a class="code" href="classSqlite3Cache.html#a95fec1d09d3bdbda312cfd056e21a9ea">_options</a>.<a class="code" href="classosgEarth_1_1Drivers_1_1Sqlite3CacheOptions.html#a1fab653a686ab5eb8c997c01c9400190">asyncWrites</a>().<a class="code" href="structosgEarth_1_1optional.html#a9e71f677728602dc521d7102c9be7820">value</a>() );
            <a class="code" href="classSqlite3Cache.html#accbae673eaedf4e1e7ae360694667fbb">_nbRequest</a> = 0;
        }
        <a class="code" href="classSqlite3Cache.html#accbae673eaedf4e1e7ae360694667fbb">_nbRequest</a>++;

        <a class="code" href="structThreadTable.html">ThreadTable</a> tt = <a class="code" href="classSqlite3Cache.html#acdc5a4cb14ffd6d76c192cb9412ac31c">getTable</a>( spec.<a class="code" href="structosgEarth_1_1CacheSpec.html#a74395f8d7912eab234ba66e7537d7ba6">cacheId</a>() );
        <span class="keywordflow">if</span> ( tt.<a class="code" href="structThreadTable.html#a7b8c77d6046b1f40bcddb0b2908de083">_table</a> )
        {
            ::time_t t = ::time(0L);
            <a class="code" href="structImageRecord.html">ImageRecord</a> rec( key );
            rec._created = (int)t;
            rec._accessed = (int)t;
            rec._image = image;

            tt.<a class="code" href="structThreadTable.html#a7b8c77d6046b1f40bcddb0b2908de083">_table</a>-&gt;<a class="code" href="structLayerTable.html#aa37fe68f8e040f9f784adf0380cdb47d">store</a>( rec, tt.<a class="code" href="structThreadTable.html#af8e72690b1236986171eb2c3a2c3184e">_db</a> );
        }

        <span class="keywordflow">if</span> ( <a class="code" href="classSqlite3Cache.html#a95fec1d09d3bdbda312cfd056e21a9ea">_options</a>.<a class="code" href="classosgEarth_1_1Drivers_1_1Sqlite3CacheOptions.html#a1fab653a686ab5eb8c997c01c9400190">asyncWrites</a>() == true )
        {
            ScopedLock&lt;Mutex&gt; lock( <a class="code" href="classSqlite3Cache.html#a50cf270b267e5bbff37f969585d5651a">_pendingWritesMutex</a> );
            std::string name = key.<a class="code" href="classosgEarth_1_1TileKey.html#aff6a958d86c7ac9a6300e0d9fa8aa72c">str</a>() + spec.<a class="code" href="structosgEarth_1_1CacheSpec.html#a74395f8d7912eab234ba66e7537d7ba6">cacheId</a>();
            <a class="code" href="classSqlite3Cache.html#a0390ac812d20df6392e65895e9c24430">_pendingWrites</a>.erase( name );
            <a class="code" href="classSqlite3Cache.html#a8bc188aa3883fb8f1d2ee80bdf5ddbe6">displayPendingOperations</a>();
        }
    }
</pre></div>
<p><div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png"/> Here is the call graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classSqlite3Cache_a90410529af647e1e89b7f538226bda8d_cgraph.png" border="0" usemap="#classSqlite3Cache_a90410529af647e1e89b7f538226bda8d_cgraph" alt=""/></div>
<map name="classSqlite3Cache_a90410529af647e1e89b7f538226bda8d_cgraph" id="classSqlite3Cache_a90410529af647e1e89b7f538226bda8d_cgraph">
<area shape="rect" id="node3" href="structosgEarth_1_1CacheSpec.html#a74395f8d7912eab234ba66e7537d7ba6" title="osgEarth::CacheSpec::cacheId" alt="" coords="247,219,449,248"/><area shape="rect" id="node5" href="osgearth__seed_8cpp.html#a5474eb5fe707f69df07bc3256c116324" title="purge" alt="" coords="321,272,375,301"/><area shape="rect" id="node48" href="structLayerTable.html#aa37fe68f8e040f9f784adf0380cdb47d" title="LayerTable::store" alt="" coords="287,325,409,355"/><area shape="rect" id="node50" href="classosgEarth_1_1TileKey.html#aff6a958d86c7ac9a6300e0d9fa8aa72c" title="osgEarth::TileKey::str" alt="" coords="536,379,685,408"/><area shape="rect" id="node7" href="classosgEarth_1_1MapNode.html#a2832313530afb8e8fd32b3d5f3e779e0" title="osgEarth::MapNode::findMapNode" alt="" coords="500,112,721,141"/><area shape="rect" id="node9" href="classosgEarth_1_1Map.html#a84a02a614b4b6ed8d2aceebb8a8593d9" title="osgEarth::Map::getCache" alt="" coords="525,165,696,195"/><area shape="rect" id="node42" href="classosgEarth_1_1MapNode.html#ad97119153966e1fc8029ebd5642d0444" title="osgEarth::MapNode::getMap" alt="" coords="516,219,705,248"/><area shape="rect" id="node44" href="osgearth__seed_8cpp.html#adfbe3c3520aedad87e99b1fa58e40f73" title="message" alt="" coords="573,272,648,301"/><area shape="rect" id="node46" href="osgearth__annotation_8cpp.html#a0c2ae8a349dcb4ee981a199a687bf549" title="usage" alt="" coords="583,325,639,355"/><area shape="rect" id="node11" href="classosgEarth_1_1MapOptions.html#ab85de1d6b56f3bc365e8137d5d36f0d0" title="osgEarth::MapOptions::cache" alt="" coords="796,5,991,35"/><area shape="rect" id="node13" href="classosgEarth_1_1CacheFactory.html#a1bac5511c0d97cf20443a7a96ea6e324" title="osgEarth::CacheFactory::create" alt="" coords="789,59,997,88"/><area shape="rect" id="node17" href="structosgEarth_1_1optional.html#ac10ed828e5fb151d8cabf856e1fc3d3e" title="osgEarth::optional::get" alt="" coords="817,112,969,141"/><area shape="rect" id="node19" href="classosgEarth_1_1Registry.html#a061d3903e633b9abfafc38d6faa1590c" title="osgEarth::Registry::getCacheOverride" alt="" coords="772,165,1015,195"/><area shape="rect" id="node21" href="classosgEarth_1_1Registry.html#a92d21da82224d40008d7218eac280c09" title="osgEarth::Registry::instance" alt="" coords="800,219,987,248"/><area shape="rect" id="node34" href="structosgEarth_1_1optional.html#aa094207bf2b22a4848989cd017dc4365" title="osgEarth::optional::isSet" alt="" coords="811,272,976,301"/><area shape="rect" id="node36" href="classosgEarth_1_1Map.html#a2340eb04005ed0caf43a554959a88294" title="osgEarth::Map::setCache" alt="" coords="808,325,979,355"/><area shape="rect" id="node15" href="classosgEarth_1_1DriverConfigOptions.html#ab989b270751800e8fca87b17fdc456bc" title="osgEarth::DriverConfigOptions::getDriver" alt="" coords="1064,59,1325,88"/><area shape="rect" id="node23" href="classosgEarth_1_1Registry.html#acb15d8aa051bf36ea92a86ee6c00bc3c" title="osgEarth::Registry::Registry" alt="" coords="1101,219,1288,248"/><area shape="rect" id="node25" href="classosgEarth_1_1Registry.html#a5a56910fe4fcb016cbae8e7728e8bf47" title="osgEarth::Registry::addMimeTypeExtensionMapping" alt="" coords="1373,139,1701,168"/><area shape="rect" id="node28" href="classosgEarth_1_1DiskCacheOptions.html#a89cba75c20b7201cebec071d7e68883c" title="osgEarth::DiskCacheOptions::path" alt="" coords="1425,192,1649,221"/><area shape="rect" id="node30" href="classosgEarth_1_1Registry.html#a958fd3968bf858d536d8468a330c66da" title="osgEarth::Registry::setCacheOverride" alt="" coords="1416,245,1659,275"/><area shape="rect" id="node32" href="classosgEarth_1_1DiskCacheOptions.html#af3b83ff8d6fb16c2f8688b51cbeceea2" title="osgEarth::DiskCacheOptions::setPath" alt="" coords="1415,299,1660,328"/><area shape="rect" id="node38" href="classosgEarth_1_1MapOptions.html#ab5f0670c447efcb8e24d01624eb8cd73" title="osgEarth::MapOptions::referenceURI" alt="" coords="1076,299,1313,328"/><area shape="rect" id="node40" href="structosgEarth_1_1optional.html#a9e71f677728602dc521d7102c9be7820" title="osgEarth::optional::value" alt="" coords="1112,352,1277,381"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af1aad64b7e862b7fcba9aa570e1b4c2b"></a><!-- doxytag: member="Sqlite3Cache::storeProperties" ref="af1aad64b7e862b7fcba9aa570e1b4c2b" args="(const CacheSpec &amp;spec, const Profile *profile, unsigned int tileSize)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void Sqlite3Cache::storeProperties </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structosgEarth_1_1CacheSpec.html">CacheSpec</a> &amp;&#160;</td>
          <td class="paramname"><em>spec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classosgEarth_1_1Profile.html">Profile</a> *&#160;</td>
          <td class="paramname"><em>profile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>tileSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Store the cache profile for the given profile. </p>

<p>Reimplemented from <a class="el" href="classosgEarth_1_1Cache.html#a33c00d10281c51243254f132f3a01a63">osgEarth::Cache</a>.</p>

<p>Definition at line <a class="el" href="Sqlite3Cache_8cpp_source.html#l01090">1090</a> of file <a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <span class="keywordflow">if</span> ( !<a class="code" href="classSqlite3Cache.html#acf00e6024c4c7f21134569cf04f6c585">_db</a> ) <span class="keywordflow">return</span>;

        <span class="keywordflow">if</span> ( spec.<a class="code" href="structosgEarth_1_1CacheSpec.html#a74395f8d7912eab234ba66e7537d7ba6">cacheId</a>().empty() || profile == 0L || spec.<a class="code" href="structosgEarth_1_1CacheSpec.html#a4253bd68a78e3ae7ec8a6e103c4dd187">format</a>().empty() )
        {
            <a class="code" href="Notify.html#a13b79c6470fc74594070bd2098afc9de">OE_WARN</a> &lt;&lt; <span class="stringliteral">&quot;ILLEGAL: cannot cache a layer without a layer id&quot;</span> &lt;&lt; std::endl;
            <span class="keywordflow">return</span>;
        }

        ScopedLock&lt;Mutex&gt; lock( <a class="code" href="classSqlite3Cache.html#a2729caca9fb6969a35b0a2e8f861dca7">_tableListMutex</a> ); <span class="comment">// b/c we&#39;re using the base db handle</span>
<span class="preprocessor">#ifdef SPLIT_LAYER_DB</span>
<span class="preprocessor"></span>        sqlite3* db = getOrCreateMetaDbForThread();
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>        sqlite3* db = <a class="code" href="classSqlite3Cache.html#a875e3791f949911bdd5e452b549bb103">getOrCreateDbForThread</a>();
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>        <span class="keywordflow">if</span> ( !db )
            <span class="keywordflow">return</span>;

        <span class="comment">//OE_INFO &lt;&lt; &quot;Storing metadata for layer \&quot;&quot; &lt;&lt; layerName &lt;&lt; &quot;\&quot;&quot; &lt;&lt; std::endl;</span>

        <a class="code" href="structMetadataRecord.html">MetadataRecord</a> rec;
        rec.<a class="code" href="structMetadataRecord.html#aed341cab8dd5e6ce2822e0691a6a52f7">_layerName</a> = spec.<a class="code" href="structosgEarth_1_1CacheSpec.html#a74395f8d7912eab234ba66e7537d7ba6">cacheId</a>();
        rec.<a class="code" href="structMetadataRecord.html#a27ba2b9130de43928ecbc772e719fb2f">_profile</a> = profile;
        rec.<a class="code" href="structMetadataRecord.html#a86eeb7cbf8448e67ff00ef59f9616b48">_tileSize</a> = tileSize;

<span class="preprocessor">#ifdef USE_SERIALIZERS</span>
<span class="preprocessor"></span>        rec.<a class="code" href="structMetadataRecord.html#a175a3bed6f6171dfaed5c7fc1dabeb69">_format</a> = <span class="stringliteral">&quot;osgb&quot;</span>;
        rec.<a class="code" href="structMetadataRecord.html#ae629cef47940290865fc592d206c52a8">_compressor</a> = <span class="stringliteral">&quot;zlib&quot;</span>;
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>        rec.<a class="code" href="structMetadataRecord.html#a175a3bed6f6171dfaed5c7fc1dabeb69">_format</a> = spec.<a class="code" href="structosgEarth_1_1CacheSpec.html#a4253bd68a78e3ae7ec8a6e103c4dd187">format</a>();
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
        <a class="code" href="classSqlite3Cache.html#a55ff6bdc4a42f4c563d945b406471724">_metadata</a>.<a class="code" href="structMetadataTable.html#adda71cebec6f9683ba5abe84b7597ad0">store</a>( rec, db );
    }
</pre></div>
<p><div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png"/> Here is the call graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classSqlite3Cache_af1aad64b7e862b7fcba9aa570e1b4c2b_cgraph.png" border="0" usemap="#classSqlite3Cache_af1aad64b7e862b7fcba9aa570e1b4c2b_cgraph" alt=""/></div>
<map name="classSqlite3Cache_af1aad64b7e862b7fcba9aa570e1b4c2b_cgraph" id="classSqlite3Cache_af1aad64b7e862b7fcba9aa570e1b4c2b_cgraph">
<area shape="rect" id="node3" href="structosgEarth_1_1CacheSpec.html#a74395f8d7912eab234ba66e7537d7ba6" title="osgEarth::CacheSpec::cacheId" alt="" coords="252,5,455,35"/><area shape="rect" id="node5" href="structosgEarth_1_1CacheSpec.html#a4253bd68a78e3ae7ec8a6e103c4dd187" title="osgEarth::CacheSpec::format" alt="" coords="256,59,451,88"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="acbae38c85f41b2587cda83978aafa4d9"></a><!-- doxytag: member="Sqlite3Cache::updateAccessTimeSync" ref="acbae38c85f41b2587cda83978aafa4d9" args="(const std::string &amp;layerName, const TileKey &amp;key, int newTimestamp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Sqlite3Cache::updateAccessTimeSync </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>layerName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classosgEarth_1_1TileKey.html">TileKey</a> &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>newTimestamp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>updateAccessTime records on the database. </p>

<p>Definition at line <a class="el" href="Sqlite3Cache_8cpp_source.html#l01406">1406</a> of file <a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <span class="keywordflow">if</span> ( !<a class="code" href="classSqlite3Cache.html#acf00e6024c4c7f21134569cf04f6c585">_db</a> ) <span class="keywordflow">return</span> <span class="keyword">false</span>;

        <a class="code" href="structThreadTable.html">ThreadTable</a> tt = <a class="code" href="classSqlite3Cache.html#acdc5a4cb14ffd6d76c192cb9412ac31c">getTable</a>(layerName);
        <span class="keywordflow">if</span> ( tt.<a class="code" href="structThreadTable.html#a7b8c77d6046b1f40bcddb0b2908de083">_table</a> )
        {
            tt.<a class="code" href="structThreadTable.html#a7b8c77d6046b1f40bcddb0b2908de083">_table</a>-&gt;<a class="code" href="structLayerTable.html#a91475032cfff01014916ed9923c5ab16">updateAccessTime</a>( key, newTimestamp, tt.<a class="code" href="structThreadTable.html#af8e72690b1236986171eb2c3a2c3184e">_db</a> );
        }
        <span class="keywordflow">return</span> <span class="keyword">true</span>;
    }
</pre></div>
<p><div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="closed.png"/> Here is the call graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classSqlite3Cache_acbae38c85f41b2587cda83978aafa4d9_cgraph.png" border="0" usemap="#classSqlite3Cache_acbae38c85f41b2587cda83978aafa4d9_cgraph" alt=""/></div>
<map name="classSqlite3Cache_acbae38c85f41b2587cda83978aafa4d9_cgraph" id="classSqlite3Cache_acbae38c85f41b2587cda83978aafa4d9_cgraph">
<area shape="rect" id="node3" href="structLayerTable.html#a91475032cfff01014916ed9923c5ab16" title="LayerTable::updateAccessTime" alt="" coords="305,5,511,35"/><area shape="rect" id="node5" href="classosgEarth_1_1TileKey.html#aff6a958d86c7ac9a6300e0d9fa8aa72c" title="osgEarth::TileKey::str" alt="" coords="560,5,709,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab3f46e1a54e231c29c03ed4af9ee57c8"></a><!-- doxytag: member="Sqlite3Cache::updateAccessTimeSyncPool" ref="ab3f46e1a54e231c29c03ed4af9ee57c8" args="(const std::string &amp;layerName, const std::string &amp;keys, int newTimestamp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Sqlite3Cache::updateAccessTimeSyncPool </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>layerName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>keys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>newTimestamp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>updateAccessTime records on the database. </p>

<p>Definition at line <a class="el" href="Sqlite3Cache_8cpp_source.html#l01421">1421</a> of file <a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <span class="keywordflow">if</span> ( !<a class="code" href="classSqlite3Cache.html#acf00e6024c4c7f21134569cf04f6c585">_db</a> ) <span class="keywordflow">return</span> <span class="keyword">false</span>;

        <a class="code" href="structThreadTable.html">ThreadTable</a> tt = <a class="code" href="classSqlite3Cache.html#acdc5a4cb14ffd6d76c192cb9412ac31c">getTable</a>(layerName);
        <span class="keywordflow">if</span> ( tt.<a class="code" href="structThreadTable.html#a7b8c77d6046b1f40bcddb0b2908de083">_table</a> )
        {
            tt.<a class="code" href="structThreadTable.html#a7b8c77d6046b1f40bcddb0b2908de083">_table</a>-&gt;<a class="code" href="structLayerTable.html#aae63a2472b8d215ae6ad2aea6237b290">updateAccessTimePool</a>( keys, newTimestamp, tt.<a class="code" href="structThreadTable.html#af8e72690b1236986171eb2c3a2c3184e">_db</a> );
        }

        {
            ScopedLock&lt;Mutex&gt; lock( <a class="code" href="classSqlite3Cache.html#a9126ddc09412dbdfb3237b3facbe9493">_pendingUpdateMutex</a> );
            <a class="code" href="classSqlite3Cache.html#a8195ac45f0906d0590895ea26b0d3be2">_pendingUpdates</a>.erase( layerName );
            <a class="code" href="classSqlite3Cache.html#a8bc188aa3883fb8f1d2ee80bdf5ddbe6">displayPendingOperations</a>();
        }
        <span class="keywordflow">return</span> <span class="keyword">true</span>;
    }
</pre></div>
<p><div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="closed.png"/> Here is the call graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classSqlite3Cache_ab3f46e1a54e231c29c03ed4af9ee57c8_cgraph.png" border="0" usemap="#classSqlite3Cache_ab3f46e1a54e231c29c03ed4af9ee57c8_cgraph" alt=""/></div>
<map name="classSqlite3Cache_ab3f46e1a54e231c29c03ed4af9ee57c8_cgraph" id="classSqlite3Cache_ab3f46e1a54e231c29c03ed4af9ee57c8_cgraph">
<area shape="rect" id="node3" href="structLayerTable.html#aae63a2472b8d215ae6ad2aea6237b290" title="LayerTable::updateAccessTimePool" alt="" coords="331,5,563,35"/></map>
</div>
</p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a90bd42341b20a084ffba919f05569899"></a><!-- doxytag: member="Sqlite3Cache::_count" ref="a90bd42341b20a084ffba919f05569899" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classSqlite3Cache.html#a90bd42341b20a084ffba919f05569899">Sqlite3Cache::_count</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Sqlite3Cache_8cpp_source.html#l01669">1669</a> of file <a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a77d8fc6cdeb8091cb5c48c9dca0e59cd"></a><!-- doxytag: member="Sqlite3Cache::_databasePath" ref="a77d8fc6cdeb8091cb5c48c9dca0e59cd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string <a class="el" href="classSqlite3Cache.html#a77d8fc6cdeb8091cb5c48c9dca0e59cd">Sqlite3Cache::_databasePath</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Sqlite3Cache_8cpp_source.html#l01673">1673</a> of file <a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="acf00e6024c4c7f21134569cf04f6c585"></a><!-- doxytag: member="Sqlite3Cache::_db" ref="acf00e6024c4c7f21134569cf04f6c585" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sqlite3* <a class="el" href="classSqlite3Cache.html#acf00e6024c4c7f21134569cf04f6c585">Sqlite3Cache::_db</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Sqlite3Cache_8cpp_source.html#l01661">1661</a> of file <a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a8f28b37b8b43a71d421c481be30bc7d6"></a><!-- doxytag: member="Sqlite3Cache::_dbPerThread" ref="a8f28b37b8b43a71d421c481be30bc7d6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;Thread*,sqlite3*&gt; <a class="el" href="classSqlite3Cache.html#a8f28b37b8b43a71d421c481be30bc7d6">Sqlite3Cache::_dbPerThread</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Sqlite3Cache_8cpp_source.html#l01662">1662</a> of file <a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a407e2a2f31bb145ed9daf6dba3e932a5"></a><!-- doxytag: member="Sqlite3Cache::_dbPerThreadLayers" ref="a407e2a2f31bb145ed9daf6dba3e932a5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;std::string, std::map&lt;Thread*,sqlite3*&gt; &gt; <a class="el" href="classSqlite3Cache.html#a407e2a2f31bb145ed9daf6dba3e932a5">Sqlite3Cache::_dbPerThreadLayers</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Sqlite3Cache_8cpp_source.html#l01664">1664</a> of file <a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="abd2ad981c0a805610eb9bb7e06a33db2"></a><!-- doxytag: member="Sqlite3Cache::_dbPerThreadMeta" ref="abd2ad981c0a805610eb9bb7e06a33db2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;Thread*,sqlite3*&gt; <a class="el" href="classSqlite3Cache.html#abd2ad981c0a805610eb9bb7e06a33db2">Sqlite3Cache::_dbPerThreadMeta</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Sqlite3Cache_8cpp_source.html#l01665">1665</a> of file <a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a9f4f99694b5bb6634591999defa5bfd8"></a><!-- doxytag: member="Sqlite3Cache::_defaultRW" ref="a9f4f99694b5bb6634591999defa5bfd8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">osg::ref_ptr&lt;osgDB::ReaderWriter&gt; <a class="el" href="classSqlite3Cache.html#a9f4f99694b5bb6634591999defa5bfd8">Sqlite3Cache::_defaultRW</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Sqlite3Cache_8cpp_source.html#l01641">1641</a> of file <a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a6e5fad1caa31adb898b019eabedfee2b"></a><!-- doxytag: member="Sqlite3Cache::_L2cache" ref="a6e5fad1caa31adb898b019eabedfee2b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">osg::ref_ptr&lt;<a class="el" href="classosgEarth_1_1MemCache.html">MemCache</a>&gt; <a class="el" href="classSqlite3Cache.html#a6e5fad1caa31adb898b019eabedfee2b">Sqlite3Cache::_L2cache</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Sqlite3Cache_8cpp_source.html#l01667">1667</a> of file <a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a135dcd824468908900882de31c1c673d"></a><!-- doxytag: member="Sqlite3Cache::_layersList" ref="a135dcd824468908900882de31c1c673d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::string&gt; <a class="el" href="classSqlite3Cache.html#a135dcd824468908900882de31c1c673d">Sqlite3Cache::_layersList</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Sqlite3Cache_8cpp_source.html#l01672">1672</a> of file <a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a55ff6bdc4a42f4c563d945b406471724"></a><!-- doxytag: member="Sqlite3Cache::_metadata" ref="a55ff6bdc4a42f4c563d945b406471724" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structMetadataTable.html">MetadataTable</a> <a class="el" href="classSqlite3Cache.html#a55ff6bdc4a42f4c563d945b406471724">Sqlite3Cache::_metadata</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Sqlite3Cache_8cpp_source.html#l01643">1643</a> of file <a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="accbae673eaedf4e1e7ae360694667fbb"></a><!-- doxytag: member="Sqlite3Cache::_nbRequest" ref="accbae673eaedf4e1e7ae360694667fbb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classSqlite3Cache.html#accbae673eaedf4e1e7ae360694667fbb">Sqlite3Cache::_nbRequest</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Sqlite3Cache_8cpp_source.html#l01670">1670</a> of file <a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a95fec1d09d3bdbda312cfd056e21a9ea"></a><!-- doxytag: member="Sqlite3Cache::_options" ref="a95fec1d09d3bdbda312cfd056e21a9ea" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classosgEarth_1_1Drivers_1_1Sqlite3CacheOptions.html">Sqlite3CacheOptions</a> <a class="el" href="classSqlite3Cache.html#a95fec1d09d3bdbda312cfd056e21a9ea">Sqlite3Cache::_options</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="classosgEarth_1_1Cache.html#a8bcb4e617ebada8fedaafc4dbe3210d9">osgEarth::Cache</a>.</p>

<p>Definition at line <a class="el" href="Sqlite3Cache_8cpp_source.html#l01639">1639</a> of file <a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a8ef69036bd80afb27fa315dd0c9660f8"></a><!-- doxytag: member="Sqlite3Cache::_pendingPurgeMutex" ref="a8ef69036bd80afb27fa315dd0c9660f8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Mutex <a class="el" href="classSqlite3Cache.html#a8ef69036bd80afb27fa315dd0c9660f8">Sqlite3Cache::_pendingPurgeMutex</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Sqlite3Cache_8cpp_source.html#l01658">1658</a> of file <a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ad64ad74d8e1a495fdfcc25ead9767835"></a><!-- doxytag: member="Sqlite3Cache::_pendingPurges" ref="ad64ad74d8e1a495fdfcc25ead9767835" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;std::string, osg::ref_ptr&lt;<a class="el" href="structAsyncPurge.html">AsyncPurge</a>&gt; &gt; <a class="el" href="classSqlite3Cache.html#ad64ad74d8e1a495fdfcc25ead9767835">Sqlite3Cache::_pendingPurges</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Sqlite3Cache_8cpp_source.html#l01659">1659</a> of file <a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a9126ddc09412dbdfb3237b3facbe9493"></a><!-- doxytag: member="Sqlite3Cache::_pendingUpdateMutex" ref="a9126ddc09412dbdfb3237b3facbe9493" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Mutex <a class="el" href="classSqlite3Cache.html#a9126ddc09412dbdfb3237b3facbe9493">Sqlite3Cache::_pendingUpdateMutex</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Sqlite3Cache_8cpp_source.html#l01655">1655</a> of file <a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a8195ac45f0906d0590895ea26b0d3be2"></a><!-- doxytag: member="Sqlite3Cache::_pendingUpdates" ref="a8195ac45f0906d0590895ea26b0d3be2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;std::string, osg::ref_ptr&lt;<a class="el" href="structAsyncUpdateAccessTimePool.html">AsyncUpdateAccessTimePool</a>&gt; &gt; <a class="el" href="classSqlite3Cache.html#a8195ac45f0906d0590895ea26b0d3be2">Sqlite3Cache::_pendingUpdates</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Sqlite3Cache_8cpp_source.html#l01656">1656</a> of file <a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a0390ac812d20df6392e65895e9c24430"></a><!-- doxytag: member="Sqlite3Cache::_pendingWrites" ref="a0390ac812d20df6392e65895e9c24430" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;std::string, osg::ref_ptr&lt;<a class="el" href="structAsyncInsert.html">AsyncInsert</a>&gt; &gt; <a class="el" href="classSqlite3Cache.html#a0390ac812d20df6392e65895e9c24430">Sqlite3Cache::_pendingWrites</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Sqlite3Cache_8cpp_source.html#l01653">1653</a> of file <a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a50cf270b267e5bbff37f969585d5651a"></a><!-- doxytag: member="Sqlite3Cache::_pendingWritesMutex" ref="a50cf270b267e5bbff37f969585d5651a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Mutex <a class="el" href="classSqlite3Cache.html#a50cf270b267e5bbff37f969585d5651a">Sqlite3Cache::_pendingWritesMutex</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Sqlite3Cache_8cpp_source.html#l01648">1648</a> of file <a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a2729caca9fb6969a35b0a2e8f861dca7"></a><!-- doxytag: member="Sqlite3Cache::_tableListMutex" ref="a2729caca9fb6969a35b0a2e8f861dca7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Mutex <a class="el" href="classSqlite3Cache.html#a2729caca9fb6969a35b0a2e8f861dca7">Sqlite3Cache::_tableListMutex</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Sqlite3Cache_8cpp_source.html#l01642">1642</a> of file <a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="aad44ce7e38dc0e8eee6f7b712075008b"></a><!-- doxytag: member="Sqlite3Cache::_tables" ref="aad44ce7e38dc0e8eee6f7b712075008b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="Sqlite3Cache_8cpp.html#ab4c3e380718b3ebc1a7ed02d2abbf5d3">LayerTablesByName</a> <a class="el" href="classSqlite3Cache.html#aad44ce7e38dc0e8eee6f7b712075008b">Sqlite3Cache::_tables</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Sqlite3Cache_8cpp_source.html#l01644">1644</a> of file <a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a5ac4caa8770a04dd9b6158515a2560a2"></a><!-- doxytag: member="Sqlite3Cache::_useAsyncWrites" ref="a5ac4caa8770a04dd9b6158515a2560a2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classSqlite3Cache.html#a5ac4caa8770a04dd9b6158515a2560a2">Sqlite3Cache::_useAsyncWrites</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Sqlite3Cache_8cpp_source.html#l01646">1646</a> of file <a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="acd31204ead71966342e4de852baeb883"></a><!-- doxytag: member="Sqlite3Cache::_writeService" ref="acd31204ead71966342e4de852baeb883" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">osg::ref_ptr&lt;<a class="el" href="classosgEarth_1_1TaskService.html">TaskService</a>&gt; <a class="el" href="classSqlite3Cache.html#acd31204ead71966342e4de852baeb883">Sqlite3Cache::_writeService</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Sqlite3Cache_8cpp_source.html#l01647">1647</a> of file <a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/home/cube/sources/osgearth/src/osgEarthDrivers/cache_sqlite3/<a class="el" href="Sqlite3Cache_8cpp_source.html">Sqlite3Cache.cpp</a></li>
</ul>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Wed Jan 18 2012 15:02:46 for osgEarth by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
